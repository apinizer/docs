---
title: "Topoloji 4: Bölgeler Arası Dağıtım"
description: 'Global dağılım ve coğrafi yedekleme gereksinimleri olan ortamlar için kurulum gereksinimleri: sistem gereksinimleri, ağ topolojisi, kapasite planlama ve donanım gereksinimleri'
---

Bu sayfa, Apinizer'ı **bölgeler arası (multi-region)** dağıtmak isteyenler için hazırlanmıştır. Bu topoloji, global dağılım, coğrafi yedekleme, düşük latency ve disaster recovery sağlar.

## Genel Bakış

Topoloji 4, farklı coğrafi bölgelerde (örneğin: İstanbul, Frankfurt, New York) Apinizer cluster'larının kurulduğu ve birbirleri ile senkronize çalıştığı bir topolojidir. Her bölge, Topoloji 3 (Yüksek Erişilebilirlik) yapısında kurulur.

### Mimari Yapı

```
                    Global Internet
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
        ▼                  ▼                  ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│   Bölge 1    │  │   Bölge 2    │  │   Bölge 3    │
│  (İstanbul)  │  │  (Frankfurt) │  │  (New York)  │
│              │  │              │  │              │
│  ┌────────┐ │  │  ┌────────┐ │  │  ┌────────┐ │
│  │  HA    │ │  │  │  HA    │ │  │  │  HA    │ │
│  │Cluster │ │  │  │Cluster │ │  │  │Cluster │ │
│  │(12 node)│ │  │  │(12 node)│ │  │  │(12 node)│ │
│  └────────┘ │  │  └────────┘ │  │  └────────┘ │
│              │  │              │  │              │
│  ┌────────┐ │  │  ┌────────┐ │  │  ┌────────┐ │
│  │ MongoDB│ │  │  │ MongoDB│ │  │  │ MongoDB│ │
│  │Replica │ │  │  │Replica │ │  │  │Replica │ │
│  │  Set   │ │  │  │  Set   │ │  │  │  Set   │ │
│  └────────┘ │  │  └────────┘ │  │  └────────┘ │
│              │  │              │  │              │
│  ┌────────┐ │  │  ┌────────┐ │  │  ┌────────┐ │
│  │Elastic│ │  │  │Elastic│ │  │  │Elastic│ │
│  │search │ │  │  │search │ │  │  │search │ │
│  │Cluster│ │  │  │Cluster│ │  │  │Cluster│ │
│  └────────┘ │  │  └────────┘ │  │  └────────┘ │
└──────┬───────┘  └──────┬───────┘  └──────┬───────┘
       │                 │                 │
       └─────────────────┼─────────────────┘
                         │
              Cross-Region Replication
              & Synchronization
```

## 1. Sistem Gereksinimleri

### İşletim Sistemi

* **Ubuntu Server 24.04 LTS** veya **RHEL 9.x** (her bölgede)
* Minimum kernel versiyonu: 5.4+
* SELinux: Disabled (RHEL için) veya Permissive mode

### Yazılım Bileşenleri

Her bölge için Topoloji 3 gereksinimleri + cross-region senkronizasyon:

| Bileşen | Versiyon/Gereksinim |
|---------|---------------------|
| **Kubernetes** | 1.31.0+ (HA Cluster - her bölgede) |
| **Docker/Containerd** | Kubernetes ile uyumlu versiyon |
| **MongoDB** | Replica Set (her bölgede) + Cross-Region Replication |
| **Elasticsearch** | 7.9.2 (Cluster - her bölgede) + Cross-Cluster Replication |
| **Network Plugin** | Flannel 0.27.4 (veya uyumlu) |
| **Load Balancer** | Global Load Balancer (GeoDNS/Anycast) |
| **VPN/Private Network** | Bölgeler arası güvenli bağlantı |

### Ağ Gereksinimleri

* **Internet Erişimi**: Her bölgede kurulum sırasında gerekli
* **DNS**: Global DNS (GeoDNS) yapılandırması
* **Firewall**: Her bölgede gerekli portların açık olması
* **Cross-Region Network**: Bölgeler arası < 100ms latency (tercihen < 50ms)
* **VPN/Private Network**: Bölgeler arası güvenli iletişim
* **Global Load Balancer**: GeoDNS veya Anycast yapılandırması

## 2. Ağ Topolojisi

### Global Ağ Yapısı

```
                    Global Internet
                           │
                           ▼
            ┌──────────────────────────┐
            │   Global Load Balancer   │
            │   (GeoDNS / Anycast)     │
            │   api.example.com        │
            └───────────┬──────────────┘
                        │
        ┌───────────────┼───────────────┐
        │               │               │
        ▼               ▼               ▼
┌──────────────┐ ┌──────────────┐ ┌──────────────┐
│   Bölge 1    │ │   Bölge 2    │ │   Bölge 3    │
│  (İstanbul)  │ │  (Frankfurt) │ │  (New York)  │
│              │ │              │ │              │
│  ┌────────┐  │ │  ┌────────┐  │ │  ┌────────┐  │
│  │  DMZ   │  │ │  │  DMZ   │  │ │  │  DMZ   │  │
│  │ Zone   │  │ │  │ Zone   │  │ │  │ Zone   │  │
│  │        │  │ │  │        │  │ │  │        │  │
│  │Worker  │  │ │  │Worker  │  │ │  │Worker  │  │
│  │Nodes   │  │ │  │Nodes   │  │ │  │Nodes   │  │
│  └───┬────┘  │ │  └───┬────┘  │ │  └───┬────┘  │
│      │       │ │      │       │ │      │       │
│  ┌───▼────┐  │ │  ┌───▼────┐  │ │  ┌───▼────┐  │
│  │  LAN   │  │ │  │  LAN   │  │ │  │  LAN   │  │
│  │ Zone   │  │ │  │ Zone   │  │ │  │ Zone   │  │
│  │        │  │ │  │        │  │ │  │        │  │
│  │Manager │  │ │  │Manager │  │ │  │Manager │  │
│  │MongoDB │  │ │  │MongoDB │  │ │  │MongoDB │  │
│  │Elastic │  │ │  │Elastic │  │ │  │Elastic │  │
│  └────────┘  │ │  └────────┘  │ │  └────────┘  │
└───────┬──────┘ └───────┬──────┘ └───────┬──────┘
        │                │                │
        └────────────────┼────────────────┘
                         │
              VPN / Private Network
              Cross-Region Replication
```

### Her Bölge İçin Ağ Topolojisi

Her bölge, Topoloji 3 (Yüksek Erişilebilirlik) yapısındadır. Detaylar için [Topoloji 3](/tr/apinizer-anlama/deployment/topoloji-3-yuksek-erisilebilirlik) sayfasına bakınız.

### Cross-Region İletişim

**Bölgeler Arası Port Gereksinimleri:**

| Kaynak | Hedef | Port | Protokol | Açıklama |
|--------|-------|------|----------|----------|
| Bölge 1 Manager | Bölge 2 Manager | 8080 | HTTP | Konfigürasyon senkronizasyonu |
| Bölge 1 MongoDB | Bölge 2 MongoDB | 27017 | TCP | Cross-region replication |
| Bölge 1 Elasticsearch | Bölge 2 Elasticsearch | 9200 | HTTP | Cross-cluster replication |
| Tüm Bölgeler | VPN Gateway | 443/1194 | TCP/UDP | Güvenli tunnel |

### Global Load Balancer Yapılandırması

**GeoDNS Yapılandırması:**

```
api.example.com
├── TR (Türkiye) → Bölge 1 (İstanbul) - 10.0.1.10
├── EU (Avrupa) → Bölge 2 (Frankfurt) - 10.0.2.10
└── US (Amerika) → Bölge 3 (New York) - 10.0.3.10
```

**Health Check:**
* Her bölgeden health check endpoint'leri kontrol edilir
* Sağlıksız bölge trafikten çıkarılır
* Otomatik failover sağlanır

## 3. Kapasite Planlama

### Trafik Tahmini

Bu topoloji aşağıdaki trafik seviyeleri için uygundur:

* **Global Günlük İstek**: > 10,000,000 istek/gün
* **Bölge Başına Günlük İstek**: > 3,000,000 istek/gün
* **Saniyede İstek**: > 1,000 istek/saniye (global)
* **Peak Trafik**: > 10,000 istek/saniye (global)
* **Eşzamanlı Kullanıcı**: > 10,000 kullanıcı (global)

### Veri Büyüklüğü Tahmini

**MongoDB (Her Bölge):**
* Konfigürasyon verileri: ~2-5 GB
* Audit log'lar: ~500 GB - 2 TB/ay
* Toplam tahmini: ~2-10 TB (1 yıl için, her bölge)
* Cross-region replication: 3x (toplam disk: 6-30 TB)

**Elasticsearch (Her Bölge):**
* Günlük log hacmi: 500 GB - 2 TB/gün
* Aylık log hacmi: ~15 TB - 60 TB/ay
* Toplam tahmini: ~50 TB - 200 TB (1 yıl için, her bölge)
* Cross-cluster replication: Selective (sadece kritik index'ler)

### Performans Beklentileri

* **API Yanıt Süresi**: < 100ms (yerel bölge), < 300ms (uzak bölge)
* **Yüksek Yük Altında**: < 500ms
* **Eşzamanlı Bağlantı**: 10,000 - 100,000 bağlantı (global)
* **Throughput**: 10,000-100,000 istek/saniye (global)
* **Uptime**: %99.99+ (global, bölge bazlı failover ile)

## 4. Donanım Gereksinimleri

Aşağıdaki gereksinimler tavsiye edilen **minimum** konfigürasyon için belirtilmiştir. Servis yüklerinize göre artırılmalıdır.

### Her Bölge İçin Donanım Gereksinimleri

Her bölge, Topoloji 3 (Yüksek Erişilebilirlik) donanım gereksinimlerine sahiptir. Aşağıdaki tablo bir bölge için gereksinimleri gösterir. Toplam 3 bölge için bu gereksinimler 3 katına çıkarılmalıdır.

#### Kubernetes Control-Plane Nodes (Her Bölge)

| No | İşletim Sistemi | CPU | RAM | Disk | Kurulumlar |
|----|-----------------|-----|-----|------|------------|
| Sunucu 1 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 4GB | 80GB | Kubernetes Control-Plane |
| Sunucu 2 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 4GB | 80GB | Kubernetes Control-Plane |
| Sunucu 3 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 4GB | 80GB | Kubernetes Control-Plane |

#### Kubernetes Worker Nodes (Her Bölge)

| No | İşletim Sistemi | CPU | RAM | Disk | Kurulumlar |
|----|-----------------|-----|-----|------|------------|
| Sunucu 4 | Ubuntu Server 24.04 LTS / RHEL 9.x | 12 | 16GB | 80GB | Kubernetes Worker |
| Sunucu 5 | Ubuntu Server 24.04 LTS / RHEL 9.x | 12 | 16GB | 80GB | Kubernetes Worker |
| Sunucu 6 | Ubuntu Server 24.04 LTS / RHEL 9.x | 12 | 16GB | 80GB | Kubernetes Worker |

#### MongoDB Replica Set Nodes (Her Bölge)

| No | İşletim Sistemi | CPU | RAM | Disk | Kurulumlar |
|----|-----------------|-----|-----|------|------------|
| Sunucu 7 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 12GB | 200GB | MongoDB Replica Set Node 1 |
| Sunucu 8 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 12GB | 200GB | MongoDB Replica Set Node 2 |
| Sunucu 9 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 12GB | 200GB | MongoDB Replica Set Node 3 |

#### Elasticsearch Cluster Nodes (Her Bölge)

| No | İşletim Sistemi | CPU | RAM | Disk | Kurulumlar |
|----|-----------------|-----|-----|------|------------|
| Sunucu 10 | Ubuntu Server 24.04 LTS / RHEL 9.x | 8 | 64GB | 2TB | Elasticsearch Cluster Node 1 (Master+Data) |
| Sunucu 11 | Ubuntu Server 24.04 LTS / RHEL 9.x | 8 | 64GB | 2TB | Elasticsearch Cluster Node 2 (Master+Data) |
| Sunucu 12 | Ubuntu Server 24.04 LTS / RHEL 9.x | 8 | 64GB | 2TB | Elasticsearch Cluster Node 3 (Master+Data) |

### Global Toplam Kaynak Özeti (3 Bölge)

| Kaynak | Her Bölge | Toplam (3 Bölge) |
|--------|-----------|------------------|
| **Toplam CPU** | 84 Core | 252 Core |
| **Toplam RAM** | 280 GB | 840 GB |
| **Toplam Disk (SSD)** | 6.5 TB | 19.5 TB |
| **Toplam Sunucu** | 12 | 36 |

### Ek Altyapı Gereksinimleri

#### Global Load Balancer

| Bileşen | Değer |
|---------|-------|
| **CPU** | 8-16 Core |
| **RAM** | 16-32 GB |
| **Disk** | 100 GB |
| **Network** | 10 Gbps (her bölgeye bağlantı) |

#### VPN/Private Network Gateway (Her Bölge)

| Bileşen | Değer |
|---------|-------|
| **CPU** | 4-8 Core |
| **RAM** | 8-16 GB |
| **Disk** | 50 GB |
| **Network** | 10 Gbps |

## Cross-Region Senkronizasyon

### MongoDB Cross-Region Replication

**Strateji:**
* Her bölgede MongoDB replica set
* Bölgeler arası MongoDB replica set replication
* Veya MongoDB Sharding (global cluster)

**Senkronizasyon:**
* Konfigürasyon verileri: Real-time replication
* Audit log'lar: Near real-time replication
* Conflict resolution: Last-write-wins veya custom logic

### Elasticsearch Cross-Cluster Replication

**Strateji:**
* Her bölgede bağımsız Elasticsearch cluster
* Cross-cluster replication (CCR) ile kritik index'lerin replikasyonu
* Veya global Elasticsearch cluster (multi-region)

**Senkronizasyon:**
* API traffic logs: Bölgesel saklama (yerel analiz için)
* Kritik log'lar: Cross-cluster replication
* Analytics: Her bölgede lokal, global analiz için aggregation

### Apinizer Konfigürasyon Senkronizasyonu

**Strateji:**
* Her bölgede bağımsız Manager
* Konfigürasyon değişiklikleri master bölgeden diğerlerine replike edilir
* Veya GitOps yaklaşımı ile merkezi yönetim

**Senkronizasyon:**
* API Proxy tanımları: Real-time
* Politika konfigürasyonları: Real-time
* Kullanıcı ve rol tanımları: Real-time

## Disaster Recovery

### RTO (Recovery Time Objective)

* **Bölge Bazlı Failover**: < 5 dakika
* **Global Failover**: < 15 dakika
* **Veri Recovery**: < 1 saat

### RPO (Recovery Point Objective)

* **MongoDB**: < 1 dakika (replication lag)
* **Elasticsearch**: < 5 dakika (CCR lag)
* **Konfigürasyon**: < 1 dakika (real-time sync)

### Backup Stratejisi

* **MongoDB**: Her bölgede günlük snapshot + cross-region backup
* **Elasticsearch**: Her bölgede günlük snapshot + cross-region backup
* **Konfigürasyon**: Git repository'de versiyon kontrolü

## Kurulum Öncesi Checklist

Kuruluma başlamadan önce aşağıdaki hazırlıkları yapmalısınız:

### Global Altyapı Hazırlığı

- [ ] 3+ bölge seçildi ve hazırlandı
- [ ] Her bölgede 12 sunucu hazırlandı
- [ ] Global Load Balancer hazırlandı (GeoDNS/Anycast)
- [ ] VPN/Private Network yapılandırıldı
- [ ] Bölgeler arası network latency test edildi (< 100ms)
- [ ] DNS yapılandırıldı (GeoDNS)

### Her Bölge İçin Hazırlık

- [ ] İşletim sistemi kuruldu (Ubuntu 24.04 LTS veya RHEL 9.x)
- [ ] Sunucular arası ağ bağlantısı test edildi
- [ ] DNS çözümleme çalışıyor
- [ ] Internet erişimi mevcut
- [ ] VIP (Virtual IP) yapılandırıldı

### Ağ Hazırlığı

- [ ] DMZ ve LAN zone'ları yapılandırıldı (her bölgede)
- [ ] Firewall kuralları yapılandırıldı (her bölgede)
- [ ] Cross-region firewall kuralları yapılandırıldı
- [ ] Load balancer HA yapılandırıldı (her bölgede)
- [ ] SSL/TLS sertifikaları hazırlandı
- [ ] VPN tunnel'ları test edildi

### Yazılım Hazırlığı

- [ ] Kubernetes HA cluster kurulum paketleri hazır
- [ ] MongoDB replica set + cross-region replication paketleri hazır
- [ ] Elasticsearch cluster + CCR paketleri hazır
- [ ] Apinizer image'leri erişilebilir
- [ ] Load balancer yazılımı kuruldu

### Güvenlik Hazırlığı

- [ ] SSH anahtarları yapılandırıldı
- [ ] Sudo erişimi yapılandırıldı
- [ ] Güvenlik güncellemeleri yapıldı
- [ ] Firewall kuralları test edildi
- [ ] SSL/TLS sertifikaları hazırlandı
- [ ] VPN güvenliği yapılandırıldı

## Kullanım Senaryoları

Bu topoloji aşağıdaki durumlar için idealdir:

* ✅ **Global Dağılım**: Farklı coğrafyalarda kullanıcılar
* ✅ **Düşük Latency**: Yerel erişim ile düşük gecikme
* ✅ **Disaster Recovery**: Coğrafi yedekleme
* ✅ **Compliance**: Veri yerelleştirme gereksinimleri
* ✅ **Yüksek Trafik**: Global yüksek trafikli uygulamalar
* ✅ **Kesintisiz Hizmet**: Bölge bazlı failover

## Sınırlamalar ve Dikkat Edilmesi Gerekenler

<Warning>
  **Bu topolojinin dikkat edilmesi gereken noktaları:**
  
  * ⚠️ Çok yüksek maliyet (36+ sunucu)
  * ⚠️ Karmaşık kurulum ve yönetim
  * ⚠️ Cross-region senkronizasyon gecikmeleri
  * ⚠️ Network latency (bölgeler arası)
  * ⚠️ Conflict resolution gereksinimleri
  * ⚠️ Yüksek operasyonel maliyet
</Warning>

## Sonraki Adımlar

Kuruluma başlamak için:

<CardGroup cols={2}>
  <Card title="Multi-Region Kurulum" icon="globe" href="/tr/kurulum/apinizer/multi-region">
    Multi-region kurulum adımlarını öğrenin
  </Card>
  <Card title="Topoloji 3: HA" icon="shield-halved" href="/tr/apinizer-anlama/deployment/topoloji-3-yuksek-erisilebilirlik">
    Her bölge için HA topolojisini inceleyin
  </Card>
  <Card title="Kubernetes HA Cluster" icon="layer-group" href="/tr/kurulum/kubernetes/kubernetes-high-availability-yuksek-erisim-cluster">
    Kubernetes HA cluster kurulumunu öğrenin
  </Card>
  <Card title="MongoDB Cross-Region" icon="database" href="/tr/kurulum/mongodb/ubuntu-mongodb">
    MongoDB cross-region replication öğrenin
  </Card>
  <Card title="Elasticsearch CCR" icon="magnifying-glass" href="/tr/kurulum/elasticsearch/ubuntu-elasticsearch">
    Elasticsearch cross-cluster replication öğrenin
  </Card>
  <Card title="Kapasite Planlama" icon="calculator" href="/tr/apinizer-anlama/sistem/kapasite-planlama">
    Detaylı kapasite planlama yapın
  </Card>
  <Card title="Diğer Topolojiler" icon="sitemap" href="/tr/apinizer-anlama/deployment/deployment-modelleri">
    Diğer topolojileri inceleyin
  </Card>
</CardGroup>
