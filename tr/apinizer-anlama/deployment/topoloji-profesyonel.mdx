---
title: "Topoloji 2: Profesyonel"
description: 'Profesyonel production ortamları için kurulum gereksinimleri: sistem gereksinimleri, ağ topolojisi, kapasite planlama ve donanım gereksinimleri'
---

Bu sayfa, Apinizer'ı **profesyonel production ortamlarında** kurmak isteyenler için hazırlanmıştır. Bu topoloji, orta ölçekli kurumsal uygulamalar için tasarlanmıştır ve worker node'ları arasında yük dengeleme sağlar.

## Genel Bakış

Topoloji 2, production ortamları için uygun, worker node'ları arasında yük dengeleme sağlayan bir topolojidir. Tüm bileşenler 5 sunucu üzerinde çalışır.

### Mimari Yapı


<img
    src="/images/apinizer-anlama/apinizer-profesyonel.png"
    alt="Profesyonel Kurulum Mimarisi"
    width="800"
    className="mr-auto"
/>

## 1. Sistem Gereksinimleri

### İşletim Sistemi

* **Ubuntu Server 24.04 LTS** veya **RHEL 9.x**
* Minimum kernel versiyonu: 5.4+
* SELinux: Disabled (RHEL için) veya Permissive mode

### Yazılım Bileşenleri

| Bileşen | Versiyon/Gereksinim |
|---------|---------------------|
| **Kubernetes** | 1.31.0+ (veya desteklenen herhangi bir versiyon) |
| **Docker/Containerd** | Kubernetes ile uyumlu versiyon |
| **MongoDB** | Herhangi bir versiyon (Replica Set olarak yapılandırılmalı) |
| **Elasticsearch** | 7.9.2 (resmi desteklenen versiyon) |
| **Network Plugin** | Flannel 0.27.4 (veya uyumlu) |
| **Load Balancer** | HAProxy 2.0+ veya Nginx 1.18+ |

### Ağ Gereksinimleri

* **Internet Erişimi**: Kurulum sırasında gerekli
* **DNS**: Çalışan DNS çözümleme
* **Firewall**: Gerekli portların açık olması
* **Load Balancer**: Trafik dağıtımı için

## 2. Donanım Gereksinimleri

Aşağıdaki gereksinimler tavsiye edilen **minimum** konfigürasyon için belirtilmiştir. Servis yüklerinize göre artırılmalıdır.

| No | İşletim Sistemi | CPU | RAM | Disk | Kurulumlar |
|----|-----------------|-----|-----|------|------------|
| Sunucu 1 | Ubuntu Server 24.04 LTS / RHEL 9.x | 8 | 32GB | 1TB | Kubernetes Control-Plane, Elasticsearch (Master+Data), Replica set MongoDB Single Instance |
| Sunucu 2 | Ubuntu Server 24.04 LTS / RHEL 9.x | 6 | 12GB | 80GB | Kubernetes Worker |
| Sunucu 3 | Ubuntu Server 24.04 LTS / RHEL 9.x | 6 | 12GB | 80GB | Kubernetes Worker |
| Sunucu 4 | Ubuntu Server 24.04 LTS / RHEL 9.x | 6 | 12GB | 80GB | Kubernetes Worker |
| Sunucu 5 | Ubuntu Server 24.04 LTS / RHEL 9.x | 6 | 12GB | 80GB | Kubernetes Worker |

## 3. Ağ Topolojisi

### Ağ Yapısı

Profesyonel production ortamları için DMZ/LAN ayrımı önerilir ancak opsiyoneldir. Basit bir ağ yapısı da kullanılabilir.

Bu topolojide, Internet üzerinden gelen trafik Load Balancer üzerinden yönlendirilir ve tüm sunucular tek bir network zone'unda çalışır.

**Ağ Yapısı:**

* **Internet**: Dış dünyadan gelen trafik, Load Balancer üzerinden (Port 443/80) iç ağa yönlendirilir.
* **Network Zone**: Tüm sunucular aynı ağ zone'unda bulunur.
  * **Sunucu 1**: Kubernetes Control-Plane, MongoDB, Elasticsearch ve Manager bileşenlerini barındırır. Tüm veritabanı ve yönetim servisleri bu sunucuda çalışır.
  * **Sunucu 2-5**: Kubernetes Worker Node, Worker ve Cache bileşenlerini barındırır. API Gateway trafiğini işler ve yük dengeleme sağlar.

Load Balancer, trafiği Sunucu 2, 3, 4 ve 5 arasında dağıtarak yük dengeleme sağlar. Dört worker node ile yüksek performans ve artırılmış kapasite elde edilir. DMZ/LAN ayrımı yapılırsa, Worker node'lar DMZ'de, Control-Plane ve veritabanı servisleri LAN'da konumlandırılabilir.

### Port ve Firewall İzinleri

<Info>
  **Önemli Not:**
  
  **Aynı Alt Ağ (Subnet) İçinde Kurulum Durumu**
  
  Eğer tüm sunucularınız aynı alt ağ üzerinde konumlanacak ve aralarında bir güvenlik duvarı (firewall) bulunmayacaksa, güvenlik duvarı kuralları yalnızca aşağıdaki iki iletişim türü için geçerli olacaktır:
  
  * **İnternet'ten Erişim**: Dış dünyadan erişilmesi gereken uygulama portları (Örn: Load Balancer: 443/80, Sunucu 1: 32080, Sunucu 2-5: 30080/30090).
  * **Konteyner Ağ İletişimi**: Kubernetes kümesi içi iletişimde kullanılan ek protokol portları (Örn: Flannel VXLAN için 8472 UDP).
  
  Sunucular arasındaki küme içi (intra-cluster) ve bileşenler arası iletişim portları, aynı alt ağ içinde doğrudan erişilebilir kabul edildiğinden, bu iletişimler için ek bir güvenlik duvarı kuralı tanımlanmasına gerek yoktur.
</Info>

<AccordionGroup>
  <Accordion title="Eğer Port ve Firewall İzinleri İçin Detaylı Bilgiye İhtiyacınız Varsa">
    #### Port Gereksinimleri

    **Sunucu 1 (Control-Plane + Manager + Database):**

    | Sunucu | Port | Protokol | Açıklama |
    |--------|------|----------|----------|
    | Sunucu 1 | 6443 | HTTPS | Kubernetes API Server |
    | Sunucu 1 | 10250 | HTTPS | Kubelet API |
    | Sunucu 1 | 10259 | HTTPS | Kube-scheduler |
    | Sunucu 1 | 10257 | HTTPS | Kube-controller-manager |
    | Sunucu 1 | 2379-2380 | TCP | etcd client/server |
    | Sunucu 1 | 8472 | UDP | Flannel VXLAN |
    | Sunucu 1 | 27017 | TCP | MongoDB |
    | Sunucu 1 | 9200 | HTTP | Elasticsearch HTTP |
    | Sunucu 1 | 9300 | TCP | Elasticsearch Transport |
    | Sunucu 1 | 32080 | HTTP | Manager Erişimi |

    **Sunucu 2-5 (Worker Nodes):**

    | Sunucu | Port | Protokol | Açıklama |
    |--------|------|----------|----------|
    | Sunucu 2-5 | 10250 | HTTPS | Kubelet API |
    | Sunucu 2-5 | 30000-32767 | TCP/UDP | NodePort Services |
    | Sunucu 2-5 | 8472 | UDP | Flannel VXLAN |
    | Sunucu 2-5 | 30080/30090 | HTTP | Worker Erişimi |

    **Load Balancer:**

    | Port | Protokol | Açıklama |
    |------|----------|----------|
    | 443 | HTTPS | Dış erişim (API) |
    | 80 | HTTP | HTTP → HTTPS redirect |
    | 8080 | HTTP | Backend (Worker'lara) |

    #### Firewall Kuralları

    **DMZ → LAN (Eğer DMZ/LAN ayrımı yapılıyorsa):**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Worker Nodes | Control-Plane | 6443 | HTTPS | Kubernetes API |
    | Worker Nodes | Control-Plane | 10250 | HTTPS | Kubelet API |
    | Worker Nodes | MongoDB | 27017 | TCP | MongoDB |
    | Worker Nodes | Elasticsearch | 9200 | HTTP | Elasticsearch |
    | Worker Nodes | Elasticsearch | 9300 | TCP | Elasticsearch Transport |
    | Worker Nodes | Manager | 8080 | HTTP | Konfigürasyon alımı |
    | Worker Nodes | Cache | 5701 | TCP | Hazelcast cluster |

    **LAN → DMZ (Eğer DMZ/LAN ayrımı yapılıyorsa):**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Manager | Worker Nodes | 8080 | HTTP | Deployment işlemleri |
    | Control-Plane | Worker Nodes | 10250 | HTTPS | Kubelet API |
    | Control-Plane | Worker Nodes | 30000-32767 | TCP/UDP | NodePort Services |
    | Control-Plane | Worker Nodes | 30080/30090 | HTTP | Health check |

    **Internet → DMZ:**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Internet | Load Balancer | 443 | HTTPS | Dış erişim (API) |
    | Internet | Load Balancer | 80 | HTTP | HTTP → HTTPS redirect |

    **Sunucular Arası İletişim (Aynı alt ağ içinde):**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Sunucu 1 | Sunucu 2-5 | 10250 | HTTPS | Kubelet API |
    | Sunucu 1 | Sunucu 2-5 | 30000-32767 | TCP/UDP | NodePort Services |
    | Sunucu 1 | Sunucu 2-5 | 8472 | UDP | Flannel VXLAN |
    | Sunucu 2-5 | Sunucu 1 | 6443 | HTTPS | Kubernetes API |
    | Sunucu 2-5 | Sunucu 1 | 10250 | HTTPS | Kubelet API |
    | Sunucu 2-5 | Sunucu 1 | 27017 | TCP | MongoDB |
    | Sunucu 2-5 | Sunucu 1 | 9200 | HTTP | Elasticsearch |
    | Sunucu 2-5 | Sunucu 1 | 9300 | TCP | Elasticsearch Transport |
    | Sunucu 2-5 | Sunucu 1 | 8472 | UDP | Flannel VXLAN |
    | Internet | Sunucu 1 | 32080 | HTTP | Manager Erişimi (opsiyonel) |
    | Internet | Sunucu 2-5 | 30080/30090 | HTTP | Worker Erişimi (opsiyonel) |
  </Accordion>
</AccordionGroup>

## 4. Kapasite Planlama

| Metrik | Değer | Açıklama |
|--------|-------|----------|
| **Günlük İstek** | 10,000 - 1,000,000 istek/gün | Toplam günlük API çağrı sayısı |
| **Saniyede İstek** | 1 - 100 istek/saniye | Ortalama saniyede işlenen istek sayısı |
| **Peak Trafik** | 100 - 1,000 istek/saniye | En yüksek trafik anındaki istek sayısı |
| **Eşzamanlı Kullanıcı** | 50 - 1,000 kullanıcı | Aynı anda aktif olan kullanıcı sayısı |
| **MongoDB - Konfigürasyon Verileri** | ~100-500 MB | API konfigürasyonları ve metadata |
| **MongoDB - Audit Log'lar** | ~5-50 GB/ay | Aylık audit log hacmi |
| **MongoDB - Toplam Tahmini** | ~100-500 GB | 1 yıl için toplam MongoDB veri hacmi |
| **Elasticsearch - Günlük Log** | 1-50 GB/gün | Günlük log hacmi |
| **Elasticsearch - Aylık Log** | ~30 GB - 1.5 TB/ay | Aylık log hacmi |
| **Elasticsearch - Toplam Tahmini** | ~500 GB - 5 TB | 1 yıl için toplam Elasticsearch veri hacmi (retention'a göre değişir) |
| **API Yanıt Süresi** | < 300ms | Ortalama API yanıt süresi |
| **Yüksek Yük Altında Yanıt Süresi** | < 1 saniye | Yüksek trafik altında maksimum yanıt süresi |
| **Eşzamanlı Bağlantı** | 100 - 1,000 bağlantı | Aynı anda açık olan bağlantı sayısı |
| **Throughput** | 100-1,000 istek/saniye | Saniyede işlenen maksimum istek sayısı |

## Kurulum Öncesi Checklist

Kuruluma başlamadan önce aşağıdaki hazırlıkları yapmalısınız:

| Kategori | Kontrol Maddesi |
|----------|-----------------|
| **Altyapı** | [ ] 5 sunucu hazırlandı (Sunucu 1, 2, 3, 4, 5) |
| | [ ] Load Balancer hazırlandı (HAProxy/Nginx) |
| | [ ] İşletim sistemi kuruldu (Ubuntu 24.04 LTS veya RHEL 9.x) |
| | [ ] Sunucular arası ağ bağlantısı test edildi |
| | [ ] DNS çözümleme çalışıyor |
| | [ ] Internet erişimi mevcut |
| **Ağ** | [ ] Gerekli portlar açıldı (yukarıdaki port listesine göre) |
| | [ ] Firewall kuralları yapılandırıldı |
| | [ ] Load balancer yapılandırıldı |
| | [ ] SSL/TLS sertifikaları hazırlandı |
| | [ ] DMZ ve LAN zone'ları yapılandırıldı (opsiyonel) |
| **Yazılım** | [ ] Kubernetes kurulum paketleri hazır |
| | [ ] MongoDB kurulum paketleri hazır |
| | [ ] Elasticsearch kurulum paketleri hazır |
| | [ ] Apinizer image'leri erişilebilir (DockerHub veya private registry) |
| | [ ] Load balancer yazılımı kuruldu |
| **Güvenlik** | [ ] SSH anahtarları yapılandırıldı |
| | [ ] Sudo erişimi yapılandırıldı |
| | [ ] Güvenlik güncellemeleri yapıldı |
| | [ ] Firewall kuralları test edildi |
| | [ ] SSL/TLS sertifikaları hazırlandı |

## Kullanım Senaryoları

Bu topoloji aşağıdaki durumlar için idealdir:

* **Orta Ölçekli Production**: Kurumsal uygulamalar için uygun bir ortamdır. Worker node'lar arasında yük dengeleme sağlar ve orta seviye trafik gereksinimlerini karşılar.

* **Orta Trafikli Sistemler**: Günlük 10,000 ile 1 milyon arası istek işleyen sistemler için uygundur. Dört worker node ile trafik dağıtımı yapılır.

* **Worker Yük Dengeleme**: Dört worker node arasında trafik dağıtımı yaparak yüksek performans ve artırılmış kapasite sağlar. Bir veya daha fazla worker node'un arızalanması durumunda diğer worker node'lar trafiği karşılayabilir.

* **Bütçe Optimizasyonu**: Yüksek erişilebilirlik olmadan production ortamı gereksinimlerini karşılamak isteyenler için maliyet-etkin bir çözümdür.

* **Kurumsal Uygulamalar**: Orta seviye gereksinimleri olan kurumsal uygulamalar için idealdir. Production ortamı için gerekli temel özellikleri sağlar.

## Sınırlamalar ve Dikkat Edilmesi Gerekenler

<Warning>
  **Bu topolojinin sınırlamaları:**
  
  * Veritabanı tek nokta arıza riski taşır (MongoDB single instance)
  * Elasticsearch tek node (yüksek erişilebilirlik yok)
  * Control-Plane tek node (Kubernetes HA yok)
  * Yüksek erişilebilirlik gereksinimleri için Topoloji 3 önerilir
</Warning>
