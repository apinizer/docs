---
title: "Topoloji 3: Yüksek Erişilebilirlik"
description: 'Yüksek erişilebilirlik gereksinimleri olan production ortamları için kurulum gereksinimleri: sistem gereksinimleri, ağ topolojisi, kapasite planlama ve donanım gereksinimleri'
---

Bu sayfa, Apinizer'ı **yüksek erişilebilirlik gereksinimleri olan kritik production ortamlarında** kurmak isteyenler için hazırlanmıştır. Bu topoloji, %99.9+ uptime, otomatik failover ve veri replikasyonu sağlar.

## Genel Bakış

Topoloji 3, yüksek erişilebilirlik için tasarlanmış, tüm kritik bileşenlerin cluster yapısında çalıştığı bir topolojidir. Tüm bileşenler 12 sunucu üzerinde dağıtılmıştır.

### Mimari Yapı

<img
  src="/images/apinizer-anlama/apinizer-ha-cluster.png"
  alt="Yüksek Erişilebilirlik Kurulum Mimarisi"
  width="1200"
  style={{ maxWidth: '100%', height: 'auto', display: 'block', margin: '0 auto' }}
/>

## 1. Sistem Gereksinimleri

### İşletim Sistemi

* **Ubuntu Server 24.04 LTS** veya **RHEL 9.x**
* Minimum kernel versiyonu: 5.4+
* SELinux: Disabled (RHEL için) veya Permissive mode

### Yazılım Bileşenleri

| Bileşen | Versiyon/Gereksinim |
|---------|---------------------|
| **Kubernetes** | 1.31.0+ (HA Cluster) |
| **Docker/Containerd** | Kubernetes ile uyumlu versiyon |
| **MongoDB** | Herhangi bir versiyon (Replica Set - 3 node minimum) |
| **Elasticsearch** | 7.9.2 (Cluster - 3 node minimum) |
| **Network Plugin** | Flannel 0.27.4 (veya uyumlu) |
| **Load Balancer** | HAProxy 2.0+ veya Nginx 1.18+ (HA yapılandırma) |

### Ağ Gereksinimleri

* **Internet Erişimi**: Kurulum sırasında gerekli
* **DNS**: Çalışan DNS çözümleme
* **Firewall**: Gerekli portların açık olması
* **Load Balancer**: HA yapılandırma (VIP)
* **Network Latency**: Node'lar arası < 1ms (aynı datacenter)

## 2. Donanım Gereksinimleri

Aşağıdaki gereksinimler tavsiye edilen **minimum** konfigürasyon için belirtilmiştir. Servis yüklerinize göre artırılmalıdır.

| No | İşletim Sistemi | CPU | RAM | Disk | Kurulumlar |
|----|-----------------|-----|-----|------|------------|
| Sunucu 1 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 8GB | 100GB | Kubernetes Control-Plane Node 1 |
| Sunucu 2 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 8GB | 100GB | Kubernetes Control-Plane Node 2 |
| Sunucu 3 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 8GB | 100GB | Kubernetes Control-Plane Node 3 |
| Sunucu 4 | Ubuntu Server 24.04 LTS / RHEL 9.x | 12 | 16GB | 100GB | Kubernetes Worker Node 1 |
| Sunucu 5 | Ubuntu Server 24.04 LTS / RHEL 9.x | 12 | 16GB | 100GB | Kubernetes Worker Node 2 |
| Sunucu 6 | Ubuntu Server 24.04 LTS / RHEL 9.x | 12 | 16GB | 100GB | Kubernetes Worker Node 3 |
| Sunucu 7 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 12GB | 500GB | MongoDB Replica Set Node 1 |
| Sunucu 8 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 12GB | 500GB | MongoDB Replica Set Node 2 |
| Sunucu 9 | Ubuntu Server 24.04 LTS / RHEL 9.x | 4 | 12GB | 500GB | MongoDB Replica Set Node 3 |
| Sunucu 10 | Ubuntu Server 24.04 LTS / RHEL 9.x | 8 | 64GB | 2TB | Elasticsearch Cluster Node 1 (Master+Data) |
| Sunucu 11 | Ubuntu Server 24.04 LTS / RHEL 9.x | 8 | 64GB | 2TB | Elasticsearch Cluster Node 2 (Master+Data) |
| Sunucu 12 | Ubuntu Server 24.04 LTS / RHEL 9.x | 8 | 64GB | 2TB | Elasticsearch Cluster Node 3 (Master+Data) |

## 3. Ağ Topolojisi

### DMZ ve LAN Ayrımı (Zorunlu)

Yüksek erişilebilirlik topolojisi için DMZ (Demilitarized Zone) ve LAN (Local Area Network) ayrımı zorunludur. Bu yapı, güvenlik ve yüksek erişilebilirlik sağlar.

**Ağ Yapısı:**

* **Internet**: Dış dünyadan gelen trafik, yüksek erişilebilirlik yapılandırmasına sahip Load Balancer üzerinden (Port 443/80) DMZ zone'una yönlendirilir.

* **DMZ Zone (Demilitarized Zone)**: Dış dünyaya açık olan ancak iç ağdan izole edilmiş güvenli ağ bölgesidir.
  * **Worker Node 1, 2, 3**: Kubernetes Worker node'ları bu zone'da bulunur. API Gateway trafiğini işler ve dış dünyadan erişilebilir. Load Balancer, trafiği bu üç worker node arasında dağıtarak yük dengeleme ve yüksek erişilebilirlik sağlar.

* **LAN Zone (Local Area Network)**: İç ağ bölgesi, dış dünyadan doğrudan erişilemez.
  * **Control-Plane 1-3**: Kubernetes Control-Plane node'ları bu zone'da bulunur. Cluster yönetimi ve API server işlemlerini gerçekleştirir.
  * **MongoDB 1-3**: MongoDB Replica Set node'ları bu zone'da bulunur. Veritabanı işlemlerini gerçekleştirir ve veri replikasyonu sağlar.
  * **Elasticsearch 1-3**: Elasticsearch Cluster node'ları bu zone'da bulunur. Log ve arama işlemlerini gerçekleştirir.

Bu yapı, güvenlik katmanları oluşturarak kritik bileşenlerin (veritabanı, cluster yönetimi) dış dünyadan izole edilmesini sağlar. Firewall kuralları ile DMZ ve LAN arasındaki iletişim kontrol altında tutulur.

### Port ve Firewall İzinleri

<Info>
  **Önemli Not:**
  
  **DMZ ve LAN Zone Ayrımı**
  
  Bu topolojide sunucular DMZ ve LAN zone'larına ayrılmıştır. Worker node'lar DMZ'de, Control-Plane, MongoDB ve Elasticsearch node'ları LAN'da bulunur. Bu yapı, güvenlik ve yüksek erişilebilirlik sağlar.
  
  Firewall kuralları, zone'lar arası iletişimi kontrol eder ve sadece gerekli portların açılmasını sağlar. DMZ ve LAN arasındaki iletişim, güvenlik politikalarına göre sınırlandırılmalıdır.
</Info>

<AccordionGroup>
  <Accordion title="Eğer Port ve Firewall İzinleri İçin Detaylı Bilgiye İhtiyacınız Varsa">
    #### Port Gereksinimleri

    **Kubernetes Control-Plane Nodes (Sunucu 1-3):**

    | Sunucu | Port | Protokol | Açıklama |
    |--------|------|----------|----------|
    | Sunucu 1-3 | 6443 | HTTPS | Kubernetes API Server |
    | Sunucu 1-3 | 10250 | HTTPS | Kubelet API |
    | Sunucu 1-3 | 10259 | HTTPS | Kube-scheduler |
    | Sunucu 1-3 | 10257 | HTTPS | Kube-controller-manager |
    | Sunucu 1-3 | 2379-2380 | TCP | etcd client/server |
    | Sunucu 1-3 | 8472 | UDP | Flannel VXLAN |

    **Kubernetes Worker Nodes (Sunucu 4-6):**

    | Sunucu | Port | Protokol | Açıklama |
    |--------|------|----------|----------|
    | Sunucu 4-6 | 10250 | HTTPS | Kubelet API |
    | Sunucu 4-6 | 30000-32767 | TCP/UDP | NodePort Services |
    | Sunucu 4-6 | 8472 | UDP | Flannel VXLAN |
    | Sunucu 4-6 | 30080/30090 | HTTP | Worker Erişimi |

    **MongoDB Replica Set Nodes (Sunucu 7-9):**

    | Sunucu | Port | Protokol | Açıklama |
    |--------|------|----------|----------|
    | Sunucu 7-9 | 27017 | TCP | MongoDB |

    **Elasticsearch Cluster Nodes (Sunucu 10-12):**

    | Sunucu | Port | Protokol | Açıklama |
    |--------|------|----------|----------|
    | Sunucu 10-12 | 9200 | HTTP | Elasticsearch HTTP |
    | Sunucu 10-12 | 9300 | TCP | Elasticsearch Transport |

    **Load Balancer (HA):**

    | Port | Protokol | Açıklama |
    |------|----------|----------|
    | 443 | HTTPS | Dış erişim (API) |
    | 80 | HTTP | HTTP → HTTPS redirect |
    | 8080 | HTTP | Backend (Worker'lara) |
    | 6443 | HTTPS | Kubernetes API (VIP) |

    #### Firewall Kuralları

    **DMZ → LAN:**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Worker Nodes | Control-Plane | 6443 | HTTPS | Kubernetes API |
    | Worker Nodes | Control-Plane | 10250 | HTTPS | Kubelet API |
    | Worker Nodes | MongoDB | 27017 | TCP | MongoDB replica set |
    | Worker Nodes | Elasticsearch | 9200 | HTTP | Elasticsearch cluster |
    | Worker Nodes | Elasticsearch | 9300 | TCP | Elasticsearch Transport |
    | Worker Nodes | Manager | 8080 | HTTP | Konfigürasyon alımı |
    | Worker Nodes | Cache | 5701 | TCP | Hazelcast cluster |

    **LAN → DMZ:**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Manager | Worker Nodes | 8080 | HTTP | Deployment işlemleri |
    | Control-Plane | Worker Nodes | 10250 | HTTPS | Kubelet API |
    | Control-Plane | Worker Nodes | 30000-32767 | TCP/UDP | NodePort Services |
    | Control-Plane | Worker Nodes | 30080/30090 | HTTP | Health check |

    **Internet → DMZ:**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Internet | Load Balancer | 443 | HTTPS | Dış erişim (API) |
    | Internet | Load Balancer | 80 | HTTP | HTTP → HTTPS redirect |

    **Node'lar Arası İletişim (LAN içinde):**
    
    | Kaynak | Hedef | Port | Protokol | Açıklama |
    |--------|-------|------|----------|----------|
    | Control-Plane | Control-Plane | 6443, 2379-2380, 10250, 10259, 10257, 8472 | HTTPS/TCP/UDP | Control-Plane cluster iletişimi |
    | MongoDB | MongoDB | 27017 | TCP | MongoDB replica set iletişimi |
    | Elasticsearch | Elasticsearch | 9200, 9300 | HTTP/TCP | Elasticsearch cluster iletişimi |
    | Worker | Worker | 10250, 8472 | HTTPS/UDP | Worker node iletişimi |
  </Accordion>
</AccordionGroup>

## 4. Kapasite Planlama

| Metrik | Değer | Açıklama |
|--------|-------|----------|
| **Günlük İstek** | > 1,000,000 istek/gün | Toplam günlük API çağrı sayısı |
| **Saniyede İstek** | > 100 istek/saniye | Ortalama saniyede işlenen istek sayısı |
| **Peak Trafik** | > 1,000 istek/saniye | En yüksek trafik anındaki istek sayısı |
| **Eşzamanlı Kullanıcı** | > 1,000 kullanıcı | Aynı anda aktif olan kullanıcı sayısı |
| **MongoDB - Konfigürasyon Verileri** | ~500 MB - 2 GB | API konfigürasyonları ve metadata |
| **MongoDB - Audit Log'lar** | ~50-500 GB/ay | Aylık audit log hacmi |
| **MongoDB - Toplam Tahmini** | ~500 GB - 2 TB | 1 yıl için toplam MongoDB veri hacmi |
| **MongoDB - Replikasyon Faktörü** | 3x | Toplam disk gereksinimi: 1.5 TB - 6 TB |
| **Elasticsearch - Günlük Log** | 50-500 GB/gün | Günlük log hacmi |
| **Elasticsearch - Aylık Log** | ~1.5 TB - 15 TB/ay | Aylık log hacmi |
| **Elasticsearch - Toplam Tahmini** | ~5 TB - 50 TB | 1 yıl için toplam Elasticsearch veri hacmi (retention'a göre değişir) |
| **Elasticsearch - Replikasyon Faktörü** | 1x | Shard replication |
| **API Yanıt Süresi** | < 200ms | Ortalama API yanıt süresi |
| **Yüksek Yük Altında Yanıt Süresi** | < 500ms | Yüksek trafik altında maksimum yanıt süresi |
| **Eşzamanlı Bağlantı** | 1,000 - 10,000 bağlantı | Aynı anda açık olan bağlantı sayısı |
| **Throughput** | 1,000-10,000 istek/saniye | Saniyede işlenen maksimum istek sayısı |
| **Uptime** | %99.9+ | Yıllık < 8.76 saat kesinti |

## Kurulum Öncesi Checklist

Kuruluma başlamadan önce aşağıdaki hazırlıkları yapmalısınız:

| Kategori | Kontrol Maddesi |
|----------|-----------------|
| **Altyapı** | [ ] 12 sunucu hazırlandı (3 Control-Plane + 3 Worker + 3 MongoDB + 3 Elasticsearch) |
| | [ ] Load Balancer hazırlandı (HA yapılandırma) |
| | [ ] İşletim sistemi kuruldu (Ubuntu 24.04 LTS veya RHEL 9.x) |
| | [ ] Sunucular arası ağ bağlantısı test edildi (< 1ms latency) |
| | [ ] DNS çözümleme çalışıyor |
| | [ ] Internet erişimi mevcut |
| | [ ] VIP (Virtual IP) yapılandırıldı |
| **Ağ** | [ ] DMZ ve LAN zone'ları yapılandırıldı |
| | [ ] Firewall kuralları yapılandırıldı |
| | [ ] Load balancer HA yapılandırıldı |
| | [ ] SSL/TLS sertifikaları hazırlandı |
| | [ ] Gerekli portlar açıldı (yukarıdaki port listesine göre) |
| | [ ] Network segmentation uygulandı |
| **Yazılım** | [ ] Kubernetes HA cluster kurulum paketleri hazır |
| | [ ] MongoDB replica set kurulum paketleri hazır |
| | [ ] Elasticsearch cluster kurulum paketleri hazır |
| | [ ] Apinizer image'leri erişilebilir (DockerHub veya private registry) |
| | [ ] Load balancer yazılımı kuruldu (HA) |
| **Güvenlik** | [ ] SSH anahtarları yapılandırıldı |
| | [ ] Sudo erişimi yapılandırıldı |
| | [ ] Güvenlik güncellemeleri yapıldı |
| | [ ] Firewall kuralları test edildi |
| | [ ] SSL/TLS sertifikaları hazırlandı |
| | [ ] Network segmentation test edildi |

## Kullanım Senaryoları

Bu topoloji aşağıdaki durumlar için idealdir:

* **Kritik Production Ortamları**: Kesintisiz hizmet gereksinimleri olan kritik iş uygulamaları için idealdir. Yüksek erişilebilirlik ve otomatik failover özellikleri sayesinde kesintisiz çalışma sağlar.

* **Yüksek Trafikli Sistemler**: Günlük 1 milyondan fazla istek işleyen sistemler için uygundur. 3 worker node ile yüksek throughput ve düşük latency sağlar.

* **Yüksek Erişilebilirlik Gereksinimleri**: %99.9+ uptime gereksinimleri olan sistemler için tasarlanmıştır. Tüm kritik bileşenlerin cluster yapısında çalışması sayesinde tek nokta arıza riski minimize edilir.

* **Kritik İş Süreçleri**: Kesintisiz çalışma zorunluluğu olan kritik iş süreçleri için uygundur. Otomatik failover ve veri replikasyonu sayesinde yüksek güvenilirlik sağlar.

* **Veri Güvenliği**: Replikasyon ve yedekleme gereksinimleri olan sistemler için idealdir. MongoDB ve Elasticsearch için otomatik veri replikasyonu sağlar.

* **Zero-Downtime Updates**: Kesintisiz güncelleme gereksinimleri olan sistemler için uygundur. Rolling update ve canary deployment gibi tekniklerle kesintisiz güncelleme yapılabilir.

## Sınırlamalar ve Dikkat Edilmesi Gerekenler

<Warning>
  **Bu topolojinin dikkat edilmesi gereken noktaları:**
  
  * Yüksek maliyet gereksinimleri (12 sunucu + Load Balancer)
  * Karmaşık kurulum ve yönetim süreçleri
  * Yüksek ağ bant genişliği gereksinimleri
  * Uzman sistem yöneticisi gereksinimi
  * Düzenli bakım ve izleme gereksinimleri
  * Yüksek disk alanı gereksinimleri (özellikle Elasticsearch için)
</Warning>
