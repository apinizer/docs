---
title: "Request, Response ve Error Pipelines"
description: 'Request, Response ve Error pipeline'ları, API Proxy'de mesajların işlenme akışını tanımlar'
---

Request Pipeline (İstek Boru Hattı), Response Pipeline (Yanıt Boru Hattı) ve Error Pipeline (Hata Boru Hattı), API Proxy'de mesajların işlenme akışını tanımlayan üç temel pipeline'dır.

## Pipeline Genel Bakış

API Proxy'de mesaj işleme üç ana pipeline üzerinden gerçekleşir:

<CardGroup cols={3}>
  <Card title="Request Pipeline" icon="arrow-right">
    İstemciden gelen isteklerin işlendiği pipeline
  </Card>
  <Card title="Response Pipeline" icon="arrow-left">
    Backend'den gelen yanıtların işlendiği pipeline
  </Card>
  <Card title="Error Pipeline" icon="triangle-exclamation">
    Hata durumlarının işlendiği pipeline
  </Card>
</CardGroup>

## Request Pipeline

Request Pipeline, istemciden gelen isteklerin backend'e gönderilmeden önce işlendiği pipeline'dır.

### Request Pipeline Akışı

```
İstemci İsteği
   │
   ▼
┌─────────────────────────────────┐
│ REQUEST PIPELINE                 │
│                                 │
│ 1. Pre-flow Policies           │
│    ├─ Authentication            │
│    ├─ Authorization             │
│    ├─ Rate Limiting            │
│    └─ Validation               │
│                                 │
│ 2. Conditional Policies        │
│    └─ IF-THEN-ELSE             │
│                                 │
│ 3. Route Step                   │
│    └─ Upstream Target          │
│                                 │
│ 4. Post-flow Policies (Request)│
│    ├─ Request Transformation   │
│    ├─ Header Modification       │
│    └─ Request Enrichment        │
└──────────────┬──────────────────┘
               │
               ▼
         Backend API
```

### Request Pipeline Aşamaları

<AccordionGroup>
  <Accordion title="1. Pre-flow Policies">
    İstek backend'e gönderilmeden önce çalışan politikalar:
    
    * **Güvenlik**:
      * Authentication (OAuth2, JWT, Basic Auth)
      * Authorization (IP Whitelist, API Key)
      * mTLS
    * **Trafik Yönetimi**:
      * Rate Limiting
      * Quota Management
      * Time Restriction
    * **Doğrulama**:
      * JSON/XML Schema Validation
      * Message Size Validation
      * Content-Type Validation
  </Accordion>
  
  <Accordion title="2. Conditional Policies">
    Koşullara bağlı olarak çalışan politikalar:
    
    * Mesaj içeriğine göre (JSONPath, XPath)
    * Header değerlerine göre
    * Query parametrelerine göre
    * IP adresine göre
    * Zaman bazlı koşullar
  </Accordion>
  
  <Accordion title="3. Route Step">
    Backend'e yönlendirme:
    
    * Upstream Target seçimi
    * Load balancing uygulaması
    * Failover mekanizması
  </Accordion>
  
  <Accordion title="4. Post-flow Policies (Request)">
    Backend'e istek gönderilmeden önce çalışan politikalar:
    
    * Request Transformation (JSON ↔ XML)
    * Header Modification
    * Request Enrichment
    * Query Parameter Manipulation
  </Accordion>
</AccordionGroup>

## Response Pipeline

Response Pipeline, backend'den gelen yanıtların istemciye gönderilmeden önce işlendiği pipeline'dır.

### Response Pipeline Akışı

```
Backend API
   │
   ▼
┌─────────────────────────────────┐
│ RESPONSE PIPELINE               │
│                                 │
│ 1. Post-flow Policies (Response)│
│    ├─ Response Transformation  │
│    ├─ Data Masking              │
│    ├─ Response Enrichment       │
│    └─ Logging                   │
│                                 │
│ 2. Response Formatting         │
│    └─ Content-Type Setting     │
│                                 │
│ 3. Header Modification         │
│    └─ Custom Headers           │
└──────────────┬──────────────────┘
               │
               ▼
         İstemci Yanıtı
```

### Response Pipeline Aşamaları

<AccordionGroup>
  <Accordion title="1. Post-flow Policies (Response)">
    Backend'den yanıt geldikten sonra çalışan politikalar:
    
    * **Response Transformation**:
      * Format Conversion (JSON ↔ XML)
      * Data Mapping
      * Field Removal/Addition
    * **Data Masking**:
      * Sensitive Data Masking
      * PII Protection
      * Field Encryption
    * **Response Enrichment**:
      * Additional Fields
      * Metadata Addition
    * **Logging**:
      * Response Logging
      * Audit Logging
  </Accordion>
  
  <Accordion title="2. Response Formatting">
    Yanıt formatlama:
    
    * Content-Type ayarlama
    * Character encoding
    * Compression
  </Accordion>
  
  <Accordion title="3. Header Modification">
    Yanıt header'larını değiştirme:
    
    * Custom header ekleme
    * Header değerlerini değiştirme
    * CORS header'ları
  </Accordion>
</AccordionGroup>

## Error Pipeline

Error Pipeline, hata durumlarının işlendiği pipeline'dır. Request veya Response pipeline'ında bir hata oluştuğunda Error Pipeline devreye girer.

### Error Pipeline Akışı

```
Hata Oluştu
   │
   ▼
┌─────────────────────────────────┐
│ ERROR PIPELINE                  │
│                                 │
│ 1. Fault Handler Policies       │
│    ├─ Error Detection           │
│    ├─ Error Classification      │
│    └─ Error Handling            │
│                                 │
│ 2. Error Transformation         │
│    ├─ Error Message Formatting  │
│    ├─ Error Code Mapping        │
│    └─ Error Response Creation   │
│                                 │
│ 3. Error Logging                │
│    ├─ Error Details Logging     │
│    ├─ Stack Trace Logging       │
│    └─ Audit Logging             │
│                                 │
│ 4. Error Response               │
│    └─ Client Error Response     │
└──────────────┬──────────────────┘
               │
               ▼
         İstemci Hata Yanıtı
```

### Error Pipeline Aşamaları

<AccordionGroup>
  <Accordion title="1. Fault Handler Policies">
    Hata yakalama politikaları:
    
    * **Error Detection**:
      * Exception yakalama
      * HTTP status code kontrolü
      * Timeout kontrolü
    * **Error Classification**:
      * Hata tipine göre sınıflandırma
      * Hata seviyesine göre sınıflandırma
    * **Error Handling**:
      * Retry mekanizması
      * Fallback stratejisi
      * Circuit breaker
  </Accordion>
  
  <Accordion title="2. Error Transformation">
    Hata mesajı dönüştürme:
    
    * **Error Message Formatting**:
      * Kullanıcı dostu mesajlar
      * Detaylı hata mesajları
      * Maskelenmiş hata mesajları
    * **Error Code Mapping**:
      * Backend hata kodlarını API hata kodlarına dönüştürme
      * Standart HTTP status code'ları
    * **Error Response Creation**:
      * JSON error response
      * XML error response
      * Custom error format
  </Accordion>
  
  <Accordion title="3. Error Logging">
    Hata kaydı:
    
    * **Error Details Logging**:
      * Hata mesajı
      * Stack trace
      * Request/Response detayları
    * **Audit Logging**:
      * Hata zamanı
      * Kullanıcı bilgileri
      * İşlem detayları
  </Accordion>
  
  <Accordion title="4. Error Response">
    İstemciye hata yanıtı:
    
    * HTTP status code
    * Error message
    * Error details (opsiyonel)
    * Error code
  </Accordion>
</AccordionGroup>

## Pipeline İlişkileri

Üç pipeline birbirleriyle ilişkilidir:

```
Request Pipeline
   │
   ├─► Success ──► Response Pipeline ──► Client
   │
   └─► Error ──► Error Pipeline ──► Client
```

### Pipeline Geçişleri

<CardGroup cols={2}>
  <Card title="Request → Response" icon="arrow-right">
    Request Pipeline başarıyla tamamlandığında:
    * Backend'e istek gönderilir
    * Backend'den yanıt alınır
    * Response Pipeline başlar
  </Card>
  <Card title="Request → Error" icon="triangle-exclamation">
    Request Pipeline'da hata oluştuğunda:
    * Error Pipeline devreye girer
    * Hata işlenir
    * İstemciye hata yanıtı gönderilir
  </Card>
  <Card title="Response → Error" icon="triangle-exclamation">
    Response Pipeline'da hata oluştuğunda:
    * Error Pipeline devreye girer
    * Hata işlenir
    * İstemciye hata yanıtı gönderilir
  </Card>
  <Card title="Error → Client" icon="arrow-left">
    Error Pipeline tamamlandığında:
    * Hata yanıtı formatlanır
    * İstemciye gönderilir
  </Card>
</CardGroup>

## Pipeline Best Practices

<AccordionGroup>
  <Accordion title="Request Pipeline">
    * Güvenlik politikalarını önce çalıştırın
    * Ağır işlemleri sona bırakın
    * Validation'ı transformation'dan önce yapın
    * Koşullu politikaları optimize edin
  </Accordion>
  
  <Accordion title="Response Pipeline">
    * Data masking'i önce yapın
    * Transformation'ı sonra yapın
    * Logging'i en sona bırakın
    * Performansı göz önünde bulundurun
  </Accordion>
  
  <Accordion title="Error Pipeline">
    * Tüm hataları yakalayın
    * Kullanıcı dostu hata mesajları oluşturun
    * Hassas bilgileri maskeleyin
    * Detaylı loglama yapın
  </Accordion>
</AccordionGroup>

## Sonraki Adımlar

<CardGroup cols={2}>
  <Card title="Message Flow & Policy Pipeline" icon="diagram-project" href="/tr/apinizer-anlama/temel-kavramlar/message-processing">
    Message Flow ve Policy Pipeline kavramını öğrenin
  </Card>
  <Card title="API Proxy'de Mesaja Politikalar Uygulanması" icon="shield" href="/tr/apinizer-anlama/temel-kavramlar/api-proxy-mesaja-politikalar-uygulanmasi">
    Politika uygulama sürecini öğrenin
  </Card>
  <Card title="Condition-based Policy Execution" icon="code-branch" href="/tr/apinizer-anlama/temel-kavramlar/condition-based-policy-execution">
    Koşullu politika çalıştırmayı öğrenin
  </Card>
  <Card title="Policy Nedir?" icon="shield" href="/tr/apinizer-anlama/temel-kavramlar/policy-nedir">
    Politika kavramını öğrenin
  </Card>
</CardGroup>

