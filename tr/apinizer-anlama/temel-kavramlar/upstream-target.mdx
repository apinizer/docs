---
title: "Upstream ve Target"
description: "Upstream Target, API Proxy'nin istekleri yönlendirdiği backend API'nin adresidir"
---

# Upstream ve Target

Upstream Target (Yukarı Akış Hedefi), API Proxy'de istemcilerden gelen isteklerin yönlendirildiği backend API'nin adresidir. Upstream Target, API Proxy'nin backend ile iletişim kurduğu noktadır.

## Genel Bakış

Upstream ve target kavramları, API Proxy'lerde backend servislere yönlendirme yapılırken kullanılan temel kavramlardır. Upstream Target, backend API'nin fiziksel veya mantıksal adresini temsil eder. API Proxy, Client Route'dan gelen istekleri bu hedefe yönlendirir.

<CardGroup cols={2}>
  <Card title="Backend Adresi" icon="server">
    Backend API'nin URL'i veya IP adresi
  </Card>
  <Card title="Protokol" icon="globe">
    HTTP, HTTPS, gRPC, WebSocket protokolleri
  </Card>
  <Card title="Yük Dengeleme" icon="scale-balanced">
    Birden fazla backend instance'ı arasında yük dengeleme
  </Card>
  <Card title="Failover" icon="heart-pulse">
    Hata durumunda alternatif backend'e geçiş
  </Card>
</CardGroup>

## Upstream

Upstream, API Proxy'nin istekleri yönlendirdiği backend servislerin tanımlandığı yapılandırmadır. Bir upstream birden fazla target içerebilir.

## Target

Target, upstream içinde tanımlanan backend servis adresleridir. Her target bir URL ve gerekli yapılandırma bilgilerini içerir.

## Upstream Target Yapısı

Bir Upstream Target şu bilgileri içerir:

```
http://backend-service:8080/api/products
│     │                │    │
│     │                │    └─ Backend Path
│     │                └─ Port
│     └─ Host/Service Name
└─ Protocol
```

### Örnek Upstream Target'lar

```
http://product-service:8080
https://api.backend.com/v1
grpc://backend-service:50051
ws://websocket-service:8080
```

## Upstream Target Yapılandırması

### Temel Yapılandırma

Bir Upstream Target oluştururken şu bilgiler tanımlanır:

* **URL**: Backend API'nin adresi
* **Protocol**: HTTP, HTTPS, gRPC, WebSocket
* **Host**: Backend sunucu adı veya IP
* **Port**: Backend port numarası
* **Path**: Backend path'i (opsiyonel)
* **Path Rewrite**: Backend path'ini değiştirme (opsiyonel)

### Path Rewrite

Upstream Target'da path rewrite yapılabilir:

```
Client Route: /api/v1/products
   │
   ▼ (Path Rewrite)
Upstream Target: /products
   │
   ▼
Backend API: http://backend:8080/products
```

**Path Rewrite Örnekleri:**
* `/api/v1/products` → `/products` (prefix removal)
* `/api/v1/products` → `/v2/products` (version change)
* `/api/products/{id}` → `/products/{id}` (path simplification)

### Health Check

Upstream Target'lar için sağlık kontrolü yapılandırılabilir:

* **Health Check URL**: Sağlık kontrolü endpoint'i
* **Interval**: Kontrol aralığı
* **Timeout**: Zaman aşımı
* **Failure Threshold**: Hata eşiği

### Timeout Ayarları

* **Connection Timeout**: Bağlantı zaman aşımı
* **Read Timeout**: Okuma zaman aşımı
* **Write Timeout**: Yazma zaman aşımı

## Upstream Target ve Load Balancing

Birden fazla backend instance varsa, yük dengeleme yapılır:

```
Client Route
   │
   ▼
Upstream Target (Load Balanced)
   │
   ├─► Backend Instance 1 (http://backend1:8080)
   ├─► Backend Instance 2 (http://backend2:8080)
   └─► Backend Instance 3 (http://backend3:8080)
```

### Load Balancing Stratejileri

* **Round Robin**: Sırayla dağıtım
* **Least Connections**: En az bağlantıya sahip backend
* **IP Hash**: İstemci IP'sine göre backend seçimi
* **Weighted Round Robin**: Ağırlıklı dağıtım

Detaylı bilgi için [Load Balancing Strategies](/tr/apinizer-anlama/temel-kavramlar/load-balancing-strategies) sayfasına bakın.

## Upstream Target ve Failover

Backend instance'larından biri hata verdiğinde:

* **Automatic Failover**: Otomatik olarak başka bir instance'a geçiş
* **Health Check**: Düzenli sağlık kontrolü
* **Circuit Breaker**: Hata durumunda geçici olarak devre dışı bırakma

## Upstream Target Türleri

<CardGroup cols={2}>
  <Card title="Single Target" icon="server">
    Tek bir backend instance:
    ```
    http://backend:8080
    ```
  </Card>
  <Card title="Multiple Targets" icon="layer-group">
    Birden fazla backend instance (Load Balanced):
    ```
    http://backend1:8080
    http://backend2:8080
    http://backend3:8080
    ```
  </Card>
  <Card title="Service Discovery" icon="magnifying-glass">
    Service discovery ile dinamik backend bulma:
    ```
    kubernetes://product-service
    consul://product-service
    ```
  </Card>
  <Card title="Dynamic Target" icon="arrows-rotate">
    Dinamik olarak belirlenen backend:
    ```
    Variable-based target selection
    ```
  </Card>
</CardGroup>

## Upstream Target ve Retry

Geçici hatalar için retry mekanizması:

* **Retry Count**: Tekrar deneme sayısı
* **Retry Delay**: Tekrar deneme aralığı
* **Retry Conditions**: Hangi hatalar için retry yapılacağı

## Kullanım Senaryoları

* Load balancing için birden fazla target tanımlanabilir
* Health check mekanizmaları ile target'ların durumu izlenebilir
* Farklı upstream'ler farklı backend servislere yönlendirme yapmak için kullanılabilir
* Path rewrite ile API versiyonlama ve path dönüşümleri yapılabilir
* Service discovery ile dinamik backend bulma sağlanabilir
* Failover mekanizmaları ile yüksek erişilebilirlik sağlanabilir

## Sonraki Adımlar

<CardGroup cols={2}>
  <Card title="Client Route" icon="arrow-right" href="/tr/apinizer-anlama/temel-kavramlar/client-route">
    Client Route kavramını öğrenin
  </Card>
  <Card title="Routing" icon="route" href="/tr/apinizer-anlama/temel-kavramlar/routing">
    Routing kavramını öğrenin
  </Card>
  <Card title="Load Balancing" icon="scale-balanced" href="/tr/apinizer-anlama/temel-kavramlar/load-balancing-strategies">
    Load balancing stratejileri
  </Card>
  <Card title="HTTP Routing" icon="globe" href="/tr/gelistirici/routing-configuration/http-routing">
    HTTP Routing yapılandırması
  </Card>
</CardGroup>
