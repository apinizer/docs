---
title: 'Script (Script)'
description: 'HTTP istek/yanÄ±t hattÄ±nda koÅŸullu script Ã§alÄ±ÅŸtÄ±rarak veri ve baÅŸlÄ±klarÄ± dinamik olarak dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r'
---

**ğŸ’¡ Politikalar hakkÄ±nda bilginiz var mÄ±?**\\
Bu dokÃ¼man spesifik bir politikanÄ±n detaylÄ± kullanÄ±mÄ±nÄ± anlatÄ±r. EÄŸer Apinizer politika yapÄ±sÄ±nÄ± ilk kez kullanÄ±yorsanÄ±z veya politikalarÄ±n genel Ã§alÄ±ÅŸma prensiplerini Ã¶ÄŸrenmek istiyorsanÄ±z, Ã¶ncelikle [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±nÄ± okumanÄ±zÄ± Ã¶neririz.

## Genel BakÄ±ÅŸ

### AmacÄ± Nedir?

- Script PolitikasÄ±, API Proxy (API Vekil Sunucusu) istek hattÄ±nda Ã¶zel iÅŸ kurallarÄ± ve veri dÃ¶nÃ¼ÅŸÃ¼mleri uygulayarak entegrasyon gereksinimlerini kod yazmadan Ã§Ã¶zmeyi hedefler.
- Script PolitikasÄ±, yanÄ±t hattÄ±nda gelen verileri maskeleme, zenginleÅŸtirme veya hata mesajlarÄ±nÄ± uyarlama gibi iÅŸlemleri merkezi olarak yÃ¶netmeyi saÄŸlar.
- Script PolitikasÄ±, farklÄ± ortamlar arasÄ±nda tutarlÄ± davranÄ±ÅŸ iÃ§in global/local paylaÅŸÄ±mlÄ± script kÃ¼tÃ¼phanesi oluÅŸturmayÄ± mÃ¼mkÃ¼n kÄ±lar.
- Script PolitikasÄ±, koÅŸul motoru sayesinde yalnÄ±zca belirlenen endpoint veya header kombinasyonlarÄ±nda devreye girerek performansÄ± korur.

### Ã‡alÄ±ÅŸma Prensibi

1. **Ä°stek GeliÅŸi**: API Gateway'e gelen her HTTP/HTTPS isteÄŸi iÃ§in, istemin kaynak IP adresi tespit edilir.
2. **Politika KontrolÃ¼**: Script PolitikasÄ± aktif ise, sistem aÅŸaÄŸÄ±daki sÄ±rayla kontrol yapar:
   - Condition (koÅŸul) tanÄ±mlÄ± mÄ±? Varsa koÅŸul saÄŸlanÄ±yor mu?
   - Politika aktif mi (active=true)?
   - Variable kullanÄ±lÄ±yor mu yoksa Apinizer default mÄ±?
3. **Script Motoru YÃ¼rÃ¼tmesi**: SeÃ§ilen `executionType` (SYNC/ASYNC) ve `scriptLanguage` (Groovy/Javascript) deÄŸerlerine gÃ¶re script, belirlenen pipeline bÃ¶lgesinde Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r; istek/yanÄ±t body, header ve parametre haritalarÄ± gÃ¼ncellenebilir.
4. **Karar Verme**:
   - **EÅŸleÅŸme Var**: Script sonucunda gÃ¼ncellenen mesaj bileÅŸenleri pipeline'a geri yazÄ±lÄ±r, hata durumunda tanÄ±mlÄ± statusCode ve mesaj dÃ¶ner.
   - **EÅŸleÅŸme Yok**: Script atlanÄ±r, istek/yanÄ±t varsayÄ±lan akÄ±ÅŸÄ±na devam eder.
5. **Hata Ä°ÅŸleme**: Politika kuralÄ±na uymayan istekler iÃ§in Ã¶zelleÅŸtirilebilir HTTP durum kodu ve hata mesajÄ± dÃ¶ndÃ¼rÃ¼lÃ¼r.

## Ã–zellikler ve Yetenekler

### Temel Ã–zellikler

- **ExecutionType YÃ¶netimi (Sync/Async)**: Scriptin eÅŸzamanlÄ± mÄ± yoksa arka planda mÄ± yÃ¼rÃ¼tÃ¼leceÄŸini belirler; asenkron mod uzun sÃ¼ren iÅŸlemlerde uÃ§ noktayÄ± bloklamaz.
- **Ã‡ift Script Dili DesteÄŸi**: Groovy ve Javascript arasÄ±nda seÃ§im yaparak ekiplerin hÃ¢kim olduklarÄ± dili kullanmalarÄ±nÄ± saÄŸlar.
- **BaÄŸlam DeÄŸiÅŸkeni KÃ¼tÃ¼phanesi**: From Client, To Backend, From Backend ve To Client akÄ±ÅŸlarÄ± iÃ§in hazÄ±r deÄŸiÅŸken haritalarÄ± sunar; okunabilir/yazÄ±labilir alanlar net olarak ayrÄ±lmÄ±ÅŸtÄ±r.
- **Aktif/Pasif Durum KontrolÃ¼**: PolitikanÄ±n aktif veya pasif durumunu kolayca deÄŸiÅŸtirme (active/passive toggle). Pasif durumda politika uygulanmaz ancak yapÄ±landÄ±rmasÄ± saklanÄ±r.
- **KoÅŸul BazlÄ± Uygulama**: Query Builder ile karmaÅŸÄ±k koÅŸullar oluÅŸturarak politikanÄ±n ne zaman uygulanacaÄŸÄ±nÄ± belirleme (Ã¶rn: sadece belirli endpoint'lere veya header deÄŸerlerine gÃ¶re).

### Ä°leri DÃ¼zey Ã–zellikler

- **Script Test LaboratuvarÄ±**: Entegre test penceresiyle farklÄ± pipeline segmentleri iÃ§in Ã¶rnek header/param/body verileriyle script Ã§alÄ±ÅŸtÄ±rma ve sonucu inceleme.
- **BaÄŸÄ±mlÄ±lÄ±k Ä°zleme**: Used Proxies/Policy Groups bÃ¶lÃ¼mleriyle politikanÄ±n hangi API Proxy veya gruplarda kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼p deÄŸiÅŸiklik etki analizi yapma.
- **Dinamik Context Value SeÃ§imi**: `EnumScriptContextValue` Ã¼zerinden tarih, ortam veya proxy metadata bilgilerini script iÃ§erisinde kullanmak iÃ§in otomatik kopyalama.
- **Export/Import Ã–zelliÄŸi**: Politika yapÄ±landÄ±rmasÄ±nÄ± ZIP dosyasÄ± olarak export etme. FarklÄ± ortamlara (Development, Test, Production) import etme. Versiyon kontrolÃ¼ ve yedekleme imkanÄ±.
- **Policy Group ve Proxy Group DesteÄŸi**: Birden fazla politikayÄ± Policy Group iÃ§inde yÃ¶netme. Proxy Group'lara toplu politika atama. Merkezi gÃ¼ncelleme ve deploy iÅŸlemleri.
- **Deploy ve Versiyonlama**: Politika deÄŸiÅŸikliklerini canlÄ± ortama deploy etme. Hangi API Proxy'lerde kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rme (Policy Usage). Proxy Group ve Policy Group kullanÄ±m raporlarÄ±.

## KullanÄ±m SenaryolarÄ±

| Senaryo | Durum | Ã‡Ã¶zÃ¼m (Politika UygulamasÄ±) | Beklenen DavranÄ±ÅŸ / SonuÃ§ |
|---------|-------|----------------------------|---------------------------|
| Ä°stek BaÅŸlÄ±ÄŸÄ± Enjeksiyonu | DÄ±ÅŸ sistem ek header talep ediyor | From Client â†’ To Backend scriptinde `requestHeaderMapToTargetAPI['X-Partner-Code']='ACME'` yazÄ±lÄ±r | Backend Ã§aÄŸrÄ±sÄ± gereken header ile yapÄ±lÄ±r |
| Hassas Alan Maskesi | YanÄ±tta TC kimlik numarasÄ± bulunuyor | To Client scriptinde regex ile hassas alan `****` ile deÄŸiÅŸtirilir | Ä°stemciye maskelemiÅŸ veri dÃ¶ner |
| Dinamik Endpoint YÃ¶nlendirme | BazÄ± mÃ¼ÅŸteriler farklÄ± backend URL'sine yÃ¶nlendirilmeli | Script `customizedBackendResourceUrl` alanÄ±nÄ± koÅŸula gÃ¶re set eder | Ä°stek uygun hedef servise yÃ¶nlenir |
| KoÅŸullu Hata DÃ¶nÃ¼ÅŸÃ¼ | Belirli API anahtarlarÄ±nda eriÅŸim durdurulmalÄ± | Script `responseErrorMessageToClient` ve `statusCodeToClient=403` atar | Ä°stemci 403 ve Ã¶zelleÅŸtirilmiÅŸ mesaj alÄ±r |
| JWT Enrichment | JWT claim deÄŸerine dayalÄ± context Ã¼retmek gerekiyor | Script claim'i okuyup `customVariableMap['roleLevel']=...` yazar | Sonraki politikalar enriched deÄŸeri kullanÄ±r |
| Header BazlÄ± Rate Flag | Belirli kaynaÄŸa doÄŸru gelen baÅŸlÄ±klarda throttling tetiklenmeli | Script header'Ä± analiz edip `requestHeaderMapToTargetAPI['X-Throttle']='true'` ekler | Throttling politikalarÄ± bayraÄŸÄ± okuyarak hÄ±z kÄ±sÄ±tlar |
| GeliÅŸmiÅŸ Loglama (opsiyonel) | Denetim amaÃ§lÄ± request/response logu hazÄ±rlamak gerekiyor | Script `customVariableMap['auditPayload']=JSON.stringify(...)` yazar | Log alma politikasÄ± veriyi kullanÄ±r |

## Politika Parametrelerini YapÄ±landÄ±rma

Script politikasÄ± ile istek veya yanÄ±t mesajlarÄ±ndaki baÅŸlÄ±k (header), parametre (parameter), gÃ¶vde (body) ve hata mesajÄ± (error message) iÃ§erikleri seÃ§ilen script dili ile iÅŸlenebilir.

Politika konfigÃ¼rasyonu iÃ§in kullanÄ±lan alanlar aÅŸaÄŸÄ±daki tabloda gÃ¶rÃ¼lmektedir.

| Alan | AÃ§Ä±klama |
|------|----------|
| **Ä°sim (Name)** | PolitikanÄ±n kullanÄ±mÄ±nÄ± ve yÃ¶netimini kolaylaÅŸtÄ±rmak iÃ§in isim yazÄ±labilir. PolitikalarÄ±n yÃ¶netimi ve seÃ§imi sÄ±rasÄ±nda bu isme ihtiyacÄ±nÄ±z olacaktÄ±r. |
| **AÃ§Ä±klama (Description)** | PolitikanÄ±n kullanÄ±mÄ±nÄ± ve yÃ¶netimini kolaylaÅŸtÄ±rmak iÃ§in aÃ§Ä±klama yazÄ±labilir. |
| **Execution Tipi (Execution Type)** | Ã‡alÄ±ÅŸtÄ±rÄ±lacak olan Script'in Senkron ya da Asenkron olarak Ã§alÄ±ÅŸmasÄ± belirlenebilir. |
| **Script Dili (Script Language)** | YazÄ±lacak olan Script'in tipidir. Javascript veya Groovy olabilir. |
| **Script GÃ¶vdesi (Script Body)** | Ã‡alÄ±ÅŸtÄ±rÄ±lacak olan Script kodu yazÄ±lÄ±r. MesajÄ±n bÃ¶lgelerine gÃ¶re verilen deÄŸiÅŸkenlere ait linklere tÄ±klayarak gÃ¶vde alanÄ±na eklenebilir. |
| **Dene (Try it)** | Ã‡alÄ±ÅŸtÄ±rÄ±lacak olan scriptin denemesinin yapÄ±labilmesi iÃ§in yeni bir pencere aÃ§Ä±lmasÄ±nÄ± saÄŸlar. |

**WebSocket** ve **gRPC** iÃ§in Script Policy'de sadece hata mesajlarÄ± ve context verileriyle ilgili belirli deÄŸiÅŸkenler kullanÄ±labilir.

KullanÄ±labilir deÄŸiÅŸkenler: `responseErrorMessageToClient`, `requestErrorMessageToTargetAPI`

### Script PolitikasÄ±nÄ±n Ã‡alÄ±ÅŸmasÄ± HakkÄ±nda

Gelen istek mesajÄ±n orijinal hali ile dÃ¶nen yanÄ±t mesajÄ±nÄ±n orijinal hali Ã¼zerinde deÄŸiÅŸiklik yapÄ±lamaz, bu veriler Ã¼zerinde **sadece okuma** yapÄ±labilir.

Backend API'ye gÃ¶nderilecek olan istek ile istemciye dÃ¶necek yanÄ±t Ã¼zerinde ise **hem okuma hem de deÄŸiÅŸiklik** yapÄ±labilir.

YapÄ±lacak olan okuma ve deÄŸiÅŸiklik iÅŸlemleri mesajÄ±n baÅŸlÄ±k, parametre ve gÃ¶vde kÄ±sÄ±mlarÄ±nÄ± iÃ§erir. Bu alanlara script Ã¼zerinde eriÅŸim iÃ§in Ã§eÅŸitli anahtar kelimeler kullanÄ±lmÄ±ÅŸtÄ±r. Bu anahtar kelimeler eriÅŸilmek istenen bÃ¶lgeye gÃ¶re deÄŸiÅŸmektedir.

Anahtar kelimeleri formÃ¼lÃ¼ze etmek istersek aÅŸaÄŸÄ±daki ÅŸekilde ifade edebiliriz:

- BaÅŸlÄ±klara eriÅŸmek iÃ§in â†’ `<request|response>HeaderMap<From|To><Client|TargetAPI>`
- URL parametrelerine eriÅŸmek iÃ§in â†’ `<request>UrlParamMap<From|To><Client|TargetAPI>`
- Form URL Encoded parametrelerine eriÅŸmek iÃ§in â†’ `<request>FormUrlEncodedList<From|To><Client|TargetAPI>`
- Form Data parametrelerine eriÅŸmek iÃ§in â†’ `<request>FormDataList<From|To><Client|TargetAPI>`
- GÃ¶vdeye eriÅŸmek iÃ§in â†’ `<request|response>BodyText<From|To><Client|TargetAPI>`
- PolitikayÄ± sonlandÄ±rÄ±p Ã¶zelleÅŸtirilmiÅŸ hata mesajÄ± dÃ¶ndÃ¼rmek iÃ§in â†’ `<request|response>ErrorMessage<From|To><Client|TargetAPI>` gÃ¶sterimini kullanmanÄ±z gerekir.
- Durum kodunu deÄŸiÅŸtirmek iÃ§in â†’ `statusCode<From|To><Client|TargetAPI>`

Bu anahtar kelimeler dÄ±ÅŸÄ±nda kullanÄ±lan anahtar kelimeler:

- `requestUrlFromClient`: MesajÄ±n geldiÄŸi URL path'ini tutar
- `requestBackendUrlToTargetAPI`: EÄŸer isteÄŸi gideceÄŸi Backend URL kapsam yolu(context path) deÄŸiÅŸtirilmek istenirse bu deÄŸiÅŸken ayarlanabilir.
- `customVariableMap`: Ä°ÅŸ mantÄ±ÄŸÄ±na Ã¶zel olarak deÄŸiÅŸken oluÅŸturulabilir, bu deÄŸiÅŸkenlere istek ve yanÄ±t hattÄ±nda okuma ve yazma iÅŸlemi yapÄ±labilir. Ä°ÅŸ kuralÄ± politikasÄ±nda da map'e eklenen anahtar kelime Ã¼zerinden deÄŸerinin kullanÄ±lmasÄ± saÄŸlanabilir.
- `contextValues`: Apinizer'Ä±n her bir istek iÃ§in isteÄŸe Ã¶zel tuttuÄŸu verileri okumak iÃ§in bu deÄŸerlerden faydalanabilir. Bu deÄŸerler Ã¼zerinde sadece okuma yapÄ±labilir.

Ã–rneÄŸin;

- Ä°stemciden gelen istek Apinizer'a ulaÅŸtÄ±ÄŸÄ±nda yani isteÄŸin orijinal halinin gÃ¶vde iÃ§eriÄŸine eriÅŸmek isteniyorsa `requestBodyTextFromClient` deÄŸiÅŸkenini,
- Apinizer gelen isteÄŸi Backend API'ye iletirkenki halinin baÅŸlÄ±klarÄ±na eriÅŸmek isteniyorsa `requestHeaderMapToTargetAPI` deÄŸiÅŸkenini,
- Backend API'den yanÄ±t Apinizer'a iletildiÄŸindeki halinin baÅŸlÄ±klarÄ±na eriÅŸmek isteniyorsa `responseHeaderMapFromTargetAPI` deÄŸiÅŸkenini,
- Apinizer'Ä±n istemciye dÃ¶ndÃ¼rdÃ¼ÄŸÃ¼ yanÄ±tÄ±n gÃ¶vdesine eriÅŸmek iÃ§in `responseBodyTextToClient` deÄŸiÅŸkenini kullanabilirsiniz.

Bu adÄ±mda, kullanÄ±cÄ± **yeni bir politika oluÅŸturabilir** ya da **mevcut politika parametrelerini yapÄ±landÄ±rarak** eriÅŸim kurallarÄ±nÄ± belirleyebilir. TanÄ±mlanan parametreler, politikanÄ±n Ã§alÄ±ÅŸma ÅŸeklini (Ã¶rneÄŸin hangi IP'lerin izinli olacaÄŸÄ±, coÄŸrafi kÄ±sÄ±tlamalar, koÅŸullu aktivasyonlar vb.) doÄŸrudan etkiler. Bu sayede politika hem kuruma Ã¶zel gereksinimlere gÃ¶re Ã¶zelleÅŸtirilebilir hem de merkezi olarak yÃ¶netilebilir.

## AkÄ±ÅŸ DeÄŸiÅŸkenleri

AÅŸaÄŸÄ±daki tablo Script politikasÄ±nda kullanÄ±labilen tÃ¼m akÄ±ÅŸ deÄŸiÅŸkenlerini, veri tiplerini, izin verilen iÅŸlemleri ve Ã¶rnek kullanÄ±mlarÄ±nÄ± iÃ§ermektedir.

| AkÄ±ÅŸ DeÄŸiÅŸkenleri | Hat | Sahip OlduÄŸu DeÄŸerin Yeri | Veri Tipi | Ä°zin Verilen Ä°ÅŸlem | AÃ§Ä±klama | Ã–rnek KullanÄ±m |
|-------------------|-----|---------------------------|-----------|---------------------|----------|----------------|
| `requestHeaderMapFromClient` | Ä°stek | Client â†’ Apinizer | Map<String, String> | Okuma | Ä°stemciden gelen istek Apinizer'a ulaÅŸtÄ±ÄŸÄ± andaki orijinal halinin baÅŸlÄ±k(header) deÄŸerlerine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = requestHeaderMapFromClient.get("Content-Type");` |
| `requestUrlParamMapFromClient` | Ä°stek | Client â†’ Apinizer | Map<String, String> | Okuma | Ä°stemciden gelen istek Apinizer'a ulaÅŸtÄ±ÄŸÄ± andaki orijinal halinin sorgu(query) parametre deÄŸerlerine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = requestUrlParamMapFromClient.get("param");` |
| `requestBodyTextFromClient` | Ä°stek | Client â†’ Apinizer | String | Okuma | Ä°stemciden gelen istek Apinizer'a ulaÅŸtÄ±ÄŸÄ± andaki orijinal halinin gÃ¶vde deÄŸerine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = requestBodyTextFromClient;` |
| `requestHeaderMapToTargetAPI` | Ä°stek | Apinizer â†’ Backend | Map<String, String> | Okuma, Yazma | Apinizer'Ä±n Backend API'ye gÃ¶ndereceÄŸi isteÄŸin baÅŸlÄ±k deÄŸerlerine eriÅŸmek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `requestHeaderMapToTargetAPI.put("X-Custom-Header", "value");` |
| `requestUrlParamMapToTargetAPI` | Ä°stek | Apinizer â†’ Backend | Map<String, String> | Okuma, Yazma | Apinizer'Ä±n Backend API'ye gÃ¶ndereceÄŸi isteÄŸin URL parametre deÄŸerlerine eriÅŸmek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `requestUrlParamMapToTargetAPI.put("param", "value");` |
| `requestFormUrlEncodedListToTargetAPI` | Ä°stek | Apinizer â†’ Backend | List<NameValuePair> | Okuma, Yazma | Apinizer'Ä±n Backend API'ye gÃ¶ndereceÄŸi isteÄŸin Form URL Encoded parametre deÄŸerlerine eriÅŸmek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `requestFormUrlEncodedListToTargetAPI.add(new NameValuePair("key", "value"));` |
| `requestFormDataListToTargetAPI` | Ä°stek | Apinizer â†’ Backend | List<FormDataPart> | Okuma, Yazma | Apinizer'Ä±n Backend API'ye gÃ¶ndereceÄŸi isteÄŸin Form Data parametre deÄŸerlerine eriÅŸmek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `requestFormDataListToTargetAPI.add(new FormDataPart("key", "value"));` |
| `requestBodyTextToTargetAPI` | Ä°stek | Apinizer â†’ Backend | String | Okuma, Yazma | Apinizer'Ä±n Backend API'ye gÃ¶ndereceÄŸi isteÄŸin gÃ¶vde deÄŸerine eriÅŸmek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `requestBodyTextToTargetAPI = "modified body";` |
| `requestErrorMessageToTargetAPI` | Ä°stek | Apinizer â†’ Backend | String | Yazma | Ä°stek hattÄ±nda politikayÄ± sonlandÄ±rÄ±p Ã¶zelleÅŸtirilmiÅŸ hata mesajÄ± dÃ¶ndÃ¼rmek iÃ§in kullanÄ±lÄ±r. | `requestErrorMessageToTargetAPI = "Custom error message";` |
| `statusCodeToTargetAPI` | Ä°stek | Apinizer â†’ Backend | Integer | Yazma | Ä°stek hattÄ±nda durum kodunu deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `statusCodeToTargetAPI = 400;` |
| `responseHeaderMapFromTargetAPI` | YanÄ±t | Backend â†’ Apinizer | Map<String, String> | Okuma | Backend API'den Apinizer'a gelen yanÄ±tÄ±n orijinal halinin baÅŸlÄ±k deÄŸerlerine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = responseHeaderMapFromTargetAPI.get("Content-Type");` |
| `responseBodyTextFromTargetAPI` | YanÄ±t | Backend â†’ Apinizer | String | Okuma | Backend API'den Apinizer'a gelen yanÄ±tÄ±n orijinal halinin gÃ¶vde deÄŸerine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = responseBodyTextFromTargetAPI;` |
| `responseHeaderMapToClient` | YanÄ±t | Apinizer â†’ Client | Map<String, String> | Okuma, Yazma | Apinizer'Ä±n istemciye dÃ¶ndÃ¼receÄŸi yanÄ±tÄ±n baÅŸlÄ±k deÄŸerlerine eriÅŸmek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `responseHeaderMapToClient.put("X-Custom-Header", "value");` |
| `responseBodyTextToClient` | YanÄ±t | Apinizer â†’ Client | String | Okuma, Yazma | Apinizer'Ä±n istemciye dÃ¶ndÃ¼receÄŸi yanÄ±tÄ±n gÃ¶vde deÄŸerine eriÅŸmek ve deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `responseBodyTextToClient = "modified response";` |
| `responseErrorMessageToClient` | YanÄ±t | Apinizer â†’ Client | String | Yazma | YanÄ±t hattÄ±nda politikayÄ± sonlandÄ±rÄ±p Ã¶zelleÅŸtirilmiÅŸ hata mesajÄ± dÃ¶ndÃ¼rmek iÃ§in kullanÄ±lÄ±r. | `responseErrorMessageToClient = "Custom error message";` |
| `statusCodeToClient` | YanÄ±t | Apinizer â†’ Client | Integer | Yazma | YanÄ±t hattÄ±nda durum kodunu deÄŸiÅŸtirmek iÃ§in kullanÄ±lÄ±r. | `statusCodeToClient = 403;` |
| `requestUrlFromClient` | Ä°stek | Client â†’ Apinizer | String | Okuma | MesajÄ±n geldiÄŸi URL path'ini tutar. | `String url = requestUrlFromClient;` |
| `requestBackendUrlToTargetAPI` | Ä°stek | Apinizer â†’ Backend | String | Yazma | Ä°steÄŸin gideceÄŸi Backend URL kapsam yolu(context path) deÄŸiÅŸtirilmek istenirse bu deÄŸiÅŸken ayarlanabilir. | `requestBackendUrlToTargetAPI = "/new/path";` |
| `customVariableMap` | Ä°stek/YanÄ±t | Ã‡alÄ±ÅŸma ZamanÄ± | Map<String, String> | Okuma, Yazma | Ä°ÅŸ mantÄ±ÄŸÄ±na Ã¶zel olarak deÄŸiÅŸken oluÅŸturulabilir, bu deÄŸiÅŸkenlere istek ve yanÄ±t hattÄ±nda okuma ve yazma iÅŸlemi yapÄ±labilir. | `customVariableMap.put("key", "value");` |
| `contextValues` | Ä°stek/YanÄ±t | Ã‡alÄ±ÅŸma ZamanÄ± | Map<String, Object> | Okuma | Apinizer'Ä±n her bir istek iÃ§in isteÄŸe Ã¶zel tuttuÄŸu verileri okumak iÃ§in kullanÄ±lÄ±r. | `Object value = contextValues.get("key");` |
| `credential_username` | Ã‡alÄ±ÅŸma ZamanÄ± | String | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "kullanÄ±cÄ± adÄ±" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = credential_username;` |
| `credential_password` | Ã‡alÄ±ÅŸma ZamanÄ± | String | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "parola" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = credential_password;` |
| `credential_email` | Ã‡alÄ±ÅŸma ZamanÄ± | String | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "e-posta" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = credential_email;` |
| `credential_fullName` | Ã‡alÄ±ÅŸma ZamanÄ± | String | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "tam adÄ±" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `String value = credential_fullName;` |
| `credential_secretKey` | Ã‡alÄ±ÅŸma ZamanÄ± | javax.crypto.SecretKey | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "Secret Key" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `javax.crypto.SecretKey value = credential_secretKey;` |
| `credential_certificate` | Ã‡alÄ±ÅŸma ZamanÄ± | java.security.cert.X509Certificate | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "Certificate" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `java.security.cert.X509Certificate value = credential_certificate;` |
| `credential_publicKey` | Ã‡alÄ±ÅŸma ZamanÄ± | java.security.PublicKey | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "Public Key" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `java.security.PublicKey value = credential_publicKey;` |
| `credential_privateKey` | Ã‡alÄ±ÅŸma ZamanÄ± | java.security.PrivateKey | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "Private Key" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `java.security.PrivateKey value = credential_privateKey;` |
| `credential_keyStore` | Ã‡alÄ±ÅŸma ZamanÄ± | java.security.KeyStore | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "Keystore" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `java.security.KeyStore value = credential_keyStore;` |
| `credential_trustStore` | Ã‡alÄ±ÅŸma ZamanÄ± | java.security.KeyStore | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "Truststore" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `java.security.KeyStore value = credential_trustStore;` |
| `credential_jwkForValidationAndSign` | Ã‡alÄ±ÅŸma ZamanÄ± | com.apinizer.common.apigw.jwk.Jwk | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "imzalama ve imza doÄŸrulama iÃ§in kullanÄ±lan JWK" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `com.apinizer.common.apigw.jwk.Jwk value = credential_jwkForValidationAndSign;` |
| `credential_jwkForDecryptionAndEncryption` | Ã‡alÄ±ÅŸma ZamanÄ± | com.apinizer.common.apigw.jwk.Jwk | Okuma | Politikadan Ã¶nce ayarlanmÄ±ÅŸ olan credential'Ä±n "ÅŸifreleme ve ÅŸifre Ã§Ã¶zme iÃ§in kullanÄ±lan JWK" bilgisine eriÅŸmek iÃ§in kullanÄ±lÄ±r. | `com.apinizer.common.apigw.jwk.Jwk value = credential_jwkForDecryptionAndEncryption;` |

## Ã–zel DeÄŸiÅŸkenler

| AkÄ±ÅŸ DeÄŸiÅŸkenleri | Veri Tipi | Ä°zin Verilen Ä°ÅŸlem | AÃ§Ä±klama |
|-------------------|-----------|---------------------|----------|
| `customVariableMap` | Map<String, String> | Okuma, Yazma | Ä°stek veya YanÄ±t hattÄ±nda politikalar ile geÃ§ici olarak deÄŸiÅŸken tanÄ±mlanmasÄ± yapmak ve bir sonraki politikada kullanmak ihtiyacÄ± ortaya Ã§Ä±kabilir. Bu durumda "customVariableMap" deÄŸiÅŸkeni kullanÄ±lÄ±r. Ã–rneÄŸin; Bir API Proxy'nin script politikasÄ±ndan Ã¶nceki politikasÄ±nda iÅŸ kuralÄ± politikasÄ± ile oluÅŸturulan "testVariable" ismindeki deÄŸiÅŸkene script politikasÄ±nda eriÅŸmek ve deÄŸerini deÄŸiÅŸtirmek gerekebilir. Bu durumda `customVariableMap.get("testVariable")` diyerek bu deÄŸiÅŸkene atanan deÄŸer okunmuÅŸ olur. Benzer ÅŸekilde script politikasÄ±nda Ã¶zel deÄŸiÅŸken oluÅŸturmak iÃ§in `customVariableMap.put("testVariable","test value")` ÅŸeklinde kullanÄ±m yapÄ±lmasÄ± gerekir. BÃ¶ylece bir sonraki politikada custom variable tipinde ve "testVariable" adÄ±nda bir deÄŸiÅŸken oluÅŸturularak script politikasÄ±nda eklenen deÄŸere eriÅŸilebilir. |

**Ã–nemli Notlar:**

- Ä°stek HattÄ±na eklenen Script PolitikasÄ± **YanÄ±t HattÄ±ndaki** deÄŸiÅŸkenlere **eriÅŸemez**.
- YanÄ±t HattÄ±na eklenen Script PolitikasÄ± ise **Ä°stek HattÄ±ndaki** deÄŸiÅŸkenleri **sadece okuyabilir**.

## BaÅŸlÄ±k ya da Parametre'nin DeÄŸerinin Ã‡oÄŸul Olma Durumu

BaÅŸlÄ±k ve Parametre bilgilerine deÄŸer atarken, bazÄ± durumlarda aynÄ± anahtara ait Ã§oklu deÄŸer olabilmektedir.

Bu durum script politikasÄ±nda aÅŸaÄŸÄ±daki ÅŸekilde ele alÄ±nÄ±r.

Apinizer Script politikasÄ±ndaki **backward compatibility** kÄ±sÄ±tlamasÄ±ndan dolayÄ±, bu anahtar deÄŸeri Ã§oÄŸul ise okuma iÅŸlemi yapÄ±lÄ±rken **#** ile ayrÄ±ÅŸtÄ±rÄ±labilir. EÄŸer tekil ise, normal string olarak iÅŸlem yapÄ±lmalÄ±dÄ±r.

### BaÅŸlÄ±k'Ä±n Ã‡oklu OlmasÄ±

```groovy
// reading from header map
String headerVal = requestHeaderMapToTargetAPI.get("multipleHeaderTest");
String[] headerArr = headerVal.split("#");

for (String val : headerArr) {
    // do some stuff with multiple values of "multipleHeaderTest"
}

headerVal = requestHeaderMapToTargetAPI.get("oneHeaderTest");
// do some stuff with single value of "oneHeaderTest"

// adding a new header "value" to existing one 
headerVal = headerVal + "#newHeaderScriptVal";
requestHeaderMapToTargetAPI.put("multipleHeaderTest", headerVal);
```

### Parametrenin Ã‡oklu OlmasÄ±

```groovy
// reading from param map
String paramVal = requestUrlParamMapToTargetAPI.get("multipleParamTest[]");
String[] paramArr = paramVal.split("#");

for (String val : paramArr) {
    // do some stuff with multiple values of "multipleParamTest"
}

paramVal = requestUrlParamMapToTargetAPI.get("oneParamTest");
// do some stuff with single value of "oneParamTest"

// adding a new param "value" to existing one 
paramVal = requestUrlParamMapToTargetAPI.get("multipleParamTest[]") + "#newParamScriptVal";
requestUrlParamMapToTargetAPI.put("multipleParamTest[]", paramVal);
```

## Script'in Test Edilmesi

KonfigÃ¼rasyon alanÄ±nÄ±n altÄ±ndaki **Dene (Try it)** butonu ile yazÄ±lan Script test edilebilir.

Script Test ayarlarÄ±nÄ± iÃ§eren dialoga ait gÃ¶rselde:

- **Request/Response Region**: Script'in hangi bÃ¶lgede Ã§alÄ±ÅŸacaÄŸÄ±nÄ± seÃ§ebilirsiniz (From Client, To Backend, From Backend, To Client).
- **Test Verileri**: Ã–rnek header, parametre ve body verileri girebilirsiniz.
- **SonuÃ§ (Result)**: SonuÃ§ bÃ¶lÃ¼mÃ¼nde yalnÄ±zca Target alanÄ±ndaki deÄŸiÅŸiklikler gÃ¶sterilir.

### Yeni Script PolitikasÄ± OluÅŸturma

| AdÄ±m | AÃ§Ä±klama / Ä°ÅŸlem |
|------|------------------|
| **AdÄ±m 1: OluÅŸturma SayfasÄ±na Gitme** | - Sol menÃ¼den **Development â†’ Global Settings â†’ Global Policies â†’ Script PolitikasÄ±** bÃ¶lÃ¼mÃ¼ne gidin.<br>- SaÄŸ Ã¼stteki **[+ Create]** butonuna tÄ±klayÄ±n. |
| **AdÄ±m 2: Temel Bilgileri Girme** | **Policy Status (Politika Durumu):** Aktif/Pasif durumu gÃ¶sterir. Yeni politikalar varsayÄ±lan olarak aktiftir.<br><br>**Name (Ä°sim) Zorunlu:** Ã–rnek: `Production_ScriptPolicy`<br>- Benzersiz isim girin, boÅŸlukla baÅŸlamaz.<br>- Sistem otomatik kontrol eder. YeÅŸil tik: kullanÄ±labilir. KÄ±rmÄ±zÄ± Ã§arpÄ±: mevcut isim.<br><br>**Description (AÃ§Ä±klama):** Ã–rnek: "Ä°stek hattÄ±nda kampanya header'Ä± ekler."<br>- Maks. 1000 karakter.<br>- PolitikanÄ±n amacÄ±nÄ± aÃ§Ä±klayÄ±n. |
| **AdÄ±m 3: ExecutionType SeÃ§imi** | - **Execution Type** bÃ¶lÃ¼mÃ¼nde `Sync` veya `Async` seÃ§in.<br>- `Sync` seÃ§ildiÄŸinde script gateway pipeline'Ä±nda eÅŸzamanlÄ± yÃ¼rÃ¼r.<br>- `Async`, uzun sÃ¼ren operasyonlarda istemciyi bekletmemek iÃ§in uygun olup yan kanal tetikler. |
| **AdÄ±m 4: Script Dili YapÄ±landÄ±rmasÄ±** | - **Script Language** altÄ±nda `Javascript` veya `Groovy` seÃ§in.<br>- SeÃ§im kod editÃ¶rÃ¼nÃ¼n sÃ¶zdizimini ve IntelliSense'i belirler.<br>- Dili deÄŸiÅŸtirmek, mevcut script gÃ¶vdesini etkilemez ancak Ã§alÄ±ÅŸtÄ±rma modunu gÃ¼nceller. |
| **AdÄ±m 5: Script GÃ¶vdesi ve DeÄŸiÅŸken YÃ¶netimi** | - Kod editÃ¶rÃ¼ne scriptinizi yazÄ±n veya yapÄ±ÅŸtÄ±rÄ±n.<br>- DeÄŸiÅŸken etiketlerinden `requestHeaderMapToTargetAPI`, `responseBodyTextToClient` gibi alanlarÄ± bir tÄ±klamayla panoya kopyalayÄ±n.<br>- `customVariableMap` Ã¼zerinden diÄŸer politikalara veri aktarabilirsiniz.<br>- **Try It** butonu ile test diyaloÄŸunu aÃ§Ä±p Ã¶rnek giriÅŸlerle scripti Ã§alÄ±ÅŸtÄ±rÄ±n. |
| **AdÄ±m 6: KoÅŸul TanÄ±mlama (Ä°steÄŸe BaÄŸlÄ±)** | - **Condition** sekmesine geÃ§in.<br>- KoÅŸullar, politikanÄ±n hangi durumda aktif olacaÄŸÄ±nÄ± belirler.<br><br>**Ã–rnekler:**<br>- Ortam bazlÄ±: `Header = X-Environment, Operator = Equals, Value = production`<br>- API Key bazlÄ±: `Header = X-API-Key, Starts With = PROD-`<br>- Endpoint bazlÄ±: `Path = /api/admin/*`<br><br>KoÅŸul tanÄ±mlamazsa politika her zaman aktif<br><br>Detaylar iÃ§in bakabilirsiniz: [KoÅŸullar (Conditions)](/tr/gelistirici/politikalar/politika-nedir#conditions) |
| **AdÄ±m 7: Hata MesajÄ± Ã–zelleÅŸtirme (Ä°steÄŸe BaÄŸlÄ±)** | - **Error Message Customization** sekmesine gidin.<br>- EriÅŸim reddedildiÄŸinde dÃ¶necek mesajÄ± Ã¶zelleÅŸtirin.<br><br>**VarsayÄ±lan:**<br>```json<br>{<br>  "statusCode": 500,<br>  "message": "Script policy failed! Error message is: {0}"<br>}<br>```<br><br>**Ã–zel:**<br>```json<br>{<br>  "statusCode": 401,<br>  "errorCode": "SCRIPT_ERROR",<br>  "message": "Script Ã§alÄ±ÅŸtÄ±rma hatasÄ± oluÅŸtu."<br>}<br>``` |
| **AdÄ±m 8: Kaydetme** | - SaÄŸ Ã¼stteki **[Save]** butonuna tÄ±klayÄ±n.<br><br>**Kontrol Listesi:** Benzersiz isim. Zorunlu alanlar dolu. En az bir script gÃ¶vdesi satÄ±rÄ± mevcut<br><br>**SonuÃ§:**<br>- Politika listeye eklenir.<br>- API'lere baÄŸlanabilir.<br>- Global politikaysa otomatik uygulanÄ±r. |

## PolitikayÄ± Silme

Bu politikanÄ±n silme adÄ±mlarÄ± ve kullanÄ±mdayken uygulanacak iÅŸlemler, [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±ndaki **PolitikayÄ± Silme** bÃ¶lÃ¼mÃ¼nde detaylÄ± olarak aÃ§Ä±klanmÄ±ÅŸtÄ±r. AyrÄ±ntÄ±lÄ± bilgi iÃ§in ilgili bÃ¶lÃ¼me bakabilirsiniz: [PolitikayÄ± Silme](/tr/gelistirici/politikalar/politika-nedir#politikayÄ±-silme)

## PolitikayÄ± DÄ±ÅŸa/Ä°Ã§e Aktarma

Bu politikanÄ±n dÄ±ÅŸa aktarma (Export) adÄ±mlarÄ± ve kullanÄ±labilecek seÃ§enekler, [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±ndaki **DÄ±ÅŸa Aktarma Ä°ÅŸlemi** bÃ¶lÃ¼mÃ¼nde aÃ§Ä±klanmaktadÄ±r. AyrÄ±ntÄ±lÄ± bilgi iÃ§in ilgili bÃ¶lÃ¼me bakabilirsiniz: [PolitikayÄ± DÄ±ÅŸa/Ä°Ã§e Aktarma](/tr/gelistirici/politikalar/politika-nedir#politikayÄ±-dÄ±ÅŸa-iÃ§e-aktarma)

## PolitikayÄ± API'ye BaÄŸlama

Bu politikanÄ±n API'lere nasÄ±l baÄŸlanacaÄŸÄ±na iliÅŸkin sÃ¼reÃ§, [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±ndaki **PolitikayÄ± API'ye BaÄŸlama** bÃ¶lÃ¼mÃ¼nde detaylandÄ±rÄ±lmÄ±ÅŸtÄ±r. AyrÄ±ntÄ±lÄ± bilgi iÃ§in ilgili bÃ¶lÃ¼me gÃ¶z atabilirsiniz: [PolitikayÄ± API'ye BaÄŸlama](/tr/gelistirici/politikalar/politika-nedir#politikayÄ±-apiye-baÄŸlama)

## Ä°leri DÃ¼zey Ã–zellikler

| Ã–zellik | AÃ§Ä±klama ve AdÄ±mlar |
|---------|---------------------|
| **Script Test DiyaloÄŸu** | - **Try It** butonu ile aÃ§Ä±lÄ±r.<br>- Request/Response region seÃ§ilerek Ã¶rnek veri girilir.<br>- Ã‡alÄ±ÅŸtÄ±rma sonucu JSON olarak incelenip script iyileÅŸtirilir.<br>- Detaylar iÃ§in yukarÄ±daki "Script'in Test Edilmesi" bÃ¶lÃ¼mÃ¼ne bakabilirsiniz. |
| **Context Value KÃ¼tÃ¼phanesi** | - **Context Values** select bileÅŸeninden kategori seÃ§ilir.<br>- SeÃ§im yapÄ±ldÄ±ÄŸÄ±nda deÄŸer panoya kopyalanÄ±r.<br>- Script iÃ§inde doÄŸrudan kullanÄ±larak ortam bilgisi alÄ±nÄ±r. |
| **WebSocket/gRPC UyarlamasÄ±** | - Proxy tÃ¼rÃ¼ WebSocket/gRPC ise deÄŸiÅŸken listeleri otomatik daraltÄ±lÄ±r.<br>- Uygun mesaj akÄ±ÅŸÄ± deÄŸiÅŸkenleri sunulur.<br>- Script bu protokollerde hatalarÄ± yÃ¶netebilir.<br>- WebSocket ve gRPC iÃ§in Script Policy'de sadece hata mesajlarÄ± ve context verileriyle ilgili belirli deÄŸiÅŸkenler kullanÄ±labilir: `responseErrorMessageToClient`, `requestErrorMessageToTargetAPI` |
| **BaÅŸlÄ±k ve Parametre Ã‡oÄŸul DeÄŸer YÃ¶netimi** | - AynÄ± anahtara ait Ã§oklu deÄŸerler **#** karakteri ile ayrÄ±ÅŸtÄ±rÄ±lÄ±r.<br>- Okuma iÅŸlemlerinde `split("#")` kullanÄ±larak Ã§oklu deÄŸerler iÅŸlenebilir.<br>- Yazma iÅŸlemlerinde Ã§oklu deÄŸerler **#** ile birleÅŸtirilerek atanabilir. |
| **Custom Variable Map KullanÄ±mÄ±** | - Ä°stek ve yanÄ±t hattÄ±nda politikalar arasÄ± veri aktarÄ±mÄ± iÃ§in kullanÄ±lÄ±r.<br>- `customVariableMap.put("key", "value")` ile deÄŸiÅŸken oluÅŸturulur.<br>- `customVariableMap.get("key")` ile deÄŸiÅŸken okunur.<br>- Ä°ÅŸ kuralÄ± politikasÄ± ile entegre Ã§alÄ±ÅŸÄ±r. |

## KoÅŸullar ve Hata MesajÄ± Ã–zelleÅŸtirme

**KoÅŸullar** ve **Hata MesajÄ± Ã–zelleÅŸtirme** panellerinin aÃ§Ä±klamasÄ±nÄ± gÃ¶rÃ¼ntÃ¼lemek iÃ§in [Politikalar (Policies)](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±nÄ± ziyaret edebilirsiniz.

## Best Practices

### YapÄ±lmasÄ± Gerekenler ve En Ä°yi Uygulamalar

| Kategori | AÃ§Ä±klama / Ã–neriler |
|----------|---------------------|
| **Script YapÄ±landÄ±rmasÄ±** | **KÃ¶tÃ¼:** TÃ¼m mantÄ±ÄŸÄ± tek fonksiyonda yazmak.<br>**Ä°yi:** MantÄ±ÄŸÄ± fonksiyonlara bÃ¶lmek.<br>**En Ä°yi:** Ortak fonksiyonlarÄ± paylaÅŸÄ±lan modÃ¼llerde tutup scripti sade bÄ±rakmak. |
| **Hata YÃ¶netimi** | **KÃ¶tÃ¼:** HatalarÄ± yutmak ve varsayÄ±lan 500 beklemek.<br>**Ä°yi:** Hata durumunda `responseErrorMessageToClient` set etmek.<br>**En Ä°yi:** Hem mesajÄ± hem `statusCodeToClient` deÄŸerini iÅŸ senaryosuna gÃ¶re ayarlamak. |
| **Versiyonlama** | **KÃ¶tÃ¼:** Scripti doÄŸrudan prod ortamÄ±nda deÄŸiÅŸtirmek.<br>**Ä°yi:** DeÄŸiÅŸiklik Ã¶ncesi export almak.<br>**En Ä°yi:** Test ortamÄ±nda yeni sÃ¼rÃ¼mÃ¼ import edip deploy ettikten sonra canlÄ±ya taÅŸÄ±mak. |
| **KoÅŸul KullanÄ±mÄ±** | **KÃ¶tÃ¼:** PolitikanÄ±n her istekte Ã§alÄ±ÅŸmasÄ±na izin vermek.<br>**Ä°yi:** Temel path koÅŸulu eklemek.<br>**En Ä°yi:** Header, yÃ¶ntem ve ortam kombinasyonlarÄ±yla koÅŸullarÄ± spesifikleÅŸtirmek. |
| **Performans Ä°zleme** | **KÃ¶tÃ¼:** Async scriptlerin tamamlanma sÃ¼resini takip etmemek.<br>**Ä°yi:** Loglarda script sÃ¼relerini izlemek.<br>**En Ä°yi:** Gecikme artarsa scripti profil edip optimize etmek, gerekiyorsa cache kullanmak. |

### GÃ¼venlik En Ä°yi UygulamalarÄ±

| GÃ¼venlik AlanÄ± | AÃ§Ä±klama / UyarÄ±lar |
|----------------|---------------------|
| **Veri Maskeleme** | KiÅŸisel verileri yanÄ±tta maskeleyin, scriptte regex doÄŸrulamasÄ± yapÄ±n. |
| **Girdi DoÄŸrulama** | Script iÃ§ine alÄ±nan parametrelerde beklenen formatÄ± kontrol edin, hatalÄ±ysa hata kodu dÃ¶ndÃ¼rÃ¼n. |
| **Exception YÃ¶netimi** | Try/catch bloklarÄ±yla beklenmeyen hatalarÄ± yakalayÄ±n, loglayÄ±n, kullanÄ±cÄ±ya sÄ±nÄ±rlÄ± bilgi verin. |
| **Harici Ã‡aÄŸrÄ±lar** | Script iÃ§inde dÄ±ÅŸ sistem Ã§aÄŸrÄ±sÄ± yapacaksanÄ±z zaman aÅŸÄ±mÄ± ve retry sÄ±nÄ±rÄ± koyun; async mod tercih edin. |
| **Yetki MantÄ±ÄŸÄ±** | Header veya JWT claim kontrollerini scriptte merkezi hale getirerek yetkisiz eriÅŸimi engelleyin. |

### KaÃ§Ä±nÄ±lmasÄ± Gerekenler

| Kategori | AÃ§Ä±klama / UyarÄ±lar |
|----------|---------------------|
| **Uzun SÃ¼reli Ä°ÅŸlemler** | **Neden kaÃ§Ä±nÄ±lmalÄ±:** Sync modda gateway thread'lerini bloklar.<br>**Alternatif:** Async moda geÃ§in veya arka plan servisine delegasyon yapÄ±n. |
| **Hard-coded URL** | **Neden kaÃ§Ä±nÄ±lmalÄ±:** Ortam deÄŸiÅŸtiÄŸinde script kÄ±rÄ±lÄ±r.<br>**Alternatif:** Context value veya environment deÄŸiÅŸkenlerini kullanÄ±n. |
| **Global Scriptte Test EdilmemiÅŸ Kod** | **Neden kaÃ§Ä±nÄ±lmalÄ±:** TÃ¼m API Proxy trafiÄŸini etkiler.<br>**Alternatif:** Ã–nce local script olarak test edin, sonra globalleÅŸtirin. |

## SÄ±k Sorulan Sorular (SSS)

| Kategori | Soru (S) | Cevap (C) |
|----------|----------|-----------|
| **Genel** | Script PolitikasÄ± nedir? | HTTP istek/yanÄ±t hattÄ±nda koÅŸullu script Ã§alÄ±ÅŸtÄ±rarak veri ve baÅŸlÄ±klarÄ± dinamik olarak dÃ¶nÃ¼ÅŸtÃ¼ren bir politikadÄ±r. |
| **Genel** | Hangi script dilleri destekleniyor? | Groovy ve Javascript desteklenir. |
| **Teknik** | Sync ve Async arasÄ±ndaki fark nedir? | Sync modda script eÅŸzamanlÄ± yÃ¼rÃ¼r ve gateway thread'ini bloklar. Async modda arka planda Ã§alÄ±ÅŸÄ±r ve istemciyi bekletmez. |
| **Teknik** | Script iÃ§inde hangi deÄŸiÅŸkenlere eriÅŸebilirim? | From Client, To Backend, From Backend ve To Client akÄ±ÅŸlarÄ± iÃ§in hazÄ±r deÄŸiÅŸken haritalarÄ± mevcuttur. `customVariableMap` ile diÄŸer politikalara veri aktarabilirsiniz. |
| **KullanÄ±m** | Script'i nasÄ±l test edebilirim? | **Try It** butonu ile test diyaloÄŸunu aÃ§Ä±p Ã¶rnek header/param/body verileriyle scripti Ã§alÄ±ÅŸtÄ±rabilirsiniz. |
| **KullanÄ±m** | Script hatalarÄ±nÄ± nasÄ±l yÃ¶netmeliyim? | Try/catch bloklarÄ±yla hatalarÄ± yakalayÄ±n, `responseErrorMessageToClient` ve `statusCodeToClient` deÄŸerlerini set edin. |
