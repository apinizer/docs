---
title: 'Script'
description: 'Script politikası ile istek veya yanıt mesajlarındaki başlık, parametre, gövde ve hata mesajı içeriklerini script dili ile işleme'
---

# Script (Script)

Script politikası ile istek veya yanıt mesajlarındaki başlık (header), parametre (parameter), gövde (body) ve hata mesajı (error message) içerikleri seçilen script dili ile işlenebilir.

**Politika ayarlarını içeren görsele aşağıda yer verilmiştir:**

![Script Politikası](https://docs.apinizer.com/apinizer-dokumantasyonu/files/1179945/120521255/1/1733912856804/image-2024-12-11_13-27-36.png)

Politika konfigürasyonu için kullanılan alanlar aşağıdaki tabloda görülmektedir.

| Alan | Açıklama |
| --- | --- |
| İsim *(Name)* | Politikanın kullanımını ve yönetimini kolaylaştırmak için isim yazılabilir. Politikaların yönetimi ve seçimi sırasında bu isme ihtiyacınız olacaktır. |
| Açıklama *(Description)* | Politikanın kullanımını ve yönetimini kolaylaştırmak için açıklama yazılabilir. |
| Execution Tipi *(Execution Type)* | Çalıştırılacak olan Script'in Senkron yada Asenkron olarak çalışması belirlenebilir. |
| Script Dili *(Script Language)* | Yazılacak olan Script'in tipidir. Javascript veya Groovy olabilir. |
| Script Gövdesi *(Script Body)* | Çalıştırılacak olan Script kodu yazılır. Mesajın bölgelerine göre verilen değişkenlere ait linklere tıklayarak gövde alanına eklenebilir. |
| Dene *(Try it)* | Çalıştırılacak olan scriptin denemesinin yapılabilmesi için yeni bir pencere açılmasını sağlar. |

**WebSocket** ve **gRPC** için Script Policy'de sadece hata mesajları ve context verileriyle ilgili belirli değişkenler kullanılabilir.

Kullanılabilir değişkenler: responseErrorMessageToClient, requestErrorMessageToTargetAPI

## Script Politikasının Çalışması Hakkında

Gelen istek mesajın orijinal hali ile dönen yanıt mesajının orijinal hali üzerinde değişiklik yapılamaz, bu veriler üzerinde **sadece okuma** yapılabilir.

Backend API'ye gönderilecek olan istek ile istemciye dönecek yanıt üzerinde ise **hem okuma hem de değişiklik** yapılabilir.

Yapılacak olan okuma ve değişiklik işlemleri mesajın başlık, parametre ve gövde kısımlarını içerir. Bu alanlara script üzerinde erişim için çeşitli anahtar kelimeler kullanılmıştır. Bu anahtar kelimeler erişilmek istenen bölgeye göre değişmektedir.

Anahtar kelimeleri formülüze etmek istersek aşağıdaki şekilde ifade edebiliriz:

- Başlıklara erişmek için → `<request|response>HeaderMap<From|To><Client|TargetAPI>`
- URL parametrelerine erişmek için → `<request>UrlParamMap<From|To><Client|TargetAPI>`
- Form URL Encoded parametrelerine erişmek için → `<request>FormUrlEncodedList<From|To><Client|TargetAPI>`
- Form Data parametrelerine erişmek için → `<request>FormDataList<From|To><Client|TargetAPI>`
- Gövdeye erişmek için → `<request|response>BodyText<From|To><Client|TargetAPI>`
- Politikayı sonlandırıp özelleştirilmiş hata mesajı döndürmek için → `<request|response>ErrorMessage<From|To><Client|TargetAPI>` gösterimini kullanmanız gerekir.
- Durum kodunu değiştirmek için → `statusCode<From|To><Client|TargetAPI>`

Bu anahtar kelimeler dışında kullanılan anahtar kelimeler:

- **requestUrlFromClient**: Mesajın geldiği URL path'ini tutar
- **requestBackendUrlToTargetAPI**: Eğer isteği gideceği Backend URL kapsam yolu(context path) değiştirilmek istenirse bu değişken ayarlanabilir.
- **customVariableMap**: İş mantığına özel olarak değişken oluşturulabilir, bu değişkenlere istek ve yanıt hattında okuma ve yazma işlemi yapılabilir. İş kuralı politikasında da map'e eklenen anahtar kelime üzerinden değerinin kullanılması sağlanabilir.
- **contextValues**: Apinizer'ın her bir istek için isteğe özel tuttuğu verileri okumak için bu değerlerden faydalanabilir. Bu değerler üzerinde sadece okuma yapılabilir.

Örneğin;

- İstemciden gelen istek Apinizer'a ulaştığında yani isteğin orijinal halinin gövde içeriğine erişmek isteniyorsa *requestBodyTextFromClient* değişkenini,
- Apinizer gelen isteği *Backend* API'ye iletirkenki halinin başlıklarına erişmek isteniyorsa *requestHeaderMapToTargetAPI* değişkenini,
- Backend API'den yanıt Apinizer'a iletildiğindeki halinin başlıklarına erişmek isteniyorsa *responseHeaderMapFromTargetAPI* değişkenini,
- Apinizer'ın istemciye döndürdüğü yanıtın gövdesine erişmek için *responseBodyTextToClient* değişkenini kullanabilirsiniz.

## Akış Değişkenleri

Script politikasında kullanılabilecek akış değişkenleri ve detaylı açıklamaları için [Politikalar (Policies)](/tr/gelistirici/politika-yonetimi) sayfasındaki Script bölümünü ziyaret edebilirsiniz.
