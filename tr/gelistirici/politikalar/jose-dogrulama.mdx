---
title: "JOSE DoÄŸrulama"
description: "JOSE/JWT iÃ§eriklerini imza, ÅŸifreleme ve claim kurallarÄ±na gÃ¶re doÄŸrular"
---

**Son GÃ¼ncelleme:** 10 KasÄ±m 2025  
**Hedef Kitle:** Sistem YÃ¶neticileri, Backend GeliÅŸtiriciler, DevOps MÃ¼hendisleri

**ğŸ’¡ Politikalar hakkÄ±nda bilginiz var mÄ±?**  
Bu dokÃ¼man spesifik bir politikanÄ±n detaylÄ± kullanÄ±mÄ±nÄ± anlatÄ±r. EÄŸer Apinizer politika yapÄ±sÄ±nÄ± ilk kez kullanÄ±yorsanÄ±z veya politikalarÄ±n genel Ã§alÄ±ÅŸma prensiplerini Ã¶ÄŸrenmek istiyorsanÄ±z, Ã¶ncelikle [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±nÄ± okumanÄ±zÄ± Ã¶neririz.

| **Politika AdÄ±** | JOSE DoÄŸrulama PolitikasÄ± |
|---|:---|
| **Ã–zet** | JOSE/JWT iÃ§eriklerini imza, ÅŸifreleme ve claim kurallarÄ±na gÃ¶re doÄŸrular. |
| **Kategori** | GÃ¼venlik ve EriÅŸim KontrolÃ¼ |
| **DÃ¶nÃ¼ÅŸ Durum KodlarÄ±** | <table><thead><tr><th>Hata Kodu</th><th>Hata MesajÄ±</th><th>HTTP Durum Kodu</th></tr></thead><tbody><tr><td>ERR-159</td><td>JWK for Signature Validation was not set in policy!</td><td>500</td></tr><tr><td>ERR-160</td><td>JWK for Signature Validation in policy was not found!</td><td>500</td></tr><tr><td>ERR-161</td><td>JWK for Decryption is not set in policy!</td><td>500</td></tr><tr><td>ERR-162</td><td>JWK for Decryption was not found!</td><td>500</td></tr><tr><td>ERR-163</td><td>JWK for Signature Validation in client's credential is not set!</td><td>500</td></tr><tr><td>ERR-164</td><td>JWK for Signature Validation in client's credential was not found!</td><td>500</td></tr><tr><td>ERR-165</td><td>JWK for Decryption in client's credential is not set!</td><td>500</td></tr><tr><td>ERR-166</td><td>JWK for Decryption in client's credential was not found!</td><td>500</td></tr><tr><td>ERR-167</td><td>Target value was not found or empty!</td><td>500</td></tr><tr><td>ERR-168</td><td>Client value was not found or empty!</td><td>500</td></tr><tr><td>ERR-169</td><td>JWT parse operation failed! Error message is: {0}</td><td>500</td></tr><tr><td>ERR-170</td><td>JWE decryption operation was failed! Error message is: {0}</td><td>500</td></tr><tr><td>ERR-171</td><td>JWT is not in Encrypted format!</td><td>500</td></tr><tr><td>ERR-172</td><td>JWE signature validation operation was failed! Error message is: {0}</td><td>500</td></tr><tr><td>ERR-173</td><td>JWT is not in Signed format! Format is plain or encrypted!</td><td>500</td></tr><tr><td>ERR-174</td><td>JWT Claims were not valid! Error message is: {0}</td><td>500</td></tr><tr><td>ERR-175</td><td>JOSE Validation policy was failed! Error message is: {0}</td><td>500</td></tr><tr><td>ERR-182</td><td>Signature in message is not valid or can not be verified!</td><td>401</td></tr><tr><td>ERR-189</td><td>JWK was expired!</td><td>500</td></tr></tbody></table> |

## Genel BakÄ±ÅŸ

### AmacÄ± Nedir?

- API Proxy (API Vekil Sunucusu) akÄ±ÅŸÄ±na giren JOSE/JWT tokenlarÄ±nÄ± doÄŸrulayarak kimlik bilgilerinin gÃ¼venilirliÄŸini garanti altÄ±na almak Ã¼zere tasarlanmÄ±ÅŸtÄ±r.
- Belirlenen issuer, audience ve claim kurallarÄ±nÄ± zorunlu tutarak yetkisiz eriÅŸimlerin Ã¶nÃ¼ne geÃ§er ve hassas endpoint'lerin korunmasÄ±nÄ± saÄŸlar.
- ÅifrelenmiÅŸ JWE iÃ§eriklerini gÃ¼venli ÅŸekilde Ã§Ã¶zerek aÅŸaÄŸÄ± akÄ±ÅŸ servislerine temizlenmiÅŸ veri aktarÄ±mÄ± sunar.
- Kimlik ve rol bilgisini header seviyesinde yayarak downstream servislerde merkezi yetkilendirme politikalarÄ± ile entegre Ã§alÄ±ÅŸÄ±r.

### Ã‡alÄ±ÅŸma Prensibi

1. **Ä°stek GeliÅŸi**: API Gateway'e gelen her HTTP/HTTPS isteÄŸi iÃ§in, istemin kaynak IP adresi tespit edilir.
2. **Politika KontrolÃ¼**: JOSE DoÄŸrulama politikasÄ± aktif ise, sistem aÅŸaÄŸÄ±daki sÄ±rayla kontrol yapar:
   - Condition (koÅŸul) tanÄ±mlÄ± mÄ±? Varsa koÅŸul saÄŸlanÄ±yor mu?
   - Politika aktif mi (active=true)?
   - Variable kullanÄ±lÄ±yor mu yoksa Apinizer default mÄ±?
3. **JOSE Ä°Ã§eriÄŸi Ã‡Ã¶zÃ¼mleme**: Token belirlenen kaynaktan (body, Authorization header veya deÄŸiÅŸken) okunur; gerekiyorsa seÃ§ilen JWK ile ÅŸifre Ã§Ã¶zÃ¼mÃ¼ yapÄ±lÄ±r ve claim seti doÄŸrulamaya hazÄ±rlanÄ±r.
4. **Karar Verme**:
   - **EÅŸleÅŸme Var**: Ä°mza/ÅŸifreleme geÃ§erli ise, claim ve audience kurallarÄ± saÄŸlanÄ±rsa ve issuer ACL onaylanÄ±rsa istek akÄ±ÅŸa devam eder, gerekirse kullanÄ±cÄ± bilgisi header'a eklenir.
   - **EÅŸleÅŸme Yok**: Token Ã§Ã¶zÃ¼lemezse, imza doÄŸrulanamazsa, claim kurallarÄ± ihlal edilirse veya ACL reddi oluÅŸursa istek politika tarafÄ±ndan sonlandÄ±rÄ±lÄ±r.
5. **Hata Ä°ÅŸleme**: Politika kuralÄ±na uymayan istekler iÃ§in Ã¶zelleÅŸtirilebilir HTTP durum kodu ve hata mesajÄ± dÃ¶ndÃ¼rÃ¼lÃ¼r.

## Ã–zellikler ve Yetenekler

### Temel Ã–zellikler

- **Esnek JOSE Hedefi**: Token; body, Authorization header veya seÃ§ilen deÄŸiÅŸkenden okunabilir, deÄŸiÅŸken senaryolarÄ±nda Query Builder ile dinamik seÃ§im yapÄ±labilir.
- **GranÃ¼ler Claim DoÄŸrulamasÄ±**: Accepted audience, zorunlu ve yasak claim listeleri ile exact match kurallarÄ± tanÄ±mlanarak Ã§ok katmanlÄ± doÄŸrulama kurgulanÄ±r.
- **Kimlik ve Rol YayÄ±lÄ±mÄ±**: Ä°stekten Ã§Ä±karÄ±lan kullanÄ±cÄ± kimliÄŸi ve rol bilgisi header Ã¼zerinden sonraki servislere taÅŸÄ±nabilir, merkezi yetki kontrolÃ¼ desteklenir.
- **Aktif/Pasif Durum KontrolÃ¼**: PolitikanÄ±n aktif veya pasif durumunu kolayca deÄŸiÅŸtirme (active/passive toggle). Pasif durumda politika uygulanmaz ancak yapÄ±landÄ±rmasÄ± saklanÄ±r.
- **KoÅŸul BazlÄ± Uygulama**: Query Builder ile karmaÅŸÄ±k koÅŸullar oluÅŸturarak politikanÄ±n ne zaman uygulanacaÄŸÄ±nÄ± belirleme (Ã¶rn: sadece belirli endpoint'lere veya header deÄŸerlerine gÃ¶re).

### Ä°leri DÃ¼zey Ã–zellikler

- **JWK YaÅŸam DÃ¶ngÃ¼sÃ¼ YÃ¶netimi**: Ä°mza ve ÅŸifreleme anahtarlarÄ± Secret Manager veya manuel JWK seÃ§imleriyle yÃ¶netilir; gerekli roller yeni anahtar tanÄ±mlayabilir.
- **Issuer ACL ve IP KontrolÃ¼**: Issuer bazlÄ± izin listesi ve isteÄŸi yapan istemci IP doÄŸrulamasÄ± ek gÃ¼venlik katmanÄ± oluÅŸturur.
- **Claim Decode ve Yeniden Yazma**: ÅifrelenmiÅŸ veya base64 claim'ler Ã§Ã¶zÃ¼mlenip body, header veya deÄŸiÅŸkene yÃ¶nlendirilebilir; kÄ±smi decode desteklenir.
- **Export/Import Ã–zelliÄŸi**: Politika yapÄ±landÄ±rmasÄ±nÄ± ZIP dosyasÄ± olarak export etme. FarklÄ± ortamlara (GeliÅŸtirme, Test, CanlÄ± Ortam) import etme. Versiyon kontrolÃ¼ ve yedekleme imkanÄ±.
- **Policy Group ve Proxy Group DesteÄŸi**: Birden fazla politikayÄ± Policy Group iÃ§inde yÃ¶netme. Proxy Group'lara toplu politika atama. Merkezi gÃ¼ncelleme ve deploy iÅŸlemleri.
- **Deploy ve Versiyonlama**: Politika deÄŸiÅŸikliklerini canlÄ± ortama deploy etme. Hangi API Proxy'lerde kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rme (Policy Usage). Proxy Group ve Policy Group kullanÄ±m raporlarÄ±.

## KullanÄ±m SenaryolarÄ±

| Senaryo | Durum | Ã‡Ã¶zÃ¼m (Politika UygulamasÄ±) | Beklenen DavranÄ±ÅŸ / SonuÃ§ |
|---------|-------|----------------------------|---------------------------|
| Mobil JWT DoÄŸrulama | Mobil uygulama Authorization header'da JWT taÅŸÄ±r | `joseTarget=AUTHORIZATION_HEADER`, `validateSign=true`, issuer JWKS kullan | GeÃ§erli token kabul edilir, hatalÄ± imzalar 401 dÃ¶ndÃ¼rÃ¼r |
| IoT JWE Ã‡Ã¶zÃ¼mÃ¼ | IoT cihazlarÄ± ÅŸifreli payload gÃ¶nderir | `decrypt=true`, `decryptByIssuer=false`, encryption JWK seÃ§ | Payload Ã§Ã¶zÃ¼lÃ¼r, iÃ§erik downstream servislere aktarÄ±lÄ±r |
| Issuer Beyaz Listeleme | Belirli issuer deÄŸerleri dÄ±ÅŸÄ±nda eriÅŸim istenmez | `clientSourcePart=CLAIMS`, `clientFieldname=iss`, exact match map ile liste | Uyumsuz issuer istekleri 403 ile engellenir |
| Audience Segmentasyonu | Mikroservisler farklÄ± audience bekler | `acceptedAudienceList` ortam bazlÄ± doldur | YanlÄ±ÅŸ audience iÃ§eren istekler Ã¶zelleÅŸtirilmiÅŸ hata alÄ±r |
| KullanÄ±cÄ± Header Enjeksiyonu | Downstream servisler kimlik header'Ä± ister | `addUserToHeader=true`, `userHeaderName=X-Authenticated-UserId` | Kimlik bilgisi gÃ¼venli ÅŸekilde baÅŸlÄ±kta iletilir |
| Yetkilendirme Entegrasyonu | Rol bazlÄ± eriÅŸim denetimi gerekir | `enableAuthorization=true`, method access yapÄ±landÄ±r | Ä°stek, rol eÅŸleÅŸmesi saÄŸlanmazsa politika tarafÄ±ndan durdurulur |
| Policy Group Senkronizasyonu (opsiyonel) | AynÄ± kurallar Ã§oklu API Proxy'de kullanÄ±lacak | Global politika oluÅŸtur, Policy Group'a ekle | Tek deÄŸiÅŸiklikle tÃ¼m API Proxy'lerde politika gÃ¼ncellenir |

## Politika Parametrelerini YapÄ±landÄ±rma

Bu adÄ±mda, kullanÄ±cÄ± **yeni bir politika oluÅŸturabilir** ya da **mevcut politika parametrelerini yapÄ±landÄ±rarak** eriÅŸim kurallarÄ±nÄ± belirleyebilir. TanÄ±mlanan parametreler, politikanÄ±n Ã§alÄ±ÅŸma ÅŸeklini (Ã¶rneÄŸin hangi IP'lerin izinli olacaÄŸÄ±, coÄŸrafi kÄ±sÄ±tlamalar, koÅŸullu aktivasyonlar vb.) doÄŸrudan etkiler. Bu sayede politika hem kuruma Ã¶zel gereksinimlere gÃ¶re Ã¶zelleÅŸtirilebilir hem de merkezi olarak yÃ¶netilebilir.

### Yeni JOSE DoÄŸrulama PolitikasÄ± OluÅŸturma

<img src="/images/gelistirici/politikalar/jose-dogrulama-1.png" alt="JOSE DoÄŸrulama PolitikasÄ±" width="1000" />

<img src="/images/gelistirici/politikalar/jose-dogrulama-2.png" alt="JOSE DoÄŸrulama PolitikasÄ±" width="1000" />

### YapÄ±landÄ±rma AdÄ±mlarÄ±

| AdÄ±m | AÃ§Ä±klama / Ä°ÅŸlem |
|------|------------------|
| **AdÄ±m 1: OluÅŸturma SayfasÄ±na Gitme** | - Sol menÃ¼den **Development â†’ Global Settings â†’ Global Policies â†’ JOSE DoÄŸrulama PolitikasÄ±** bÃ¶lÃ¼mÃ¼ne gidin.<br />- SaÄŸ Ã¼stteki **[+ Create]** butonuna tÄ±klayÄ±n. |
| **AdÄ±m 2: Temel Bilgileri Girme** | **Policy Status (Politika Durumu):** Aktif/Pasif durumu gÃ¶sterir. Yeni politikalar varsayÄ±lan olarak aktiftir.<br /><br />**Name (Ä°sim) Zorunlu:** Ã–rnek: `Production_JOSEValidation`<br />- Benzersiz isim girin, boÅŸlukla baÅŸlamaz.<br />- Sistem otomatik kontrol eder. YeÅŸil tik: kullanÄ±labilir. KÄ±rmÄ±zÄ± Ã§arpÄ±: mevcut isim.<br /><br />**Description (AÃ§Ä±klama):** Ã–rnek: "JWT imza ve ÅŸifreleme doÄŸrulamasÄ± yapar."<br />- Maks. 1000 karakter.<br />- PolitikanÄ±n amacÄ±nÄ± aÃ§Ä±klayÄ±n. |
| **AdÄ±m 3: JOSE KaynaÄŸÄ± ve KullanÄ±cÄ± Bilgisi YapÄ±landÄ±rmasÄ±** | - **JOSE Target** alanÄ±ndan token kaynaÄŸÄ±nÄ± seÃ§in (body, Authorization header veya deÄŸiÅŸken).<br />- DeÄŸiÅŸken kullanÄ±yorsanÄ±z ilgili variable'Ä± seÃ§in veya oluÅŸturun.<br />- **Client Source Part** ile issuer bilgisinin okunacaÄŸÄ± alanÄ± belirleyin, gerekiyorsa `clientFieldname` veya variable atayÄ±n. |
| **AdÄ±m 4: Claim ve Audience KurallarÄ±nÄ± TanÄ±mlama** | - **Accepted Audience**, **Required Claim**, **Prohibited Claim** listelerini doldurun.<br />- **Exact Match Claim** iÃ§in anahtar-tÃ¼r-deÄŸer eÅŸleÅŸmeleri girin.<br />- `Validate Expiration Time`, `Validate ACL for Issuer` ve `checkClientIpAddress` ayarlarÄ±nÄ± ihtiyaca gÃ¶re aktive edin. |
| **AdÄ±m 5: Kriptografik Anahtar ve Decode AyarlarÄ±** | - Ä°mza doÄŸrulamasÄ± gerekiyorsa **Validate Sign** seÃ§eneÄŸini aÃ§Ä±n ve gerekli JWK'yi seÃ§in veya oluÅŸturun.<br />- ÅifrelenmiÅŸ iÃ§erikler iÃ§in **Decrypt** ayarÄ±nÄ± ve ilgili JWK'yi yapÄ±landÄ±rÄ±n.<br />- **Strip and Decode** ile decode edilecek claim'leri ve hedef alanÄ± tanÄ±mlayÄ±n. |
| **AdÄ±m 6: KoÅŸul TanÄ±mlama (Ä°steÄŸe BaÄŸlÄ±)** | - **Condition** sekmesine geÃ§in.<br />- KoÅŸullar, politikanÄ±n hangi durumda aktif olacaÄŸÄ±nÄ± belirler.<br /><br />**Ã–rnekler:**<br />- Ortam bazlÄ±: `Header = X-Environment, Operator = Equals, Value = production`<br />- API Key bazlÄ±: `Header = X-API-Key, Starts With = PROD-`<br />- Endpoint bazlÄ±: `Path = /api/admin/*`<br /><br />KoÅŸul tanÄ±mlamazsa politika her zaman aktif<br />Detaylar iÃ§in bakabilirsiniz: [KoÅŸullar (Conditions)](/tr/gelistirici/politikalar/politika-nedir#conditions) |
| **AdÄ±m 7: Hata MesajÄ± Ã–zelleÅŸtirme (Ä°steÄŸe BaÄŸlÄ±)** | - **Error Message Customization** sekmesine gidin.<br />- EriÅŸim reddedildiÄŸinde dÃ¶necek mesajÄ± Ã¶zelleÅŸtirin.<br /><br />**VarsayÄ±lan:**<br />`{ "statusCode": 403, "message": "[Default hata mesajÄ±]" }`<br /><br />**Ã–zel:**<br />`{ "statusCode": 403, "errorCode": "[CUSTOM_ERROR_CODE]", "message": "[Ã–zel mesaj]" }` |
| **AdÄ±m 8: Kaydetme** | - SaÄŸ Ã¼stteki **[Save]** butonuna tÄ±klayÄ±n.<br /><br />**Kontrol Listesi:** Benzersiz isim. Zorunlu alanlar dolu. En az bir kriptografik kontrol (imza veya ÅŸifreleme) etkin.<br /><br />**SonuÃ§:**<br />- Politika listeye eklenir.<br />- API'lere baÄŸlanabilir.<br />- Global politikaysa otomatik uygulanÄ±r. |

## PolitikayÄ± Silme

Bu politikanÄ±n silme adÄ±mlarÄ± ve kullanÄ±mdayken uygulanacak iÅŸlemler, [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±ndaki **PolitikayÄ± Silme** bÃ¶lÃ¼mÃ¼nde detaylÄ± olarak aÃ§Ä±klanmÄ±ÅŸtÄ±r. AyrÄ±ntÄ±lÄ± bilgi iÃ§in ilgili bÃ¶lÃ¼me bakabilirsiniz: [PolitikayÄ± Silme](/tr/gelistirici/politikalar/politika-nedir#politika-silme)

## PolitikayÄ± DÄ±ÅŸa/Ä°Ã§e Aktarma

Bu politikanÄ±n dÄ±ÅŸa aktarma (Export) adÄ±mlarÄ± ve kullanÄ±labilecek seÃ§enekler, [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±ndaki **DÄ±ÅŸa Aktarma Ä°ÅŸlemi** bÃ¶lÃ¼mÃ¼nde aÃ§Ä±klanmaktadÄ±r. AyrÄ±ntÄ±lÄ± bilgi iÃ§in ilgili bÃ¶lÃ¼me bakabilirsiniz: [PolitikayÄ± DÄ±ÅŸa/Ä°Ã§e Aktarma](/tr/gelistirici/politikalar/politika-nedir#politika-export)

## PolitikayÄ± API'ye BaÄŸlama

Bu politikanÄ±n API'lere nasÄ±l baÄŸlanacaÄŸÄ±na iliÅŸkin sÃ¼reÃ§, [Politika Nedir?](/tr/gelistirici/politikalar/politika-nedir) sayfasÄ±ndaki **PolitikayÄ± API'ye BaÄŸlama** bÃ¶lÃ¼mÃ¼nde detaylandÄ±rÄ±lmÄ±ÅŸtÄ±r. AyrÄ±ntÄ±lÄ± bilgi iÃ§in ilgili bÃ¶lÃ¼me gÃ¶z atabilirsiniz: [PolitikayÄ± API'ye BaÄŸlama](/tr/gelistirici/politikalar/politika-nedir#politika-api-baglama)

## Ä°leri DÃ¼zey Ã–zellikler

| Ã–zellik | AÃ§Ä±klama ve AdÄ±mlar |
|---------|---------------------|
| **Dinamik JWK Entegrasyonu** | - Ä°mza veya ÅŸifreleme JWK'sini Secret Manager'dan veya listeden seÃ§in.<br />- RolÃ¼ uygun kullanÄ±cÄ±lar aynÄ± ekrandan yeni JWK Ã¼retebilir.<br />- Kaydedilen JWK deÄŸiÅŸiklikleri politika ile otomatik eÅŸleÅŸtirilir. |
| **Issuer ACL ve IP DoÄŸrulamasÄ±** | - `validateACLforIssuer` seÃ§eneÄŸini etkinleÅŸtirin.<br />- Issuer bazlÄ± ACL kurallarÄ±nÄ± gÃ¼venlik servisi Ã¼zerinden gÃ¼ncelleyin.<br />- Gerekirse `checkClientIpAddress` ayarÄ±nÄ± aÃ§arak gelen isteÄŸin IP'sini doÄŸrulayÄ±n. |
| **Claim Decode & Rewrite** | - `stripAndDecode` deÄŸerini **ALL** veya **PARTIAL** olarak belirleyin.<br />- Decode edilecek claim listesini (`jwtClaimsToDecode`) girin.<br />- Ã‡Ä±ktÄ±yÄ± body, header veya deÄŸiÅŸkene yÃ¶nlendirip diÄŸer politikalarda kullanÄ±n. |

## Best Practices

### YapÄ±lmasÄ± Gerekenler ve En Ä°yi Uygulamalar

| Kategori | AÃ§Ä±klama / Ã–neriler |
|----------|---------------------|
| **Audience YÃ¶netimi** | **KÃ¶tÃ¼:** Accepted audience boÅŸ bÄ±rakmak.<br />**Ä°yi:** Her mikroservis iÃ§in ayrÄ± audience deÄŸeri tanÄ±mlamak.<br />**En Ä°yi:** Ortam bazlÄ± audience listelerini (GeliÅŸtirme/Test/CanlÄ± Ortam) ayrÄ± politikalarla yÃ¶netmek. |
| **Ä°mza DoÄŸrulama** | **KÃ¶tÃ¼:** `validateSign` kapalÄ± Ã§alÄ±ÅŸtÄ±rmak.<br />**Ä°yi:** Issuer JWKS endpoint'ini `validateByIssuer` ile kullanmak.<br />**En Ä°yi:** Issuer olmayan senaryolarda merkezi JWK kasasÄ±nÄ± zorunlu kÄ±lmak. |
| **Åifreleme YÃ¶netimi** | **KÃ¶tÃ¼:** Åifreli tokenlarda `decrypt` kapalÄ± bÄ±rakmak.<br />**Ä°yi:** Issuer tabanlÄ± Ã§Ã¶zÃ¼mlemeyi etkinleÅŸtirmek.<br />**En Ä°yi:** Her issuer iÃ§in ayrÄ± encryption anahtarÄ± tanÄ±mlayÄ±p periyodik anahtar dÃ¶ndÃ¼rmek. |
| **Claim PolitikalarÄ±** | **KÃ¶tÃ¼:** Claim listelerini tanÄ±msÄ±z bÄ±rakmak.<br />**Ä°yi:** Zorunlu ve yasak claim listelerini belirlemek.<br />**En Ä°yi:** Exact match haritasÄ± ile deÄŸer-tip doÄŸrulamasÄ± yapmak. |
| **Header Entegrasyonu** | **KÃ¶tÃ¼:** KullanÄ±cÄ± kimliÄŸini downstream servislere iletmemek.<br />**Ä°yi:** `addUserToHeader` ile kimlik header'Ä± eklemek.<br />**En Ä°yi:** Rol header'larÄ±nÄ± gÃ¼venlik log'larÄ±yla eÅŸleyip denetlemek. |

### GÃ¼venlik En Ä°yi UygulamalarÄ±

| GÃ¼venlik AlanÄ± | AÃ§Ä±klama / UyarÄ±lar |
|----------------|---------------------|
| **Anahtar YÃ¶netimi** | JWK dosyalarÄ±nÄ± Secret Manager'da saklayÄ±n; eriÅŸimleri rol tabanlÄ± yÃ¶netin. |
| **Issuer GÃ¼veni** | Issuer whitelist'ini dÃ¼zenli gÃ¼ncelleyin; ÅŸÃ¼pheli issuer'larÄ± derhal kaldÄ±rÄ±n. |
| **Token Ã–mrÃ¼** | `validateExpirationTime` daima aÃ§Ä±k olmalÄ±; uzun sÃ¼reli tokenlarÄ± kÄ±sÄ±tlayÄ±n. |
| **Header SertliÄŸi** | Eklenen kimlik/rol header'larÄ±nÄ± yalnÄ±zca HTTPS Ã¼zerinden iletin; loglarda maskelenmesini saÄŸlayÄ±n. |
| **Hata MesajlarÄ±** | Hata mesajlarÄ±nda iÃ§sel detay paylaÅŸmayÄ±n; generik mesaj + hata kodu kombinasyonu kullanÄ±n. |

### KaÃ§Ä±nÄ±lmasÄ± Gerekenler

| Kategori | AÃ§Ä±klama / UyarÄ±lar |
|----------|---------------------|
| **Statik GÃ¶mÃ¼lÃ¼ JWK** | **Neden kaÃ§Ä±nÄ±lmalÄ±:** Kod iÃ§ine gÃ¶mÃ¼len anahtarlar sÄ±zÄ±ntÄ±ya aÃ§Ä±ktÄ±r.<br />**Alternatif:** Secret Manager Ã¼zerinden JWK seÃ§in. |
| **Belirsiz Claim KurallarÄ±** | **Neden kaÃ§Ä±nÄ±lmalÄ±:** TÃ¼m claim'leri kabul etmek gÃ¼venlik aÃ§Ä±ÄŸÄ± yaratÄ±r.<br />**Alternatif:** Required ve prohibited listelerini tanÄ±mlayÄ±n. |
| **Decode Edilmeyen Åifreli Veri** | **Neden kaÃ§Ä±nÄ±lmalÄ±:** Åifreli veri doÄŸrulanmadan geÃ§er.<br />**Alternatif:** `decrypt` ayarÄ±nÄ± zorunlu tutup uygun JWK'yi baÄŸlayÄ±n. |
| **Ä°zlenmeyen Header Ekleri** | **Neden kaÃ§Ä±nÄ±lmalÄ±:** Denetlenmeyen header'lar kÃ¶tÃ¼ye kullanÄ±labilir.<br />**Alternatif:** Header kullanÄ±mÄ±nÄ± loglayÄ±n ve eriÅŸim kontrolÃ¼ uygulayÄ±n. |

### Performans Ä°puÃ§larÄ±

| Kriter | Ã–neri / Etki |
|--------|--------------|
| **JWK Ã–nbelleÄŸi** | **Ã–neri:** SÄ±k kullanÄ±lan JWK'leri Secret Manager cache'iyle paylaÅŸÄ±n.<br />**Etki:** Ä°mza doÄŸrulama sÃ¼resi dÃ¼ÅŸer. |
| **Claim KuralÄ± SayÄ±sÄ±** | **Ã–neri:** Gereksiz claim kontrollerini temizleyin.<br />**Etki:** Politika yÃ¼rÃ¼tme sÃ¼resi kÄ±salÄ±r. |
| **Decode SeÃ§enekleri** | **Ã–neri:** YalnÄ±zca ihtiyaÃ§ duyulan claim'leri decode edin.<br />**Etki:** Bellek ve CPU tÃ¼ketimi azalÄ±r. |
| **Global vs Local KullanÄ±m** | **Ã–neri:** AynÄ± kurallarÄ± paylaÅŸan API'lerde global politika tercih edin.<br />**Etki:** YÃ¶netim ve deploy sÃ¼releri kÄ±salÄ±r. |
| **KoÅŸul SadeleÅŸtirme** | **Ã–neri:** Query Builder'da gereksiz koÅŸullarÄ± kaldÄ±rÄ±n.<br />**Etki:** Ä°stek baÅŸÄ±na koÅŸul deÄŸerlendirme sÃ¼resi azalÄ±r. |

## SÄ±k Sorulan Sorular (SSS)

| Kategori | Soru (S) | Cevap (C) |
|----------|-----------|-----------|
| **Genel** | Politika hangi token tÃ¼rlerini doÄŸrular? | JOSE standartlarÄ±nÄ± (JWS/JWE) destekler; JSON Web Signature/Encryption kurallarÄ±na gÃ¶re doÄŸrulama yapar. |
| **Genel** | Politika birden fazla API Proxy (API Vekil Sunucusu) iÃ§in paylaÅŸÄ±labilir mi? | Evet, global tanÄ±mlandÄ±ysa Policy Group aracÄ±lÄ±ÄŸÄ±yla birden fazla API Proxy (API Vekil Sunucusu) ile paylaÅŸÄ±lÄ±r. |
| **Teknik** | Issuer kendi JWKS endpoint'ini sunuyorsa nasÄ±l yapÄ±landÄ±rÄ±lÄ±r? | `validateByIssuer` seÃ§eneÄŸini etkinleÅŸtirerek gateway'in issuer JWKS'inden anahtar almasÄ±nÄ± saÄŸlayÄ±n. |
| **Teknik** | ÅifrelenmiÅŸ JWE iÃ§eriÄŸi nasÄ±l Ã§Ã¶zÃ¼mlenir? | `decrypt` seÃ§eneÄŸini aÃ§Ä±n, gÃ¼venilir deÄŸilse uygun encryption JWK'sini seÃ§in; Ã§Ã¶zÃ¼len payload belirlenen hedefe yazÄ±lÄ±r. |
| **KullanÄ±m** | KullanÄ±cÄ± kimliÄŸini header'a eklemek gÃ¼venli midir? | HTTPS Ã¼zerinde iletin, header adÄ±nÄ± maskeyin ve sadece yetkili servislerin okumasÄ±na izin verin. |
| **KullanÄ±m** | Claim kurallarÄ±nÄ± ortam bazÄ±nda nasÄ±l ayÄ±rabilirim? | Her ortam iÃ§in ayrÄ± politika kopyasÄ± oluÅŸturun veya **Condition** sekmesinde ortam header'Ä±na gÃ¶re koÅŸul tanÄ±mlayÄ±n. |

**Bu dokÃ¼man Apinizer Ã¼rÃ¼n dokÃ¼mantasyonunun bir parÃ§asÄ±dÄ±r. Â©ï¸ 2025 Apinizer - TÃ¼m haklarÄ± saklÄ±dÄ±r.**

Bu dokÃ¼mantasyon, Apinizer yazÄ±lÄ±mÄ±nÄ± kullanan kiÅŸi ve kuruluÅŸlar tarafÄ±ndan dahili kullanÄ±m amacÄ±yla serbestÃ§e kullanÄ±labilir, kopyalanabilir ve daÄŸÄ±tÄ±labilir.
