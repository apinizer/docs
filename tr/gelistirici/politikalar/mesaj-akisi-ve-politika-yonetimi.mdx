---
title: "Mesaj Akışı ve Politika Yönetimi"
description: "Apinizer Politikalar Dokümantasyonu"
---

# Mesaj Akışı ve Politika Yönetimi

Geliştirme sekmesi, mesaj akışı sırasında istek ve yanıt mesajlarına uygulanacak politikaların biçimlendirildiği sekmedir. Arayüz de bu akışı gösterecek şekilde tasarlanmıştır. Böylece kullanıcı görsel olarak bir istek mesajının hangi politikalar hangi sırada uygulandıktan sonra Backend API'ye gönderileceğini ve Backend API'den dönen yanıt mesajı istemciye iletilmeden önce hangi sırada hangi politikaların uygulanacağını görme olanağı kazanır.

İstemci ile Backend API arasındaki akış, ile gösterilmektedir.

Bu bölümde politikaların detaylarına girilmeyecektir. Politikalarla ilgili detaylı bilgi için Politikalar (Policies) sayfasına bakılabilir.

Arayüzde sol taraftaki çerçeve içinde gösterilir. API Proxy'e istek gönderen paydaştır. Akışı başlatır. İstemciden çıkan mesaj, politikalar uygulandıktan sonra Backend API'ye ulaşır.

API Proxy ile istemcinin doğrudan erişimine kapatılan ve istemciden saklanan, istekleri API Proxy'den alıp yanıtlarını API Proxy'e döndüren orijinal API'dir. Arayüzünde sağ taraftaki çerçeve ile gösterilir. Backend API'nin yanıtı, politikalar uygulandıktan sonra İstemciye gönderilir.

Backend API kutusundaki API bağlantısına tıklandığı zaman Backend API'nin API Tanım Belgesi görüntülenir.

Politikalar, istek ve yanıt mesajları üzerinde gerçekleştirilmesi istenen güvenlik, mesajları filtreleme, doğrulama, dönüştürme ya da zenginleştirme, kısmen iş mantığı uygulama, hata yönetimi vb. işlemleri tarif etmek üzere yapılan konfigürasyonlardır. API Gateway, İstemci ile Backend API arasındaki mesaj akışı sırasında, bu konfigürasyonlar ile kendisine tanıtılan politikaları işletir.

Bu bölümde genel olarak politikalar üzerinde yapılabilecek işlemler anlatılmaktadır. Herhangi bir politika hakkında detaylı bilgi edinmek için Politikalar (Policies) bölümünden ilgili politikaya ilişkin dokümantasyona bakabilirsiniz.

Politikalar 3 farklı noktaya eklenebilir:

Bir API Proxy Grubuna eklenen bir politika, sadece istek API Proxy Grup üzerinden gelmiş ise işletilir.

Bir API Proxy'ye eklenen bir politika, o API Proxy'nin bütün metot/endpoint'leri için işletilir.

Bir metot/endpoint'e eklenen bir politika, yalnızca o metot/endpoint için işletilir.

Aşağıdaki görselde bu 3 noktaya da eklenmiş olan politikalara ilişkin bir örnek bulunmaktadır.

Görselde GET - findByStatus adlı metot/endoint'i seçilmiş olan API Proxy'nin, Proxy Group - 1 adlı bir API Proxy Grubu'na eklenmiş olduğu görülmektedir.

İşaretlenmiş olan alanlar, politikaların nereye eklendiğine bağlı olarak görüntülendikleri yerlerdir.

Bu API Proxy herhangi bir API Proxy Grubuna eklenmiş, eklenen API Proxy Grupta politikalar bulunuyor ve istek API Proxy Grup üzerinden geldiyse request hattındakiler uygulanır daha sonra response hattı üzerindeki politikalar da uygulanır. Ancak bu sayfada gösterilmez.

API Proxy'nin herhangi bir metot/endpoint'i için herhangi bir politikanın eklenmiş olması durumunda metot/endpoint yanında çark ikonu bulunur.

Eğer API Proxy'nin belirli bir metot/endpoint'i seçilmezse (ya da Hepsi (All)) seçilirse, aşağıdaki görselde gösterildiği gibi 2 bölge görünür.

Politikalar, mesajın akış sırasında; işletilir. Her seviyede, o seviyedeki politikalar mesajın akış yönündeki sıralamaya göre işleme alınır.

Aşağıdaki görselde bu durum özetlenmiş, politikaların işleme alınma sıraları numaralandırılarak gösterilmiştir.

Hata durumunda işletilecek olan politikalar "Hata Politikası Ekle" seçeneği ile eklenir.

Akışın herhangi bir noktasında hata olması durumunda normal akış kesilerek öncelikle varsa hata yanıt şablonu hata mesajına uygulanır.

Sonrasında "Hata Politikaları" hattına eklenen politikalar sağdan sola doğru sırasıyla işletilir.

Bir politika eklemek için;

Var olan bir politikanın ikonuna tıklandığı zaman, o politikanın bilgilerinin güncellenebileceği bir pencere açılır.

Bir politika, eklenmiş olduğu metot/endpoint ya da API Proxy'den silinmeden geçici olarak kullanımdan kaldırılabilir. Bunun için politika güncellenmek üzere açılır ve açılan pencerenin en üst kısmındaki Deactivate tuşuna tıklanır.

Metot/endpoint bölümünde, orta bölümün alt kısmında Bütün Politikaları Kapat (Disable All Policies) bağlantısı belirir. Bu bağlantıya tıklandığı zaman, eğer Hepsi (All) seçeneğinde ise API Proxy üzerine eklenmiş olan bütün politikalar; eğer herhangi bir metot içerisindeyse sadece o metot içerisinde eklenmiş olan tüm politikalar devre dışı kalır. Kullanımdan kaldırılmış olan politikalar daha sonra politika güncelleme penceresinden tek tek ya da Bütün Politikaları Aç (Activate All Policies) bağlantısına tıklanarak toplu olarak yeniden etkinleştirilebilir.

Politikalar devre dışı kaldığında, ikonların renkleri değişerek gri bir görünüme kavuşur.

Eğer API Proxy bir API Proxy Grubu'na eklenmişse ve bu API Proxy Grubu üzerinden politikalar uygulanmışsa, bütün politikaların kapatılması API Proxy Grubu'ndan gelen politikaları etkilemez, bu politikalar aktif olarak kalır.

Fare silinmek istenen politikanın üzerine getirildiğinde, politikayı silecek bir ikon belirir. Bu ikona tıklanarak politika silinebilir.

Geliştirme sekmesinde gerçekleştirilen politika silme işleminde;

## Mesaj Akışı

### İstemci (Client)

### Backend API

## Politika Yönetimi

#### Politikaların Yeri ve Çalışma Sırası

## Politikaların İşletilme Sırası

### Hata Durumunda Politikaların İşletilme Sırası

### Akışa Politika Ekleme

### Akıştaki Politikayı Güncelleme

### Seçilen Politikayı Activate/Deactivate Etme

### Bütün Politikaları Activate/Deactivate Etme

### Akıştan Politika Kaldırma

