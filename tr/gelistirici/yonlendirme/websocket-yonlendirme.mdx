---
title: "WebSocket Yönlendirme"
description: "WebSocket API Proxy tipi için yönlendirme ayarlarını yapılandırabilirsiniz. Backend API adreslerini yönetebilir, bağlantı ayarlarını ve güvenli bağlantı ayarlarını yapılandırabilirsiniz."
---

<Note>
API tipi WebSocket ise, bu sekme görünür.
</Note>

Bu bölümde, WebSocket API Proxy Tipi için yönlendirme ayarları yer almaktadır.

API Proxy, istemciden gelen mesajları karşılayıp varsa politikaları işlettikten sonra, mesajı Backend API'ye yönlendirir. Yönlendirme sekmesi, işte bu yönlendirme işleminin nasıl yapılacağının ayarlandığı sekmedir.

## Backend API Adreslerinin Yönetilmesi

### Yeni Adres Ekleme

Yapılandır butonuyla açılan pencerenin en sağındaki kolon başlığı bölgesindeki ➕ tuşuna tıklandığında açılan pencereden yeni bir adres eklenebilir.

**Yeni adres ekleme penceresinde:**

* Adres alanına backend API adresi girilir veya ortam değişkeni kullanılır
* Adres alanının sağındaki liste ikonu butonuna tıklanarak Ortam Değişkenleri Seçim Dialog'u açılabilir
* Seçilen ortam değişkeni panoya kopyalanır ve adres alanına yapıştırılır
* Koşul  bölümü ile koşullu yönlendirme tanımlanabilir

### Adresi Güncelleme

Adresleri gösteren tablonun **Adres (Address)** kolonundaki **Yapılandır (Configure)** tuşuna tıklandığında açılan pencerede isteğin gönderileceği backend adresi bilgisi güncellenebilir.

Bu değerin nasıl girilmesi gerektiği ile ilgili [WebSocket Proxy Yönlendirme Kılavuzu](/tr/gelistirici/websocket-proxy-yonlendirme-kilavuzu) sayfasını ziyaret edebilirsiniz.

Eğer bu değer otomatik olarak bulunduğu ortama göre değişmesi isteniyorsa Ortam Değişkenleri (Environment Variable) içinden seçim yapılabilir.

Adresleri gösteren tablonun **Adres (Address)** kolonundaki **Yapılandır (Configure)** tuşuna tıklandığında açılan pencerede adres güncellenebilir.

**Ortam Değişkenleri (Environment Variable) Seçimi** için açılan dialog detayı aşağıdaki görselde belirtilmiştir.

Adres giriş alanının sağında bulunan liste ikonu butonuna tıklandığında Ortam Değişkenleri Seçim Dialog'u açılır. Bu dialog üzerinden projede tanımlı tüm ortam değişkenleri (Environment Variables) görüntülenebilir ve seçilebilir.

**Ortam Değişkenleri Seçim Dialog'unda:**

* Tüm ortam değişkenleri listelenir (Global ve Environment-Specific)
* Arama kutusu ile değişken adı veya açıklamasına göre filtreleme yapılabilir
* Her değişken için Key Name, Açıklama , Tip  bilgileri görüntülenir
* Kopyala (Copy) butonu ile seçilen değişkenin formatı (`${variableName}`) otomatik olarak panoya kopyalanır
* Kopyalanan değer adres alanına yapıştırılarak kullanılabilir

**Örnek Kullanım:**

* Ortam değişkeni: `BACKEND_URL = ws://dev-api.example.com` (Development ortamı için)
* Ortam değişkeni: `BACKEND_URL = wss://api.example.com` (Production ortamı için)
* Adres alanına girilen değer: `${BACKEND_URL}`
* Runtime'da Development ortamında: `ws://dev-api.example.com`
* Runtime'da Production ortamında: `wss://api.example.com`

### Adres Silme

Silinmek istenen adresin satır sonundaki açılır menüsünden **Kaldır ** seçeneği seçilerek adres silinir.

<Warning>
API Proxy'nin yönlendirme yapabilmesi için en az bir adres olması gerekir. Bu nedenle en son adres için silindikten sonra kaydet butonu pasif olur ve kaydetmeye izin vermez.
</Warning>

## Bağlantı Ayarları Konfigürasyonu

WebSocket Bağlantı Ayarları Tanımlama Sekmesi, WebSocket protokolü üzerinden yapılan bağlantıların yapılandırılmasını sağlar. Bu sekme, bağlantıların performansını ve güvenliğini optimize etmek için gerekli olan çeşitli parametreleri içerir. Aşağıda, bu sekmede yer alan ayarların detayları verilmiştir.

WebSocket Bağlantı ayarları konfigürasyonu için kullanılan parametreler aşağıda görülmektedir.

| Alan | Açıklama |
|------|----------|
| **Bağlantı Kaybı Zaman Aşımı** *(Connection Lost Timeout)* | Bu ayar, WebSocket bağlantısının kaybolması durumunda, bağlantı kaybolduktan sonra ne kadar süre bekleyeceğini belirler. Bu süre aşılırsa, yeni bir bağlantı kurulmaya çalışılır. |
| **Bağlantı Zaman Aşımı** *(Connect Timeout)* | WebSocket sunucusuna bağlantı kurma sırasında geçerli olan zaman aşımı süresini ifade eder. |
| **Yeniden Deneme Gecikmesi** *(Retry Delay)* | Bağlantı kaybolduğunda, yeniden bağlantı kurulmadan önce beklenmesi gereken süreyi belirtir. |
| **Maksimum Yeniden Deneme Sayısı** *(Max Retries)* | Bağlantı kaybolduğunda, bağlantıyı yeniden kurmak için yapılacak maksimum deneme sayısını belirtir. |
| **Adres Yeniden Kullanımı** *(Reuse Address)* | Ağ bağlantısı için kullanılan IP adresinin, bağlantı kapanmış olsa bile yeniden kullanılmasını sağlayan bir ayardır. |
| **Otomatik Yeniden Bağlanma** *(Auto Reconnect)* | Bağlantı beklenmedik şekilde kapandığında istemcinin sunucuya otomatik olarak yeniden bağlanmaya çalışmasını sağlar. |
| **Maksimum Yeniden Bağlanma Denemesi** *(Auto Reconnect Max Retries)* | İstemcinin bağlantı kesildikten sonra kaç kez yeniden bağlanmayı deneyeceğini belirler. |
| **Yeniden Bağlanma Gecikmesi** *(Auto Reconnect Retry Delay)* | Her yeniden bağlanma denemesi arasında ne kadar süre bekleneceğini belirler. |

Bu ayarlar, WebSocket bağlantınızın yönetimi ve hatalara karşı nasıl tepki vereceği konusunda önemli bilgiler sağlar.

## Güvenli Bağlantı Ayarı

Bu ayar etkinleştirildiğinde seçili bağlantı ayarları isteğe uygulanır.

Böylece Apinizer'dan hedef hizmete gönderim yapacak olan Apinizer istemcisi, hedef hizmetin sertifikasını doğrular ve kendisinin de bir sertifikası olduğunu ve hedef hizmet tarafından doğrulanması gerektiğini belirtir.

Hedef hizmet de istemcinin sertifikasını doğrular ve bu sayede istemci ile güvenli bir iletişim kurulmuş olur.

Bağlantı ayarları konfigürasyonu için kullanılan parametreler aşağıda görülmektedir.

| Alan | Açıklama |
|------|----------|
| **Keystore** | Keystore, istemci tarafının kimliğini doğrulamak için kullanılır. Keystore içeriğinde şunlar olmalıdır: Eğer server adresinde mTLS doğrulaması yoksa boş olmalıdır. (Alan zorunlu olduğu için boş bir keystore eklenmesi gereklidir.) Eğer server adresinde mTLS doğrulaması varsa: client privatekey, İstemci sertifikası (public key ile birlikte), Sertifika zinciri (varsa intermediate ve root CA sertifikaları) bulunmalıdır. |
| **Truststore** | Truststore sunucu sertifikasını doğrulamak için kullanılır. Sunucu sertifikası Self Signed ise ya da Apinizer'ın güvenmediği bir sertifika ise Truststore içeriğinde şunlar olmalıdır: Hedef sunucunun root CA sertifikası, Intermediate CA sertifikaları (varsa) bulunmalıdır. Aksi halde Apinizer'ın sahip olduğu CA sertifikalar güvenli bağlantı için yeterli olacaktır. |
| **Desteklenen Protokol Listesi** *(Supported Protocol List)* | Desteklenen protokoller seçilir. Seçenekler: TLSv1.3, TLSv1.2, TLSv1.1, TLSv1, SSLv3 |
| **Hostname Doğrulama Tipi** *(Hostname Verifier Type)* | **Noop Hostname Doğrulama**, SSL/TLS bağlantılarında güvenlik riski oluşturabilecek hostname doğrulamasını devre dışı bırakır. Bir saldırganın SSL/TLS iletişimini kesebileceği ve sunucunun kimliğine bürünebileceği man-in-the-middle (MITM) saldırılarını önlemek için sunucunun hostname'ini doğrulamak önemlidir. Noop Hostname Doğrulama kullanmak yerine, Apache HttpComponents istemci çerçevesi tarafından sağlanan aşağıdaki hostname doğrulama uygulamalarından birini kullanabilirsiniz: **Default Hostname Doğrulama**: Bu uygulama, standart hostname doğrulamasını RFC 2818 ve RFC 6125'te tanımlanan kurallara göre gerçekleştirir. Hostname'in eşleştiğinden emin olmak için sunucu sertifikasının ortak adını (CN) ve konu alternatif adlarını (SAN'lar) kontrol eder. **Strict Hostname Doğrulama**: Bu uygulama, Default Hostname Doğrulama'dan daha sıkı bir hostname doğrulaması gerçekleştirir. Hostname ile sunucu sertifikasının CN veya SAN'ları arasında tam bir eşleşme gerektirir. Ayrıca, hostname'in tam nitelikli bir etki alanı adı (FQDN) olup olmadığını ve bir IP adresi veya joker etki alanı adı olmadığını da kontrol eder. **Browser Compat Hostname Doğrulama**: Bu uygulama, popüler web tarayıcıları tarafından kullanılan kurallara dayalı olarak rahat bir hostname doğrulaması gerçekleştirir. Bir joker alan adının, alan adının herhangi bir alt alan adıyla eşleşmesine izin verir ve hostname'in büyük/küçük harf duyarlılığını yok sayar. |
