---
title: "API Proxy Trafik Log Ayarları"
description: "API Proxy'e gelen istek ve dönen yanıt mesajlarının loglanması için ayarları yapılandırabilirsiniz. Hangi bölgelerin loglanacağını, hangi alanların (başlık, parametre, gövde) kaydedileceğini ve hangi konnektörlere gönderileceğini belirleyebilirsiniz."
---

## API Trafik Log Ayarları

API Proxy'e gelen istek ve dönen yanıt mesajları API Proxy'nin yüklendiği [ortamdaki](/tr/apinizer-anlama/temel-kavramlar/ortam-nedir) API Proxy Trafik Log Konnektörlerine gönderilerek loglanır. Bu loglama işlemi [mesaj işleme](/tr/apinizer-anlama/temel-kavramlar/mesaj-isleme-ve-politika-uygulama) sürecinin bir parçasıdır.

Log kayıtları iki tip veri içerir:

1. Bunlardan ilki metrik verilerdir. Metrik verilerin saklanması isteğe bağlı değildir.
2. İkincisi ise; İstemci → API Proxy, API Proxy → Backend API, Backend API → API Proxy, API Proxy → İstemci sırası ile iletilen istek ve yanıt mesajlarının, bu 4 bölgedeki içeriklerini oluşturan başlık (header), parametre (parameter) ve gövde (body) alanlarından oluşan kayıtlardır. Bu alanlardan hangilerinin log kayıtlarında bulunacağı ihtiyaca göre ya da log sunucusunun kaynak tüketimi baz alınarak belirlenebilir.

Varsayılan olarak projenin tüm mesaj bölgelerindeki log alanları aktiftir.

Varsayılan olarak tüm log alanlarının aktif gelmesine rağmen, özellikle Üretim (Production) Ortamlarında log verisinin aşırı büyümemesi için Body alanlarının pasife alınması tercih edilebilir.

## Log Kaydı Tutulan Bölgeler

API Proxy mesajları şu bölgelerde loglanabilir:

<CardGroup cols={2}>
  <Card title="Request from Client" icon="arrow-right">
    İstemciden API Proxy'e gelen istek mesajları
  </Card>
  <Card title="Request to Target" icon="arrow-right">
    API Proxy'den Backend API'ye iletilen istek mesajları
  </Card>
  <Card title="Response from Target" icon="arrow-left">
    Backend API'den API Proxy'e verilen yanıt mesajları
  </Card>
  <Card title="Response to Client" icon="arrow-left">
    API Proxy'den istemciye gönderilen yanıt mesajları
  </Card>
</CardGroup>

Varsayılan olarak, projenin tüm mesaj bölgelerindeki alanların loglanması aktiftir. Loglanan alanlar ihtiyaca göre veya log sunucusunun kaynak tüketimi baz alınarak kısıtlanabilir.

## Üretim Ortamı Önerileri

<Warning>
**Üretim Ortamı İçin Öneriler**: Üretim ortamında aşağıdaki bölgelerin loglanmasının devre dışı bırakılması tavsiye edilir.
</Warning>

Üretim ortamında çalışan API Proxy'lerde tüm poliçelerin ayarları ve testleri tamamlandığı için geliştirme yapılmayacaktır. Veritabanında verilerin aşırı büyümemesi için şu bölgelerin loglanması devre dışı bırakılabilir:

* **Request to Target**: API Proxy'den Backend API'ye iletilen istekler
* **Response from Target**: Backend API'den API Proxy'e verilen yanıtlar

Bu iki bölgedeki başlık, parametre ve gövde verilerinin yazılmaması veritabanı boyutunu kontrol altında tutmaya yardımcı olur.

## Hata Durumunda Loglama

<Info>
**Hata Durumunda Otomatik Loglama**: Tüm loglama alanları kapalı olsa dahi, istekte bir hata oluştuysa log alanlarının tümü hatanın tespit edilebilmesi için otomatik olarak kayıt edilir. Bu özellik genel ayarlarda açılıp kapatılabilir.
</Info>

## Formdata İstekleri

<Warning>
**Formdata İstekleri**: Formdata istekleri değişken veri büyüklükleri ve veri formatları nedeniyle dosya kısımları hiçbir şekilde loglanmamaktadır. Sadece diğer metadata alanları loglanmaktadır.
</Warning>

## WebSocket ve gRPC İstekleri

<Info>
**WebSocket ve gRPC**: WebSocket ve gRPC istekleri Apinizer'a gelen ve Apinizer'dan çıkan veriler şeklinde tutulduğundan bu tip API Proxy'lerde sadece 2 bölge bulunur:
* Request from Client / Response to Client
* Request to Target / Response from Target
</Info>

## Log Ayarları Ekranı

Log ayarları ekranında API Proxy bazlı log ayarları yapılabilir. Eğer entegrasyon ayarları yapılmışsa, hangi API Proxy'lerin trafik kayıtlarının bu entegrasyon hedeflerine gönderilebileceği de ayarlanabilir.

Bu ayarlar sadece Elasticsearch için değil, Kafka, RabbitMQ, Veritabanı, ActiveMQ, Syslog, Webhook, Logback gibi tüm connector tipleri için geçerlidir. Örneğin Kafka connector'üne hangi verilerin gönderileceğini (başlık, parametre, gövde gibi alanlar) seçebilirsiniz.

<img
  src="../../../images/gelistirici/api-proxy-konfigurasyonu/log-ayarlari-settings.png"
  alt="Log Ayarları"
  width="1000"
  height="700"
/>

<Info>
Global ayarlar ekranında da log ayarları yapılandırılabilir. Detaylı bilgi için [Global Trafik Log Ayarları](/tr/gelistirici/global-configurations/api-traffic-log-settings) sayfasına bakabilirsiniz.
</Info>

## Düzenle Dialog Ekranı

Düzenle butonuna tıklandığında açılan dialog ekranında log ayarları yapılandırılabilir:

<img
  src="../../../images/gelistirici/api-proxy-konfigurasyonu/duzenle-dialog.png"
  alt="Düzenle Dialog"
  width="800"
  height="600"
/>

## Log Ayarları Alanları

Log ayarları için kullanılan alanlar:

| Alan | Açıklama |
|---|---|
| **Başlık** _(Header)_ | İlgili bölgedeki mesajın Başlık alanındaki değerlerin loglanmasını sağlar. Mesajdaki başlık bilgilerinin loglanıp loglanmadığını yönetir. |
| **Gövde** _(Body)_ | İlgili bölgedeki mesajın Gövde alanındaki değerin loglanmasını sağlar. Mesajdaki gövde bilgilerinin loglanıp loglanmadığını yönetir. |
| **Parametre** _(Parameter)_ | İlgili bölgedeki mesajın Parametre alanındaki değerlerin loglanmasını sağlar. Mesajdaki parametre bilgilerinin loglanıp loglanmadığını yönetir. |
| **Konnektörler** | İlgili logların hangi konnektöre gönderileceğini seçmek için kullanılır. |

## Gizlilik Ayarları

API Proxy trafik loglarında hassas verilerin korunması için gizlilik ayarları yapılabilir. Bu ayarlar connector'ler environment'a eklenirken yapılandırılır. Hangi alanların loglanacağı ve hangi alanlarda gizlilik işlemleri (maskeleme, silme, hashleme, şifreleme) uygulanacağı belirlenebilir.

Detaylı bilgi için [Ağ Geçidi Ortamlarına Konnektör Eklenmesi](/tr/admin/sunucu-yonetimi/ağ-geçidi-ortamlarına-konnektör-eklenmesi) sayfasına bakabilirsiniz.

<Info>
Log Ayarları bölümünde, log ayarları API Proxy bazlı olarak yönetilir.
</Info>

## İlgili Sayfalar

- [Analitik (Admin)](/tr/admin/analytics-reports/organization-wide-analytics)
- [API Trafiği Log Kaydı Veri Yapısı](/tr/admin/analytics-reports/api-traffic-log-data-structure)
- [Gönderilmemiş API Trafik Loglarını Taşı](/tr/admin/analytics-reports/migrate-unsent-api-traffic-logs)

## Sonraki Adımlar

<CardGroup cols={2}>
  <Card title="Genel Ayarlar" icon="gear" href="/tr/gelistirici/api-proxy-konfigurasyonu/settings">
    API Proxy genel ayarları
  </Card>
  <Card title="Genel Bilgi Sekmesi" icon="info-circle" href="/tr/gelistirici/api-proxy-konfigurasyonu/overview">
    API Proxy genel bilgileri
  </Card>
</CardGroup>
