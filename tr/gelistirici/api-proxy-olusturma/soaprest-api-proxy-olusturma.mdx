---
title: "SOAP REST Dönüşümü yapan API Proxy oluşturma"
description: 'SOAP Web Servisi REST API olarak sunma, protokol dönüşümü, Jackson ve JsonML transformation'
---

SOAP protokolü ile geliştirilmiş bir Web Servisin REST olarak açılması talebi özellikle, var olan servislerin yeni geliştirilen mobil uygulamalar ya da JavaScript tabanlı Web uygulamaları tarafından kullanılması gibi durumlarda sıklıkla ortaya çıkmaktadır. Var olan servisin REST ile yeniden yazılması ya da metotlarını taklit eden yeni bir REST API geliştirilmesi seçenekleri zaman ve maliyet açısından etkin çözümler değildir.

Apinizer, SOAP Web servislerin REST olarak açılmasını ve bunun için gerekli bütün dönüşümlerin konfigürasyonla yapılabilmesini sağlar.

Bu bölümde, bir SOAP Web Servisin istemcilere nasıl REST olarak sunulabileceği anlatılmaktadır.

## SOAP Web Servisten REST Tipinde API Proxy Oluşturma

1. Yeni API Proxy oluşturulurken **WSDL** tipi için **URL Girme (Enter URL)** ya da **Dosya Yükle (Upload File)** seçeneklerinden uygun olan seçilir. Bu örnekte URL Girme seçeneği kullanılmıştır.

2. URL girilip Parse tuşuna basıldıktan sonra gelen ekranda **Protokol Dönüşümü (Protocol Transformation)** bölümünde **REST to SOAP to REST** seçeneği işaretlenir. Diğer zorunlu bilgiler de doldurularak API Proxy oluşturulur.

## Metot Dönüşüm Ayarları

API Proxy oluşturulduktan sonra, istenirse metotların istek ve yanıt mesajları için REST - SOAP mesaj yapıları arasında nasıl dönüşüm yapılacağı özelleştirilebilir. Bunun için API Proxy'nin **Geliştirme (Development)** sekmesine gidilir.

Sol taraftaki metot listesinde **Hepsi (All)** seçiliyken, orta bölümde üstte istek ve altta yanıt mesajlarının dönüşüm ayarlarını açan simgeler görünür.

Örneğin istek mesajlarına ait olan simgeye tıklandığında protokol dönüşüm arayüzü açılır. Bu arayüzde **İstek Mesajı Seçenekleri (Request Options)** ve **Yanıt Mesajı Seçenekleri (Response Options)** sekmeleri bulunmaktadır. Kullanıcının hangi simgeye tıkladığına bağlı olarak ilgili sekme açılır.

Bu arayüzde REST protokolüne uygun olarak gelen istek mesajının Backend API'ye gönderilmeden önce SOAP yapısına uygun hale nasıl getirileceğine ilişkin biçimlendirmeler yapılır. Sol taraftan mesaj yapısı güncellenecek olan metot seçilir. Sağ tarafta ise o metoda ilişkin dönüşüm ayarları yapılır.

## Dönüşüm Seçenekleri

Bir SOAP Servis istemcilere REST olarak açıldığı zaman istek ve yanıt mesajlarının dönüştürülmesi gerekir. İstemciden gelen JSON mesaj SOAP servise gönderilmeden önce XML mesajına, SOAP servisin döndürdüğü XML mesaj ise istemciye gönderilmeden önce JSON mesajına dönüştürülmelidir. Bu dönüşümün yapılabilmesi için çeşitli seçenekler bulunmaktadır:

* **Jackson Transformation**: İstek ve yanıt mesajlarında kullanılacak olan JSON mesajının sade ve kolay anlaşılabilir olması gereken durumlarda tercih edilir. Diğerlerine göre oldukça özelleştirilebilir. En çok tercih edilen yöntemdir.
* **JsonML Transformation**: İstek ve yanıt mesajlarında kullanılacak olan JSON mesajının XML Attribute değerlerini ve XML Namespace'lerini de içermesi isteniyorsa tercih edilir. Diğerlerine göre JSON formatı daha karışıktır. Gösterimindeki Namespace'lerden dolayı XML gösterime benzediğinden veri büyüklüğü artar.
* **Template Message**: Gelen JSON mesajının hangi formatta olduğundan bağımsız, SOAP Servise gönderilecek olan XML şablonunu oluşturmak mantığı üzerine çalışır. XML şablonundaki parametrelerin doldurulması için "istek/yanıt verisi düzenlemesi (request/response data manipulation)" kullanılır. Çoklu alt eleman desteği olmadığından, basit yapıdaki XML'lerin olduğu durumda kullanışlıdır. Özellikle JSON mesajı yerine istek başlığı (request header) veya parametresinden (request parameter) veri alınıp çalışılmak isteniyorsa tercih edilir.

Aşağıda her bir seçenek için var olan alanların ne anlama geldiği açıklanmaktadır.

## İstek Mesajları Dönüşüm Seçenekleri

Bu bölümde istek mesajlarının dönüşüm seçeneklerinin detayları anlatılmaktadır.

### Jackson Dönüşümü Kullan (Use Jackson Transformation)

| Alan | Açıklama |
|------|----------|
| NULL değerleri görmezden gel (Ignore fields with NULL) | İşaretlenirse, Backend API'ye gönderilecek XML mesajın içine, istekte gelen JSON mesajdaki NULL değerleri XML Element olarak eklenmez. |
| Boş değerleri görmezden gel (Ignore EMPTY fields) | İşaretlenirse, Backend API'ye gönderilecek XML mesajın içine, istekte gelen JSON mesajdaki boş değerler XML Element olarak eklenmez. |
| NULL değerler için xsi:nil="true" kullan (Use xsi:nil="true" for NULL values) | İşaretlenirse, Backend API'ye gönderilecek XML mesajın içine, istekte gelen JSON mesajdaki NULL değerleri için xsi:nil="true" niteliği kullanılır. Aksi taktirde XML mesajın içine ilgili değer için boş eleman eklenir. Değerinin aktifleştirilmesi, json mesajında null olarak gönderilen değerin xml'e dönüştürülürken xsi:nil="true" alanı eklenerek iletilmesini sağlar. |
| Hedef XPath (Target XPath) | Gelen JSON mesajı XML'e dönüştürüldükten sonra elde edilen XML'in, SOAP servisin beklediği XML mesajın içinde nereye koyulacağını belirtir. |
| Alt Elemanları Değiştir (Replace Children) | Seçenek işaretlenirse, Target XPath'in çıktı öğesinin alt öğeleri silinerek JSON'dan dönüştürülen kısım bunların yerine eklenir. Aksi takdirde eleman tamamen değiştirilir. |
| Dizi olan elemanlar (Paths for Arrays within message) | JSON mesajın içinde hangi bölümlerin array olarak yorumlanması gerektiğini belirtir. Her bir Path, Hedef XPath'in seviyesinden (Hedef XPath verilmemişse en üst seviyeden) başlayarak ve seviyeler arasına # işareti koyularak yazılır. Örnek: "envelope#body#abc" ifadesi, "envelope" içindeki, "body"'nin içindeki "abc" elemanının array olarak işleme alınacağını belirtir. Array İçinde Array Olduğu Zaman: Array içinde array olması durumunda ve bazı objeler bazen array bazen tekil şekilde geliyorsa, en dıştaki Array'in pathinden başlanarak yazılır ve alttaki objeye inerken array olan ifadelerden sonra #* ifadesi eklenmesi gerekir. Örneğin abc elementi array ve içinde def elementi array olarak yer alıyorsa "envelope#body#abc, envelope#body#abc#*#def" sırasıyla yazılmalıdır. |
