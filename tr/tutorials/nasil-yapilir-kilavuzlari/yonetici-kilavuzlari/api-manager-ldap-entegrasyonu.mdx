---
title: "API Manager LDAP Entegrasyonu"
description: "API Manager'ın LDAP ile entegrasyonu ve yapılandırması"
---

# API Manager LDAP Entegrasyonu

Bu sayfa, API Manager'ın LDAP (Lightweight Directory Access Protocol) ile entegrasyonu ve yapılandırmasını açıklamaktadır.

## Genel Bakış

API Manager'ı LDAP ile entegre ederek kurumsal kimlik yönetimi sisteminizle kullanıcı doğrulaması yapabilirsiniz. Bu sayfa Kubernetes ortamında API Manager'ın LDAP ile yapılandırılmasını açıklar.

## LDAP Sunucu Bilgileri

### Gerekli Bilgiler

LDAP entegrasyonu için aşağıdaki bilgilere ihtiyacınız vardır:

- **LDAP Host**: LDAP sunucu adresi
- **LDAP Port**: LDAP port numarası (389 veya 636)
- **Base DN**: LDAP base distinguished name
- **Bind DN**: LDAP bağlantı kullanıcı adı
- **Bind Password**: LDAP bağlantı parolası
- **User Search Base**: Kullanıcı arama base'i
- **User Search Filter**: Kullanıcı arama filtresi
- **Group Search Base**: Grup arama base'i (opsiyonel)

## Kubernetes Secret Oluşturma

### LDAP Şifresi için Secret

LDAP bind password'ü için secret oluşturun:

```bash
kubectl create secret generic api-manager-ldap \
  --from-literal=bind-password=ldap-password \
  -n apinizer
```

## API Manager Deployment Yapılandırması

### LDAP Environment Variables

API Manager deployment'ında LDAP ayarlarını yapılandırın:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api-manager
  namespace: apinizer
spec:
  template:
    spec:
      containers:
      - name: api-manager
        image: apinizer/api-manager:latest
        env:
        - name: LDAP_ENABLED
          value: "true"
        - name: LDAP_URL
          value: "ldap://ldap.example.com:389"
        - name: LDAP_BASE_DN
          value: "dc=example,dc=com"
        - name: LDAP_BIND_DN
          value: "cn=admin,dc=example,dc=com"
        - name: LDAP_BIND_PASSWORD
          valueFrom:
            secretKeyRef:
              name: api-manager-ldap
              key: bind-password
        - name: LDAP_USER_SEARCH_BASE
          value: "ou=users,dc=example,dc=com"
        - name: LDAP_USER_SEARCH_FILTER
          value: "(uid={0})"
        - name: LDAP_GROUP_SEARCH_BASE
          value: "ou=groups,dc=example,dc=com"
        - name: LDAP_GROUP_SEARCH_FILTER
          value: "(member={0})"
        - name: LDAP_GROUP_ROLE_ATTRIBUTE
          value: "cn"
```

## LDAP Yapılandırma Dosyası

### application.yml Yapılandırması

ConfigMap kullanarak LDAP yapılandırmasını yapabilirsiniz:

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: api-manager-config
  namespace: apinizer
data:
  application.yml: |
    spring:
      ldap:
        urls: ldap://ldap.example.com:389
        base: dc=example,dc=com
        username: cn=admin,dc=example,dc=com
        password: ${LDAP_BIND_PASSWORD}
        user-search-base: ou=users
        user-search-filter: (uid={0})
        group-search-base: ou=groups
        group-search-filter: (member={0})
        group-role-attribute: cn
```

## LDAP SSL/TLS Yapılandırması

### LDAPS Yapılandırması

LDAPS (LDAP over SSL) kullanmak için:

```yaml
env:
- name: LDAP_URL
  value: "ldaps://ldap.example.com:636"
- name: LDAP_SSL_ENABLED
  value: "true"
- name: LDAP_SSL_TRUST_STORE
  value: "/etc/ssl/certs/ldap-truststore.jks"
- name: LDAP_SSL_TRUST_STORE_PASSWORD
  value: "changeit"
```

## Kullanıcı Eşleştirme

### User DN Pattern

Basit DN pattern kullanarak:

```yaml
env:
- name: LDAP_USER_DN_PATTERN
  value: "uid={0},ou=users,dc=example,dc=com"
```

### User Search

Kullanıcı arama kullanarak:

```yaml
env:
- name: LDAP_USER_SEARCH_BASE
  value: "ou=users,dc=example,dc=com"
- name: LDAP_USER_SEARCH_FILTER
  value: "(uid={0})"
```

## Grup Eşleştirme

### Group Mapping

LDAP gruplarını Apinizer rollerine eşleştirme:

```yaml
env:
- name: LDAP_GROUP_SEARCH_BASE
  value: "ou=groups,dc=example,dc=com"
- name: LDAP_GROUP_SEARCH_FILTER
  value: "(member={0})"
- name: LDAP_GROUP_ROLE_ATTRIBUTE
  value: "cn"
- name: LDAP_GROUP_MAPPING_ADMIN
  value: "apinizer-admins"
- name: LDAP_GROUP_MAPPING_DEVELOPER
  value: "apinizer-developers"
```

## Test ve Doğrulama

### LDAP Bağlantısını Test Etme

Pod içinden LDAP bağlantısını test edin:

```bash
kubectl exec -it api-manager-pod-name -n apinizer -- \
  ldapsearch -H ldap://ldap.example.com:389 \
  -D "cn=admin,dc=example,dc=com" \
  -w password -b "dc=example,dc=com" "(uid=testuser)"
```

### Kullanıcı Girişini Test Etme

API Manager UI'dan LDAP kullanıcısı ile giriş yapmayı test edin.

### Log Kontrolü

LDAP entegrasyonu ile ilgili log'ları kontrol edin:

```bash
kubectl logs api-manager-pod-name -n apinizer | grep LDAP
```

## Sorun Giderme

### LDAP Bağlantı Hatası

1. LDAP sunucu adresini ve portunu kontrol edin
2. Network bağlantısını kontrol edin
3. Firewall kurallarını kontrol edin
4. LDAP sunucu log'larını inceleyin

### Kullanıcı Bulunamıyor

1. User search base'i kontrol edin
2. User search filter'ı kontrol edin
3. Base DN'i kontrol edin
4. LDAP yapılandırmasını test edin

### Grup Eşleştirme Çalışmıyor

1. Group search base'i kontrol edin
2. Group search filter'ı kontrol edin
3. Group role attribute'u kontrol edin
4. LDAP grup yapısını kontrol edin

## Best Practices

### Güvenlik

- LDAPS kullanın (LDAP over SSL)
- Bind password'ü secret olarak saklayın
- Minimum privilege ile bind DN kullanın
- LDAP bağlantılarını loglayın

### Performans

- Connection pooling kullanın
- Timeout değerlerini ayarlayın
- Cache mekanizması kullanın

### Yapılandırma

- Test ortamında önce test edin
- Yapılandırmayı dokümante edin
- Backup yapılandırmaları saklayın

## İlgili Kaynaklar

- [API Manager LDAP Entegrasyonu](/tr/bakim-operasyon/yonetici-kilavuzlari/api-manager-ldap-entegrasyonu)
- [Identity Manager](/tr/apinizer-anlama/temel-bilesenler/identity-manager)
- [LDAP Plain Text Auth](/tr/tutorials/api-proxy-senaryolari/rest-api-ldap-plain-text-auth)
