---
title: Dinamik Xml-2-Json Scripti
description: "Groovy script ile XML'de belirtilen parent node ve tüm child node'larını dinamik olarak JSON formatına dönüştürme işlemi"
---

<Info>
XML/SOAP bir web servisi JSON/REST olarak sunmak için Apinizer üzerindeki Rest-2-Soap özelliği kullanılabilir. Detaylı bilgi için [SOAP Web Servisi REST API Olarak Sunma](/apinizer-dokumantasyonu/soap-web-servisi-rest-api-olarak-sunma-3244622.html) adresini inceleyebilirsiniz.
</Info>

## Groovy Script

`"nodeName"` alanına ilgili XML'de filtrelemek istediğiniz parent node'un adını girerek ilgili node ve tüm child node'larını dinamik bir şekilde JSON'a çevirebilirsiniz.

```groovy
import groovy.util.XmlSlurper
import groovy.json.JsonOutput

try {
    def slurper = new XmlSlurper(false, false)
    def data = slurper.parseText(requestBodyTextFromClient)
    def parsedData = data.'**'.findAll { it.name().contains('nodeName') }
    def result = [:]
    parsedData.each { node ->
        node.'**'.each { subNode ->
            if (!subNode.children() || subNode.children().size() == 0) {
                result[subNode.name()] = subNode.text()
            }
        }
    }
    requestBodyTextFromClient = JsonOutput.prettyPrint(JsonOutput.toJson(result))
} catch (Exception ex) {
    requestErrorMessageToTargetAPI = ex.message
}
```

## Açıklama

Bu script şu işlemleri gerçekleştirir:

1. **XML Parse**: Request body'den gelen XML verisi parse edilir
2. **Node Filtreleme**: Belirtilen `nodeName` ile eşleşen parent node ve tüm child node'ları bulunur
3. **JSON Dönüşümü**: Bulunan node'lar JSON formatına dönüştürülür
4. **Hata Yönetimi**: Hata durumunda hata mesajı oluşturulur

<Note>
Bu script, request hattında (Request Policy) çalıştırılmalıdır çünkü `requestBodyTextFromClient` ve `requestErrorMessageToTargetAPI` değişkenlerini kullanmaktadır.
</Note>
