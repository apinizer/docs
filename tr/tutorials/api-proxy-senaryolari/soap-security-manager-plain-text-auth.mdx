---
title: SOAP Web Servise Security Manager Provider Aracılığıyla Plain-Text Authentication Poliçesinin Uygulanması
description: "Calculator SOAP web servisine Security Manager provider aracılığıyla Plain-Text Authentication poliçesinin nasıl uygulanacağını açıklar. API Proxy oluşturulmasından credential tanımlamasına, politikasının eklenmesinden test edilmesine kadar tüm adımları içerir."
---

Aşağıdaki grafikte yer alan numaralandırmalar işlemlerin **yapılış sırasına aittir.**

- **Apinizer** içerisinde yer alan **Security Manager, API Client'tan Plain-Text türünde authentication** bilgisini ister. Bu **authentication** bilgisi doğru ise iki numaralı alana geçiş yapılır.
- **Apinizer, Backend API'ye** istekte bulunur.
- **Backend API, Apinizer'a** yanıt verir.
- **Apinizer, API Client'a** yanıt verir.
<img src="/images/tutorials/senaryo1.png" alt="Senaryo Diyagramı" width="800" />

## API Proxy'nin Oluşturulması

<img src="/images/tutorials/senaryo2.png" alt="Senaryo Diyagramı" width="200" />

Calculator isimli web servise [http://www.dneonline.com/calculator.asmx?WSDL](http://www.dneonline.com/calculator.asmx?WSDL) adresinden erişim sağlanabilmektedir.

İlk olarak bu adresin **API Proxy** olarak tanımlanması gereklidir.

Bunun için **Development** menüsü altında yer alan **API Proxies** seçeneğine tıklanır.

Açılan sayfada daha önceden herhangi bir **proxy** tanımı yapılmadığı için **No records found!** yazısı yer alır.

Burada sağ üst köşede yer almakta olan **Create** butonuna tıklanır ve yeni bir **proxy** oluşturmaya başlanır.
<img src="/images/tutorials/senaryo3.png" alt="Senaryo Diyagramı" width="800" />

Eklenecek API proxy bir SOAP web servis olduğu için **WSDL menüsünden** **Enter URL** ifadesine tıklanarak kullanılacak olan web servisin adresinin girileceği ekrana geçiş yapılır.
<img src="/images/tutorials/soap1.png" alt="Senaryo Diyagramı" width="800" />

Aşağıdaki görselde de görüldüğü üzere **URL kısmına erişim sağlanacak adres girilerek Parse** butonuna tıklanır.
<img src="/images/tutorials/soap2.png" alt="Senaryo Diyagramı" width="800" />

Çözümlemeyi yaptıktan sonra ise aşağıdaki görselde yer alan ekran karşımıza çıkmaktadır. Bu ekran üzerinden API Proxy'ye ait ayarlar yapabilmektedir.

- **Usage** alanı ile oluşturmuş olunan API Proxy'nin kim tarafından kullanacağı belirtilir. Burada **publisher, consumer, publisher and consumer** gibi seçenekler yer almaktadır.
- **Protocol Transformation** sekmesi altında yer alan iki farklı seçenek bulunmaktadır;
  - **Pass-Through SOAP** web servis üzerinde hiçbir transform işlemi yapmadan SOAP web servis haliyle kullanılmasına olanak sağlar.
  - **REST to SOAP to REST** ise bu SOAP web servisin REST mimari içerecek bir yapıda kullanılmasına olanak sağlar.
- **Addresses** sekmesi altında yer alan iki API adresinden biri veya her ikisi de seçilebilir eğer iki adres de seçilecek olursa Apinizer **Load Balance** işlemini kendisi gerçekleştirecektir.
- **Relative Path** ise oluşturulan API Proxy'nin erişime açılacak adresidir.
- **Category List** alanı da oluşturulan API Proxy'nin kategorilendirilmesine olanak sağlar.

<img src="/images/tutorials/soap3.png" alt="Senaryo Diyagramı" width="800" />

Bu ayarlamalar yapıldıktan sonra API Proxy kaydedilir.

Kaydetme işleminden sonra ise açılan sayfada **Develop** sekmesine tıklanır.
<img src="/images/tutorials/soap4.png" alt="Senaryo Diyagramı" width="800" />

Burada web servise ait olan **metotlar** görülmektedir.

- Bu metotların üstünde yer alan **All** ifadesiyle eklenecek olan poliçeler **tüm metotlara** uygulanabilmektedir.
- Oluşturulan API Proxy deploy edilir. Bunun için yukarıda orta kısımda yer alan **Deploy** butonuna tıklanır.
<img src="/images/tutorials/soap5.png" alt="Senaryo Diyagramı" width="800" />

## Credentials Oluşturulması

Eklenecek **Credential'a** ait bilgiler **username = apinizer**, **password = 123123aA** olacak şekildedir.

Bunun için **Identity Management** menüsüne gelinir.

Burada ise **Credential Management** menüsü altında yer alan **Credentials** menüsüne tıklanır.
<img src="/images/tutorials/senaryo9.png" alt="Senaryo Diyagramı" width="200" />

Açılan ekranda sağ üst köşede yer alan **Create** butonuna tıklanır.
<img src="/images/tutorials/senaryo10.png" alt="Senaryo Diyagramı" width="600" />

Burada gerekli olan alanlar daha önceden belirtilen bilgilerle doldurulur ve **Save and Deploy** butonuna tıklayarak oluşturulan **credential** kaydedilir.
<img src="/images/tutorials/senaryo11.png" alt="Senaryo Diyagramı" width="800" />

Bu **credential öğesinin** erişim sağlayacağı proxy'nin seçilmesi gerekmektedir. Oluşturulan **credential'ın** üzerine gelip yanda yer alan menüden **Edit** seçeneğine tıklanır.
<img src="/images/tutorials/senaryo12.png" alt="Senaryo Diyagramı" width="800" />

Açılan ekran üzerinden **API Proxy ACL** sekmesine tıklanır, bu sekme içerisinde yer alan butona tıklanır.
<img src="/images/tutorials/api-proxy-acl.png" alt="Senaryo Diyagramı" width="800" />

Açılan sayfada şu an üzerinde çalışılan projede bulunan **API Proxy'ler** listelenmektedir. **Calculator** isimli **proxy** seçilir.

**Add** butonuna tıklayarak oluşturulan **Credential** öğesinin bu **proxy'ye erişimi olacağı belirtilir.**
<img src="/images/tutorials/senaryo14.png" alt="Senaryo Diyagramı" width="600" />

Sağ üst köşede yer alan **Save and Deploy** butonuna tıklanır ve yapılan işlem kaydedilir.

## Authentication Poliçesinin Eklenmesi

Artık **Plain-Text Authentication** poliçesi eklenebilir duruma gelmiştir.

API Proxy'lerin listelendiği sayfaya gidilir ve buradan **Calculator** isimli proxy seçilir.

Daha sonra ise **Develop** sekmesine gelinir, **Add Policy** butonuna tıklanır.

Açılan sayfada **Plain-Text Authentication** poliçesi seçilir.
<img src="/images/tutorials/senaryo16.png" alt="Senaryo Diyagramı" width="800" />

Bu ekran üzerinde yer alan alanlar:

- **Identity/Role/Group Service** alanında seçilecek olan değer **Security Manager** değeridir. Çünkü credentials kontrolü **Security Manager** tarafından gerçekleştirilecektir.
- **Variable for username** ve **variable for password** ifadeleri ile de kullanıcı adı ve parola bilgisinin hangi değişken ile alınacağı seçilir. Bu senaryoda bu değerler **header** içerisinden alınacaktır.
- **Clear Authentication Information** seçeneği seçilirse gelen mesaj içerisinde authentication bilgisi silinir.
- **Add Client Info To Header** seçeneği backend API'ye gidecek Header içerisinde istemciye ait bilgilerin bulunup bulunmayacağını belirtir.
- Bu seçenek aktif duruma gelirse **Authenticated User Header Name** isminde başka bir parametre ortaya çıkmaktadır.
- Burada yer alan **X-Authenticated-UserId** ifadesi ise backend API'ye gidecek olan istemci bilgisinin hangi başlık ismi ile gideceğini belirtmektedir.
<img src="/images/tutorials/senaryo17.png" alt="Senaryo Diyagramı" width="800" />

Yapılan işlemin geçerli olması için proxy'nin **Deploy** olması gerekmektedir.
<img src="/images/tutorials/senaryo18.png" alt="Senaryo Diyagramı" width="800" />

## API Proxy'nin Test Edilmesi

**Add** metodunu seçtikten sonra **Test Method** butonuna tıklanır.
<img src="/images/tutorials/senaryo19.png" alt="Senaryo Diyagramı" width="800" />

Body içerisinde istenilen değerler yazıldıktan sonra **Send** butonuna tıklanır ve **backend API'ye** istekte bulunulur.
<img src="/images/tutorials/soap6.png" alt="Senaryo Diyagramı" width="800" />

Aşağıdaki görselde de görüldüğü üzere **backend API'ye** hiçbir **authentication** bilgisi gönderilmediği için yanıt olarak dikdörtgen içerisinde yer alan hata mesajı alınır.
<img src="/images/tutorials/soap7.png" alt="Senaryo Diyagramı" width="800" />

Bu sefer header içerisine **username** ve **password** ifadeleri girilip test yeniden gerçekleştirilir.

**Backend API'ye** gönderilecek olan **headers** içerisinde **username = apinizer**, **password = 123123aA** değerleri girilir.

**Send** butonuna tıkladığında başarılı cevap alınır.
<img src="/images/tutorials/soap8.png" alt="Senaryo Diyagramı" width="800" />
