---
title: SOAP Web Servise Security Manager Provider Aracılığıyla Plain-Text Authentication Poliçesinin Uygulanması
description: "Calculator SOAP web servisine Security Manager provider aracılığıyla Plain-Text Authentication poliçesinin nasıl uygulanacağını açıklar. API Proxy oluşturulmasından credential tanımlamasına, politikasının eklenmesinden test edilmesine kadar tüm adımları içerir."
---

Aşağıdaki grafikte yer alan numaralandırmalar işlemlerin **yapılış sırasına aittir.**

- **Apinizer** içerisinde yer alan **Security Manager, API Client'tan Plain-Text türünde authentication** bilgisini ister. Bu **authentication** bilgisi doğru ise iki numaralı alana geçiş yapılır.
- **Apinizer, Backend API'ye** istekte bulunur.
- **Backend API, Apinizer'a** yanıt verir.
- **Apinizer, API Client'a** yanıt verir.

<Frame caption="Senaryo Akışı">
  <img
    src="/images/soap-plain-text-auth-scenario.png"
    alt="Senaryo Akışı"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

## API Proxy'nin Oluşturulması

Calculator isimli web servise [http://www.dneonline.com/calculator.asmx?WSDL](http://www.dneonline.com/calculator.asmx?WSDL) adresinden erişim sağlanabilmektedir.

İlk olarak bu adresin **API Proxy** olarak tanımlanması gereklidir.

Bunun için **Development** menüsü altında yer alan **API Proxies** seçeneğine tıklanır.

<Frame caption="API Proxies Menüsü">
  <img
    src="/images/api-proxies-menu.png"
    alt="API Proxies Menüsü"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Açılan sayfada daha önceden herhangi bir **proxy** tanımı yapılmadığı için **No records found!** yazısı yer alır.

Burada sağ üst köşede yer almakta olan **Create** butonuna tıklanır ve yeni bir **proxy** oluşturmaya başlanır.

<Frame caption="Create Butonu">
  <img
    src="/images/create-button.png"
    alt="Create Butonu"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Eklenecek API proxy bir SOAP web servis olduğu için **WSDL menüsünden** **Enter URL** ifadesine tıklanarak kullanılacak olan web servisin adresinin girileceği ekrana geçiş yapılır.

<Frame caption="WSDL Enter URL">
  <img
    src="/images/wsdl-enter-url.png"
    alt="WSDL Enter URL"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Aşağıdaki görselde de görüldüğü üzere **URL kısmına erişim sağlanacak adres girilerek Parse** butonuna tıklanır.

<Frame caption="Parse WSDL">
  <img
    src="/images/parse-wsdl.png"
    alt="Parse WSDL"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Çözümlemeyi yaptıktan sonra ise aşağıdaki görselde yer alan ekran karşımıza çıkmaktadır. Bu ekran üzerinden API Proxy'ye ait ayarlar yapabilmektedir.

- **Usage** alanı ile oluşturmuş olunan API Proxy'nin kim tarafından kullanacağı belirtilir. Burada **publisher, consumer, publisher and consumer** gibi seçenekler yer almaktadır.
- **Protocol Transformation** sekmesi altında yer alan iki farklı seçenek bulunmaktadır;
  - **Pass-Through SOAP** web servis üzerinde hiçbir transform işlemi yapmadan SOAP web servis haliyle kullanılmasına olanak sağlar.
  - **REST to SOAP to REST** ise bu SOAP web servisin REST mimari içerecek bir yapıda kullanılmasına olanak sağlar.
- **Addresses** sekmesi altında yer alan iki API adresinden biri veya her ikisi de seçilebilir eğer iki adres de seçilecek olursa Apinizer **Load Balance** işlemini kendisi gerçekleştirecektir.
- **Relative Path** ise oluşturulan API Proxy'nin erişime açılacak adresidir.
- **Category List** alanı da oluşturulan API Proxy'nin kategorilendirilmesine olanak sağlar.
- Bu ayarlamalar yapıldıktan sonra API Proxy kaydedilir.

<Frame caption="API Proxy Ayarları">
  <img
    src="/images/api-proxy-settings-soap.png"
    alt="API Proxy Ayarları"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Kaydetme işleminden sonra ise açılan sayfada **Develop** sekmesine tıklanır.

<Frame caption="Develop Sekmesi">
  <img
    src="/images/develop-tab.png"
    alt="Develop Sekmesi"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Burada web servise ait olan **metotlar** görülmektedir.

- Bu metotların üstünde yer alan **All** ifadesiyle eklenecek olan poliçeler **tüm metotlara** uygulanabilmektedir.
- Oluşturulan API Proxy deploy edilir. Bunun için yukarıda orta kısımda yer alan **Deploy** butonuna tıklanır.
- Sonraki adımda **Credentials** ekleyerek oluşturulan API Proxy'ye hangi kullanıcıların erişim sağlayacağı belirtilir.

<Frame caption="Metotlar ve Deploy">
  <img
    src="/images/methods-deploy.png"
    alt="Metotlar ve Deploy"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

## Credentials Oluşturulması

Eklenecek **Credential'a** ait bilgiler **username = apinizer**, **password = 123123aA** olacak şekildedir.

Bunun için **Identity Management** menüsüne gelinir.

Burada ise **Credential Management** menüsü altında yer alan **Credentials** menüsüne tıklanır.

<Frame caption="Credentials Menüsü">
  <img
    src="/images/credentials-menu.png"
    alt="Credentials Menüsü"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Açılan ekranda sağ üst köşede yer alan dikdörtgen içerisine alınmış **Create** butonuna tıklanır.

<Frame caption="Create Credential">
  <img
    src="/images/create-credential.png"
    alt="Create Credential"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Burada gerekli olan alanlar daha önceden belirtilen bilgilerle doldurulur ve **Save and Deploy** butonuna tıklayarak oluşturulan **credential** kaydedilir.

<Frame caption="Credential Form">
  <img
    src="/images/credential-form.png"
    alt="Credential Form"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Bu **credential öğesinin** erişim sağlayacağı proxy'nin seçilmesi gerekmektedir. Oluşturulan **credential'ın** üzerine gelip yanda yer alan menüden **Edit** seçeneğine tıklanır.

<Frame caption="Edit Credential">
  <img
    src="/images/edit-credential.png"
    alt="Edit Credential"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Açılan ekran üzerinden **API Proxy ACL** sekmesine tıklanır, bu sekme içerisinde yer alan ve görsel üzerinde kırmızı dikdörtgen içerisinde belirtilen butona tıklanır.

<Frame caption="API Proxy ACL">
  <img
    src="/images/api-proxy-acl.png"
    alt="API Proxy ACL"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Açılan sayfada şu an üzerinde çalışılan projede bulunan **API Proxy'ler** listelenmektedir. **Calculator** isimli **proxy** seçilir.

**Add** butonuna tıklayarak oluşturulan **Credential** öğesinin bu **proxy'ye erişimi olacağı belirtilir.**

<Frame caption="Add API Proxy">
  <img
    src="/images/add-api-proxy.png"
    alt="Add API Proxy"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Daha önceden boş bir şekilde görünen listede artık bir adet **API Proxy** bulunmaktadır.

Sağ üst köşede yer alan **Save and Deploy** butonuna tıklanır ve yapılan işlem kaydedilir.

<Frame caption="Save and Deploy">
  <img
    src="/images/save-deploy-credential.png"
    alt="Save and Deploy"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

## Authentication Poliçesinin Eklenmesi

Artık **Plain-Text Authentication** poliçesi eklenebilir duruma gelmiştir.

API Proxy'lerin listelendiği sayfaya gidilir ve buradan **Calculator** isimli proxy seçilir.

Daha sonra ise **Develop** sekmesine gelinir, **Add Policy** butonuna tıklanır.

Açılan sayfada **Plain-Text Authentication** poliçesi seçilir.

<Frame caption="Add Policy">
  <img
    src="/images/add-policy-plain-text.png"
    alt="Add Policy"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Bu ekran üzerinde yer alan ifadeler tek tek incelenecek olursa,

- **Identity/Role/Group Service** alanında seçilecek olan değer **Security Manager** değeridir. Çünkü credentials kontrolü **Security Manager** tarafından gerçekleştirilecektir.
- **Variable for username** ve **variable for password** ifadeleri ile de kullanıcı adı ve parola bilgisinin hangi değişken ile alınacağı seçilir. Bu senaryoda bu değerler **header** içerisinden alınacaktır.
- **Clear Authentication Information** seçeneği seçilirse gelen mesaj içerisinde authentication bilgisi silinir.
- **Add Client Info To Header** seçeneği backend API'ye gidecek Header içerisinde istemciye ait bilgilerin bulunup bulunmayacağını belirtir.
- Bu seçenek aktif duruma gelirse **Authenticated User Header Name** isminde başka bir parametre ortaya çıkmaktadır.
- Burada yer alan **X-Authenticated-UserId** ifadesi ise backend API'ye gidecek olan istemci bilgisinin hangi başlık ismi ile gideceğini belirtmektedir.

<Frame caption="Plain-Text Authentication Ayarları">
  <img
    src="/images/plain-text-auth-settings.png"
    alt="Plain-Text Authentication Ayarları"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Poliçe kaydolduğu zaman kırmızı dikdörtgen içerisine alınmış ikon görülmektedir.

Yapılan işlemin geçerli olması için proxy'nin **Redeploy** olması gerekmektedir. Şimdi proxy'nin içerisinde yer alan metotların test işlemi gerçekleştirilebilir.

<Frame caption="Policy Added">
  <img
    src="/images/policy-added.png"
    alt="Policy Added"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

## API Proxy'nin Test Edilmesi

**Add** metodunu seçtikten sonra **Test Method** butonuna tıklanır.

<Frame caption="Test Method">
  <img
    src="/images/test-method.png"
    alt="Test Method"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Body içerisinde istenilen değerler yazıldıktan sonra **Send** butonuna tıklanır ve **backend API'ye** istekte bulunulur.

<Frame caption="Test Request">
  <img
    src="/images/test-request-no-auth.png"
    alt="Test Request"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Aşağıdaki görselde de görüldüğü üzere **backend API'ye** hiçbir **authentication** bilgisi gönderilmediği için yanıt olarak dikdörtgen içerisinde yer alan hata mesajı alınır.

<Frame caption="Error Response">
  <img
    src="/images/error-response-no-auth.png"
    alt="Error Response"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>

Bu sefer header içerisine **username** ve **password** ifadeleri girilip test yeniden gerçekleştirilir.

**Backend API'ye** gönderilecek olan **headers** içerisinde **username = apinizer**, **password = 123123aA** değerleri girilir.

**Send** butonuna tıkladığında alınan cevap görsel üzerinde aşağıda yer alan dikdörtgen içerisindeki ifadedir.

<Frame caption="Success Response">
  <img
    src="/images/success-response-with-auth.png"
    alt="Success Response"
    width="1000"
    height="700"
    style={{ borderRadius: '0.5rem' }}
  />
</Frame>
