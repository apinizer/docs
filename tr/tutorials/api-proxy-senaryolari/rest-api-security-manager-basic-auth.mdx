---
title: REST API'ye Security Manager Provider Aracılığıyla Basic (Base64) Authentication Poliçesinin Uygulanması
description: "Swagger Petstore REST API'sine Security Manager provider aracılığıyla Basic (Base64) Authentication poliçesinin nasıl uygulanacağını açıklar. Credential oluşturulmasından değişken tanımlamasına, politikasının eklenmesinden Base64 şifreleme ve test edilmesine kadar tüm adımları içerir."
---

Aşağıdaki grafikte yer alan numaralandırmalar işlemlerin **yapılış sırasına aittir.**

- **Apinizer** içerisinde yer alan **Security Manager, API Client'tan Basic (Base64) türünde authentication** bilgisini ister. Bu authentication doğru ise akış devam eder.
- **Apinizer, Backend API'ye istekte** bulunur.
- **Backend API, Apinizer'a** yanıt verir.
- **Apinizer, API Client'a** yanıt verir.
<img src="/images/tutorials/senaryo1.png" alt="Senaryo Diyagramı" width="800" />
## API Proxy'nin Oluşturulması

<img src="/images/tutorials/senaryo2.png" alt="Senaryo Diyagramı" width="200" />

Swagger Petstore isimli REST API'ye [https://petstore.swagger.io/](https://petstore.swagger.io/) adresinden erişim sağlanabilmektedir.

**Development** menüsü altında yer alan **API Proxies** seçeneğine tıklanır.

<Info>
  Açılan sayfada daha önceden herhangi bir **proxy** tanımı yapılmadığı için **No records found!** yazısı yer alır.
</Info>

Sağ üst köşede yer almakta olan **Create** butonuna tıklanır ve yeni bir **proxy** oluşturulmaya başlanır.
<img src="/images/tutorials/senaryo3.png" alt="Senaryo Diyagramı" width="800" />


Bu kısımda oluşturulacak olan **API Proxy'nin** hangi tipte olduğunun seçilmesi gerekmektedir.

Bu senaryoda kullanılacak olan API'nin türü **Swagger 2.X** olacağı için bu tür seçilir.

**Enter URL** ifadesine tıklanarak kullanılacak olan API'nin adresinin girileceği ekrana geçiş yapılır.
<img src="/images/tutorials/swagger.png" alt="Senaryo Diyagramı" width="800" />

URL kısmına **erişim sağlanacak adres girilerek Parse** butonuna tıklanır.
<img src="/images/tutorials/senaryo5.png" alt="Senaryo Diyagramı" width="800" />

Parse işlemi yapıldıktan sonra API Proxy'ye ait ayarlar yapılabilmektedir.

- **Usage** alanı ile oluşturulan API Proxy'nin kim tarafından kullanılacağı belirtilir. Burada **publisher, consumer, publisher and consumer** gibi seçenekler yer almaktadır.
- **Sharing Type** alanı ile oluşturulan API Proxy'nin paylaşım tipi belirtilir. Burada **external, internal, external and internal** gibi seçenekler yer almaktadır.
- **Addresses** sekmesi altında yer alan iki API adresinden biri veya her ikisi de seçilebilir eğer iki adres de seçilecek olursa Apinizer **Load Balance** işlemini kendisi gerçekleştirecektir.
- **Relative Path** ise oluşturulan API Proxy'nin erişime açılacak adresidir.
- **Category List** alanı da oluşturulan API Proxy'nin kategorilendirilmesine olanak sağlar.

<img src="/images/tutorials/senaryo6.png" alt="Senaryo Diyagramı" width="800" />


Bu ayarlamalar yapıldıktan sonra API Proxy kaydedilir.

Kaydetme işleminden sonra açılan sayfada **Develop** sekmesine tıklanır.
<img src="/images/tutorials/senaryo7.png" alt="Senaryo Diyagramı" width="800" />


<Info>
  Bu endpointlerin üstünde yer alan **All** ifadesiyle eklenecek olan poliçeler **tüm endpointlere** uygulanabilmektedir.
</Info>

Oluşturulan API Proxy deploy edilir. Bunun için yukarıda orta kısımda yer alan **Deploy** butonuna tıklanır.
<img src="/images/tutorials/senaryo8.png" alt="Senaryo Diyagramı" width="800" />


## Credentials Oluşturulması

Eklenecek **Credential'a** ait bilgiler **username = apinizer**, **password = 123123aA** olacak şekildedir.

**Identity Management** menüsüne gelinir.

Burada ise **Credential Management** menüsü altında yer alan **Credentials** menüsüne tıklanır.
<img src="/images/tutorials/senaryo9.png" alt="Senaryo Diyagramı" width="200" />


Açılan ekranda sağ üst köşede yer alan **Create** butonuna tıklanır.
<img src="/images/tutorials/senaryo10.png" alt="Senaryo Diyagramı" width="600" />

Burada gerekli olan alanlar daha önceden belirtilen bilgilerle doldurulur ve **Save and Deploy** butonuna tıklayarak oluşturulan **credential** kaydedilir.
<img src="/images/tutorials/senaryo11.png" alt="Senaryo Diyagramı" width="800" />


Bu **credential öğesinin** erişim sağlayacağı proxy'nin seçilmesi gerekmektedir. Oluşturulan **credential'ın** üzerine gelip yanda yer alan menüden **Edit** seçeneğine tıklanır.
<img src="/images/tutorials/senaryo12.png" alt="Senaryo Diyagramı" width="800" />

Açılan ekran üzerinden **API Proxy ACL** sekmesine tıklanır, bu sekme içerisinde yer alan butona tıklanır.
<img src="/images/tutorials/api-proxy-acl.png" alt="Senaryo Diyagramı" width="800" />

Açılan sayfada şu an üzerinde çalışılan projede bulunan **API Proxy'ler** listelenmektedir. **Swagger Petstore** isimli **proxy** seçilir.

**Add** butonuna tıklayarak oluşturulan **Credential** öğesinin bu **proxy'ye erişimi olacağı belirtilir.**
<img src="/images/tutorials/senaryo14.png" alt="Senaryo Diyagramı" width="600" />


Sağ üst köşede yer alan **Save and Deploy** butonuna tıklanır ve yapılan işlem kaydedilir.
<img src="/images/tutorials/save.png" alt="Senaryo Diyagramı" width="600" />

## Değişken Tanımlaması

Poliçede kullanılacak olan değişkenin tanımının yapılması gerekmektedir.

**Add** butonuna tıklanır.
<img src="/images/tutorials/new1.png" alt="Senaryo Diyagramı" width="600" />


- **Name** input alanına oluşturulmak istenilen değişkenin adı yazılır.
- **Type** alanında ise kullanılacak değişkenin tipi belirtilir.
- **Header Name** alanında ise kullanılacak değişkenin **Header** içerisinde hangi adla isimlendirileceği ifade edilir.

Yapılan değişiklikler **Save** butonuna tıklanarak kaydedilir.
<img src="/images/tutorials/new2.png" alt="Senaryo Diyagramı" width="600" />


## Authentication Poliçesinin Eklenmesi

Artık **Basic (Base64) Authentication** poliçesi eklenebilir duruma gelmiştir.

API Proxy'lerin listelendiği sayfaya gidilir ve buradan **Swagger Petstore** isimli proxy seçilir.

Daha sonra ise **Develop** sekmesine gelinir, **Add Policy** butonuna tıklanır.

Açılan sayfada **Basic Authentication** poliçesi seçilir.
<img src="/images/tutorials/basic-new.png" alt="Senaryo Diyagramı" width="800" />

Bu ekran üzerinde yer alan alanlar:

- **Identity/Role/Group Service** alanında seçilecek olan değer **Security Manager** değeridir. Çünkü credentials kontrolü **Security Manager** tarafından gerçekleştirilecektir.
- **Variable for authorization** alanında ise kullanılan **authentication** türü **Basic** (**Base64**) olduğu için ve bu **authentication** türünde de kullanılan **username**-**password** bilgileri encrypted edildiği için bu ifade kullanılır. Bu senaryoda bu değer **header** içerisinden alınacaktır.

<Warning>
  **Clear Authentication Information** seçeneği seçilirse gelen mesaj içerisinde authentication bilgisi silinir. Bu ayarın aktifleştirilmesi özel bir durum olmadığı sürece her zaman tavsiye edilmektedir.
</Warning>

- **Add Client Info To Header** seçeneği backend API'ye gidecek Header içerisinde istemciye ait bilgilerin bulunup bulunmayacağını belirtir.
- Bu seçenek aktif duruma gelirse **Authenticated User Header Name** isminde başka bir parametre ortaya çıkmaktadır.
- Burada yer alan **X-Authenticated-UserId** ifadesi ise backend API'ye gidecek olan istemci bilgisinin hangi başlık ismi ile gideceğini belirtmektedir.
<img src="/images/tutorials/basic.png" alt="Senaryo Diyagramı" width="800" />

<Info>
  Poliçe kaydolduğu zaman ilgili ikon görülmektedir.
</Info>

Yapılan işlemin geçerli olması için proxy'nin **Deploy** olması gerekmektedir.
<img src="/images/tutorials/senaryo18.png" alt="Senaryo Diyagramı" width="800" />



## API Proxy'nin Test Edilmesi

**"/pet/{petId}"** endpoint'i seçildikten sonra, **Test Endpoint** butonuna tıklanır.
<img src="/images/tutorials/senaryo19.png" alt="Senaryo Diyagramı" width="800" />


URL'de istenilen **petId** değeri **"2"** olarak girilir, **Send** butonuna basıldığında dönen yanıtın bir hata mesajı olduğu görülmektedir.
<img src="/images/tutorials/senaryo20.png" alt="Senaryo Diyagramı" width="800" />


<Warning>
  Bu hatanın uygulanmış olan **Basic (Base64) Authentication** ile alakalı olduğu görülmektedir. Çünkü **header'ın** içerisine hiçbir şekilde bir **authentication** bilgisi yerleştirilmemiştir.
</Warning>

Bu proxy'de **Basic (Base64) Authentication** kullanıldığı için **username** ve **password** bilgilerinin de bu yönde **encrypted** edilmesi gereklidir.

## Base64 Türünde Şifrelemenin Yapılması

**Test** menüsü altında yer alan **Toolbox** menüsü seçilir, burada **Base64** şifreleme formatında **encode** ve **decode** yapabilecek bir araç bulunmaktadır. Bu araç seçilir.
<img src="/images/tutorials/sifre1.png" alt="Senaryo Diyagramı" width="200" />

**decoded data** alanına şifrelenmesini istediğiniz ifadeler yazılır, **encoded data** alanında ise şifrelenen veri elde edilir.
<img src="/images/tutorials/sifre2.png" alt="Senaryo Diyagramı" width="800" />

**Encode** edilmiş hali olan **username** ve **password** bilgisi buradan elde edilir ve tekrardan **proxy'lerin** listelendiği sayfaya gidilir.

**Swagger Petstore** isimli proxy seçilir.

**Develop** sekmesine geçiş yapılır burada listelenmekte olan endpoint'lerden **"/pet/{petId}"** endpoint'i seçilir ve **Test Endpoint** denir.

URL'de istenilen **petId** değeri yine **"2"** olarak verilir.

**Headers** içerisinde **Authorization** ifadesini ve buna da değer olarak **encoded edilen username ve password** bilgisi **Base64** formatında girilir.

**Send** butonuna tıklanarak belirtilen **id'ye** göre veri getirme işlemi gerçekleştirilir.
<img src="/images/tutorials/sifre3.png" alt="Senaryo Diyagramı" width="800" />


