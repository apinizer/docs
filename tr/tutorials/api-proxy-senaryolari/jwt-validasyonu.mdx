---
title: "JWT Validasyonu"
description: "JWT Validasyonu"
---

*   *   *   *   * 

  * [Apinizer Dokümantasyonu](/apinizer-dokumantasyonu/apinizer-dokuemantasyonuna-hos-geldiniz-1179695.html)
  * [Senaryolar (Tutorials)](/apinizer-dokumantasyonu/senaryolar-tutorials-16812800.html)
  * [API Proxy Senaryoları](/apinizer-dokumantasyonu/api-proxy-senaryolari-26345947.html)
  * Current: JWT Validasyonu

# JWT Validasyonu

Bu senaryoda **Swagger PetStore** isimli **REST** mimaride oluşturulmuş bir **API'ye,** gönderilen JWT'nin **J****OSE Validation** poliçesi ile kontrol edilmesi anlatılacaktır.

Aşağıdaki görselde bir isteğe uygulanacak olan JOSE Validation iş akışı yer almaktadır.  

![](/apinizer-dokumantasyonu/files/70845921/70846608/1/1684219559604/Apinizer-JOSE-OnlyJWS.jpg)

## 1) API Proxy'nin Oluşturulması

Bu senaryoda Swagger Petstore([https://petstore.swagger.io](https://petstore.swagger.io/)) isimli REST API kullanılacaktır.  

İlk olarak bu adresin **API Proxy** olarak tanımlanması gereklidir.

Bunun için **Development **menüsü altında yer alan **API Proxies** seçeneğine tıklanır. 

![](/apinizer-dokumantasyonu/files/70845921/70845936/1/1683889843138/image2022-9-21_14-3-6.png)

  

Açılan sayfada daha önceden herhangi bir **proxy** tanımı yapılmadığı için **No records found!** yazısı yer alır.

Burada sağ üst köşede yer almakta olan **Create** butonuna tıklanır ve yeni bir **P****roxy** oluşturulmaya başlanır.

![](/apinizer-dokumantasyonu/files/70845921/75794750/1/1689680868015/image2023-7-17_11-23-46.png)

  

Bu kısımda oluşturulacak olan **API Proxy'nin** hangi tipte olduğunun seçilmesi gerekmektedir.

Bu senaryoda kullanılacak olan API'nin türü **Swagger 2.X** olacağı için bu tür seçilir.

**Enter URL** ifadesine tıklanarak kullanılacak olan API'nin adresinin girileceği ekrana geçiş yapılır.

[![](/apinizer-dokumantasyonu/files/70845921/75794751/1/1689680898034/image2023-7-17_11-27-3.png)](https://docs.apinizer.com/apinizer-dokumantasyonu/files/26345975/26346033/1/1633354798049/apiswagger.png)

  

Aşağıdaki görselde de görüldüğü üzere **URL kısmına erişim sağlanacak adres girilerek Parse** butonuna tıklanır. 

[![](https://docs.apinizer.com/apinizer-dokumantasyonu/files/26345975/26346035/1/1633355007535/apiswagger2.png)](https://docs.apinizer.com/apinizer-dokumantasyonu/files/26345975/26346035/1/1633355007535/apiswagger2.png)

  

Parse işlemi yapıldıktan sonra ise aşağıdaki görselde yer alan ekran gelmektedir. 

Bu ekran üzerinden API Proxy'ye ait ayarlar yapılabilmektedir. Bu ayarlar hakkında detaylı bilgi almak için [API Proxy Oluşturma](/apinizer-dokumantasyonu/api-proxy-olusturma-13271689.html) dokümanını ziyaret edebilirsiniz.  

Senaryomuzda kullanılacak olan Api Proxy'nin ayarları aşağıdaki gibidir.

![](/apinizer-dokumantasyonu/files/70845921/75794752/1/1689680898290/image2023-7-17_11-30-56.png)

  

Kaydetme işleminden sonra ise açılan sayfada **Develop** sekmesine tıklanır.

![](/apinizer-dokumantasyonu/files/70845921/75794754/1/1689680927992/image2023-7-17_11-33-42.png)

  

Burada **REST API'ye **ait **endpoint'ler** listelenmektedir. 

**All **ifadesiyle **tüm metodlara** veya **tek bir** **metoda** **JOSE Validation** poliçesi eklenebilir.  

![](/apinizer-dokumantasyonu/files/70845921/75794755/1/1689680928320/image2023-7-17_11-40-12.png)

  

JOSE Validationda**imza doğrulamasını** yapabilmek için **JSON Web Keypair Sets** eklenmesi gerekmektedir.

## 2) JSON Web Keypair Sets

JSON Web Keypair Sets eklemek için sol menüden Secret Manager altından JSON Web Keypair Sets menüsüne girilir.

![](/apinizer-dokumantasyonu/files/70845921/70846425/1/1684132974853/image2023-5-15_9-42-54.png)

  

Açılan ekranda sağ üst köşede yer alan dikdörtgen içerisine alınmış **Create****** butonuna tıklanır.

![](/apinizer-dokumantasyonu/files/70845921/70846434/1/1684134499497/image2023-5-15_10-8-19.png)

  

Bu doküman içerisinde JSON Web Keypair Sets'in Apinizer ile veya Keycloak(3.party bir yazılım) ile üretilmesi üzerinde durulacaktır.

  

**2.1) Apinizer Üzerinden JWK Üretilmesi:**

Bu senaryoda Name alanı **testjwk senaryo** olarak kullanılacaktır.

**Generate JWK** seçeneği ile ve istenen algoritma kullanılarak JWK oluşturulur.

![](/apinizer-dokumantasyonu/files/70845921/70846472/1/1684148335613/image2023-5-15_13-58-55.png)  

  

Generate butonu kullanılması sonucu JWK oluşturulmaktadır. Oluşan Public Key doğrulama işlemlerinde kullanılmaya hazırdır.

![](/apinizer-dokumantasyonu/files/70845921/70846617/1/1684220773824/image2023-5-16_10-6-13.png)

Son adım olarak **Save And Deploy** butonuna tıklayarak kaydedilir.

  

**2.2) Keycloak Üzerinden JWK Üretilmesi :**

Keycloak üzerinden Realm Settings > Keys menüsünden Public key alanına basılarak Public key alınır.

![](/apinizer-dokumantasyonu/files/70845921/70846496/1/1684158951703/image2023-5-15_16-55-51.png)

  

![](/apinizer-dokumantasyonu/files/70845921/70846500/1/1684159577992/image2023-5-15_17-6-17.png)

  

Public key, 3.party bir araçla JWK'ya dönüştürülmelidir. Bunun için şu adres kullanılabilir: [https://russelldavies.github.io/jwk-creator/](https://russelldavies.github.io/jwk-creator/)  

JWK'a dönüştürülen public keyi Apinizer'a Kaydetmek için;

  * Sol menüden Secret Manager menüsünün altından JSON Web Keypair Sets sayfasına gidilir.  

  * Bu senaryoda Name alanı **testjwk senaryo** olarak kullanılacaktır.
  * **Paste the content of the JWT** seçeneği seçilir ve ilgili alana JWK girilir.  

  * **Key id** alanına ise Keycloak 'da bulunan **Kid** alanındaki değer girilir ve ardına **Save and Deploy** butonuna tıklayarak kaydedilir.

![](/apinizer-dokumantasyonu/files/70845921/70846501/1/1684159802694/image2023-5-15_17-10-1.png)  

## 3) Authentication Poliçesinin Eklenmesi

Artık **JOSE Validation****** poliçesi kullanılabilir duruma gelmiştir. 

API Proxy'lerin listelendiği sayfaya gidilir ve buradan **Swagger Petstore **isimli proxy seçilir.

Daha sonra ise **Develop **sekmesine gelinir, **Add Policy** butonuna tıklanır.

Açılan sayfada **JOSE Validation********** poliçesi seçilir.

![](/apinizer-dokumantasyonu/files/70845921/70846436/1/1684135835881/image2023-5-15_10-30-35.png)

  

Seçilen

![](/apinizer-dokumantasyonu/files/70845921/70846438/1/1684136098267/image2023-5-15_10-34-58.png)

  

Bu ekran üzerinde yer alan ifadeler tek tek incelenmek istenirse [JSON Web Keypair Sets](/apinizer-dokumantasyonu/json-web-keypair-sets-39741465.html) sayfasını ziyaret edebilirsiniz.  

Bu senaryo içerisinde kullanılacak olan ayarlamalar aşağıdaki görselde yer aldığı gibidir bu değişiklikleri yaptıktan sonra sağ üst köşede yer alan **Save** butonuna tıklanır.

![](/apinizer-dokumantasyonu/files/70845921/70846664/1/1684242897569/image2023-5-16_16-14-57.png)

## 4) API Proxy'nin Test Edilmesi

**Swagger Petstore** isimli proxy seçilir. 

**Develop** sekmesi altında yer alan **/pet/findByStatus****** isimli endpoint seçilir. 

**Test Endpoint** ifadesine tıklanarak bu endpoint test edilir.

URL' de istenilen**status** değeri **pending****** olarak girilir, **Send** butonuna basıldığında dönen yanıtın bir hata mesajı olduğu görülür. 

**Header** içerisine **Authorization header** yerleştirilir ve keycloak'tan veya Apinizer'dan üretilmiş **token bilgisi** burada kullanılır.

**Send** butonuna tıkladığında alınan cevap görsel üzerinde aşağıda yer alan dikdörtgen içerisindeki ifadedir.

![](/apinizer-dokumantasyonu/files/70845921/70846457/1/1684141218595/image2023-5-15_12-0-18.png)  

  

Eğer uygun olmayan token değeri kullanılırsa hata alınacaktır.

×