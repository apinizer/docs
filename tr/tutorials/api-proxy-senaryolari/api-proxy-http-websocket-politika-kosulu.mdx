---
title: API Proxy'de HTTP ve WebSocket Servislerine Politika Koşulu
---

# Api Proxy'de HTTP ve WebSocket Servislerine Politika Koşulu

Aynı proxy üzerinde hem HTTP hem de WebSocket servisleri çalışıyorsa, Apinizer politikalarının yalnızca HTTP isteklerine uygulanabilmesi için ilgili politikalara koşul eklenmelidir. Bu koşul sayesinde WebSocket bağlantıları politika kontrolünden etkilenmeden çalışmaya devam eder.

Örnek senaryoda, API proxy'ye eklenen script politikası HTTP isteklerine belirli bir `Authorization` header'ı eklemektedir. Ancak, WebSocket isteklerinde bu script politikasının uygulanmaması hedeflenmektedir.

Script politikası eklenir:

Script politika ekranında **Conditions** sekmesine geçilir ve yeni bir kural eklenir.

Variable olarak mevcutsa **header:Upgrade** seçilir; yoksa yeni variable olarak **header** türünde **Upgrade** başlığı eklenir.

**Upgrade header'ı** için koşul, değeri **websocket** olan istekleri kapsayacak şekilde aşağıdaki gibi düzenlenir ve kaydedilir:

Böylece, Upgrade header'ı websocket olan istekler koşul ile filtrelenerek, script politikası sadece HTTP isteklerine uygulanır ve WebSocket bağlantılarında politika devre dışı bırakılır. Bu sayede WebSocket trafiği etkilenmeden çalışmaya devam eder.
