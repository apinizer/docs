---
title: "Sunucu IP Adresinin Değiştirilmesi Durumunda Yapılacaklar"
description: "Apinizer sunucu IP adresi değişikliğinde Kubernetes Master ve MongoDB yapılandırmalarını günceller, sertifikaları yeniden oluşturur ve replica set konfigürasyonunu günceller."
---

## Kubernetes Master için yapılacaklar:

Aşağıdaki dosyalarda ip'leri değiştirilir:

```bash
/etc/kubernetes/admin.conf
/etc/kubernetes/controller-manager.conf 
/etc/kubernetes/kubelet.conf
/etc/kubernetes/scheduler.conf
/etc/kubernetes/manifests/etcd.yaml
/etc/kubernetes/manifests/kube-apiserver.yaml
```

Mevcut sertifikalar silinir:

```bash
cd /etc/kubernetes/pki
rm -rf apiserver.* apiserver-kubelet-client.*
```

Yeni sertifikalar oluşturulur (bu aşamada hatalar verebiliyor ancak gözardı edilebilirler):

```bash
sudo kubeadm init phase certs apiserver-kubelet-client
sudo kubeadm init phase certs apiserver

sudo systemctl restart kubelet
```

Mevcut kullanıcının erişimi için güncel config dosyası kullanıcı altına taşınır:

```bash
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
```

## MongoDB için yapılacaklar:

MongoDB'ye bağlanılır:

```bash
mongosh mongodb://<YOUR_NEW_MONGO_IP_ADDRESS>:25080 --authenticationDatabase "admin" -u "apinizer" -p
```

Yeni ip ayarları, "force" seçeneğiyle verilir:

```javascript
cfg = rs.conf()
cfg.members[0].host = "<YOUR_NEW_MONGO_IP_ADDRESS>:25080"
rs.reconfig(cfg, {force:true})
```
