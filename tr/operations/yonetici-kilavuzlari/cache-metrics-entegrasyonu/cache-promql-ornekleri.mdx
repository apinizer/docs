---
title: Apinizer Cache için Örnek PromQL Sorguları
description: Apinizer Cache metriklerini analiz etmek için kullanılabilecek örnek PromQL sorguları sağlar. Önbellek performansı, API analizleri, JVM metrikleri ve sistem kaynak kullanımı gibi farklı kategorilerde hazır sorgu örnekleri içerir. Bu sorgular, Grafana dashboard'larında veya Prometheus Query UI'da kullanılarak Cache performansını izleme ve analiz etme imkanı sağlar.
---

# Apinizer Cache için Örnek PromQL Sorguları

## Önbellek Analizleri

<Info>
  Önbellek kullanımını ve verimliliğini izlemek için kullanılan metriklerdir. Önbellek aramaları, eklemeleri ve bellek tüketimi gibi verilerle performans değerlendirilir.
</Info>

### 1. Toplam Önbellek Arama Sayısı (1 saat için)

```promql
sum(increase(cache_gets_total[1h]))
```

### 2. Önbellek Ekleme Sayısı (10 dakika için)

```promql
sum(increase(cache_puts_total[10m]))
```

### 3. Önbellek İsabet Oranı (%) (5 dakika için)

```promql
(sum(increase(cache_gets_total[5m])) - sum(increase(apinizer_cache_api_errors_total[5m]))) / sum(increase(cache_gets_total[5m])) * 100
```

### 4. Önbelleteki Mevcut Girdi Sayısı

```promql
sum(cache_size)
```

### 5. En Yüksek Bellek Kullanımına Sahip Cache Özellikleri

```promql
topk(5, sum by (cache) (cache_entry_memory_bytes))
```

## Cache API Analizleri

<Info>
  Cache API isteklerinin performansını izlemek için kullanılır. API istek sayısı ve başarı oranı gibi verilerle sistemin yanıt verme yeteneği analiz edilir.
</Info>

### 1. Toplam API İstek Sayısı (1 saat için)

```promql
sum(increase(apinizer_cache_api_requests_total[1h]))
```

### 2. API Başarı Oranı (%) (10 dakika için)

```promql
(sum(increase(apinizer_cache_api_requests_total[10m])) - sum(increase(apinizer_cache_api_errors_total[10m]))) / sum(increase(apinizer_cache_api_requests_total[10m])) * 100
```

## JVM Analizleri

<Info>
  JVM'in bellek kullanımı, GC (Garbage Collector) duraklatma süreleri ve iş parçacığı sayısını izleyerek uygulamanın kaynak tüketimi ve performansı değerlendirilir.
</Info>

### 1. Bellek Kullanım Yüzdesi

```promql
(sum(jvm_memory_used_bytes{application="apinizer-cache"}) * 100) / sum(jvm_memory_max_bytes{application="apinizer-cache"})
```

### 2. Garbage Collection Süresi (5 dakika için)

```promql
sum(rate(jvm_gc_pause_seconds_sum{application="apinizer-cache"}[5m]))
```

### 3. Mevcut Canlı İş Parçacığı Sayısı

```promql
sum(jvm_threads_live_threads{application="apinizer-cache"})
```

## Sistem Analizleri

<Info>
  Sistemin CPU kullanımı, işlem süresi ve açık dosya tanımlayıcı sayıları gibi verilerle genel kaynak kullanımı ve performansı izlenir.
</Info>

### 1. Pod'ların CPU Kullanımı

```promql
sum(rate(container_cpu_usage_seconds_total{namespace="apinizer"}[5m])) by (pod) * 100
```

### 2. JVM İşlem Süresi (saniye)

```promql
sum(process_uptime_seconds)
```

### 3. Açık Dosya Tanımlayıcı Sayısı

```promql
sum(process_files_open_files{application="apinizer-cache"})
```
