---
title: "Ağ Geçidi Ortamları"
description: "Kubernetes ortamları oluşturabilir, Gateway Engine ve Cache sunucu yapılandırması yapabilir, ortam yayımlayabilir ve metrik izleme gerçekleştirebilir. API Proxy trafik log konnektörlerini yapılandırabilir ve JWT token doğrulama anahtarlarını yönetebilir."
---

<Info>
Ortam (Environment), bir kuruluttaki API Proxy'leri (API Proxy) için bir çalışma zamanı yürütme bağlamıdır (Runtime Execution Context). Bu bölümde, ortam oluşturma ve ilgili işlemler anlatılmaktadır.
</Info>

<Info>
Sistem Genel Ayarlar ekranı üzerinden, **Kubernetes Namespace ve Resource'lar Apinizer ile yönetilsin** seçeneği Aktif olarak işaretlendiğinde gelmektedir.
</Info>

## Ortam Oluşturma

Ortam oluştururken genel tanım bilgilerini içeren görsellere aşağıda yer verilmiştir:

<img
  src="/images/yonetici/ortam-olusturma.png"
  alt="Ortam Oluşturma"
  width="1000"
  height="600"
/>


Ortam oluştururken genel tanım bilgilerini içeren alanlar:

| Alan | Açıklama |
|------|----------|
| **Tür**  | Lisans'a ve kullanılan ortama uygun bir değer seçilmesi gerekmektedir. Test veya Üretim (Production) seçilebilir. |
| **İletişim Protokolü Türü** (Communication Protocol Type) | HTTP, gRPC, HTTP+Websocket iletişim protokollerinden birisi seçilebilir. |
| **Ad**  | Ortamın adı. Kubernetes'teki namespace'e karşılık gelmektedir. |
| **Anahtar** (Key) | Oluşturulan ortam için kullanılan ve ortama özgü kısaltılmış bir anahtardır. |
| **Node Listesi** (Node List) | Oluşturulan ortamın hangi kubernetes sunucularında çalışacağı seçilir. |
| **Proje** (Project) | Ortamın kullanılabileceği projeleri buradan seçebilir ya da tüm projelerde kullanılabilmesi için seçimi boş bırakılabilir. Eğer bir veya birden çok proje seçimi yapılırsa, yeni oluşturulan projelerde de kullanılmak için onların da eklenmesi gerekmektedir. Varsayılan değer olarak seçimsiz gelir. |
| **Erişim URL Adresi** (Access URL) | Ortam içinde çalışan API Proxy'lerin dış erişim adresidir. |
| **Açıklama**  | Yönetim kolaylığı ve önemli notlar için kullanılabilir. |
| **Gateway Sunucusu Erişim URL'si** | Apinizer Yönetim konsolunda yapılan konfigürasyonların Gateway Pod'larına yüklenebilmesi için gerekli olan nodeport veya ingress tipindeki servis erişim adresi. Örnek: `http://worker-http-service.prod.svc.cluster.local:8091` Eğer **HTTPS Etkin (HTTPS Enabled)** seçeneği seçilirse buradaki adrese de dikkat edilmelidir. Örnek: `https://worker-https-service.prod.svc.cluster.local:8443` |
| **Cache Sunucusu Erişim URL'si** | Apinizer Yönetim konsolunda yapılan konfigürasyonların Cache Pod'larına yüklenebilmesi için veya Gateway Pod'larının cache podlarına erişebilmesi için gerekli olan nodeport veya ingress tipindeki servis erişim adresi. Örnek: `http://cache-http-service.prod.svc.cluster.local:8090` |

<Warning>
**İletişim Protokolü Türü Seçimi:**

API Proxylerin hangi ortama deploy edilebileceğini burada seçilen tür belirler:
- REST ve SOAP API Proxyler → **HTTP** tipindeki ortama
- gRPC API Proxyleri → **gRPC** tipindeki ortama
- Websocket API Proxyler → **HTTP+Websocket** tipindeki ortama deploy edilebilir
</Warning>

<Tip>
**Proje Seçimi:** Proje seçilmesi durumunda sadece o proje içerisinde yer alan API Proxy'lerin bu ortama deploy edilebileceği anlamına gelir.
</Tip>

### API Proxy Trafik Log Konnektörleri

Ortamdaki tüm API Proxy Trafiğinin ve uzantılarının loglanacağı log konnektörleri buradan tanımlanır.

API Proxy Trafik Log Konnektörü tanımlamalarını içeren görsele aşağıda yer verilmiştir:
<img
  src="/images/yonetici/log-konnektor.png"
  alt="API Proxy Trafik Log Konnektörü"
  width="1000"
  height="600"
/>

Ortama konnektör ekleme hakkında daha fazla bilgi için [bu sayfaya](/tr/admin/server-management/ag-gecidi-ortamlarina-konnektor-eklenmesi) bakın.

## Gateway Engine ve Cache Sunucu Ayarları

Gateway engine ve Cache sunucusu, Kubernetes ortamındaki pod'lara karşılık gelmektedir.

- **Gateway engine** (`apinizer-worker`): Apinizer Platform'un çekirdek (core) modülüdür, tüm API isteklerinin BackendAPI'ye yönlendirilmesinden sorumludur ve Policy Enforcement Point olarak çalışır
- **Cache sunucusu** (`apinizer-cache`): Apinizer'da gerek duyulan Cache değerlerinin tutulduğu ortamdır

Gateway engine ve Cache sunucu tanımlamalarını içeren görsellere aşağıda yer verilmiştir:
<img
  src="/images/yonetici/getway-engine.png"
  alt="Gateway Engine ve Cache Sunucu Tanımlamaları"
  width="1000"
  height="600"
/>

### Gateway Engine Konfigürasyonu

<AccordionGroup>
  <Accordion title="Temel Ayarlar" icon="sliders">
    | Alan | Açıklama |
    |------|----------|
    | **Sayı** (Count) | Gateway engine sayısı, Kubernetes deployment'taki "replicas" değerine karşılık gelmektedir. Oluşturulacak Kubernetes Cluster'da oluşacak Pod sayısını belirtir. |
    | **CPU** | Pod'un kullanacağı maksimum CPU core sayısı bilgisidir. |
    | **Bellek** (Memory) | Pod'un kullanacağı maksimum bellek değeridir. |
    | **Bellek Birimi** (Memory Unit) | Bellek için gerekli olan değerin birimi seçilir; MB, GB. |

    **Önerilen Değerler:**

    | CPU | Bellek Boyutu |
    |-----|---------------|
    | 1   | 2GB           |
    | 2   | 4GB           |
    | 4   | 6GB           |
    | 8   | 10GB          |
  </Accordion>

  <Accordion title="Servis Erişim Bilgileri" icon="network-wired">
    - **HTTP Etkin** (HTTP Enabled): Varsayılan olarak seçili olarak gelir
    - **HTTPS Etkin** (HTTPS Enabled): HTTPS kullanılmak istenirse bu seçenek de seçilir, bu durumda şifreleme için gerekli dosyalar yüklenmelidir
    - **mTLS**: HTTPS protokolü üzerinde çalıştığından sadece HTTPS ayarı açıkken seçilebilir

    **Keystore ve Truststore:** HTTPS protokülü seçildiğinde, keystore ve truststore dosyaları JKS veya PFX formatında yüklenebilir.

    **Servis Portları:** 30080-32767 aralığında bir servisin portu girilir. Servis Kubernetes'te NodePort olarak oluşacaktır.
  </Accordion>

  <Accordion title="Ek Değişkenler (Additional Variables)" icon="code">
    Pod içinde çalıştırılacak varsayılan ve opsiyonel değişkenler ve değerleri tanımlanır.

    **Önemli Değişkenler:**

    | Değişken | Hedef Ortam | Açıklama |
    |----------|-------------|----------|
    | `JAVA_OPTS` | Hepsi | JVM Heap değerlerini ayarlar |
    | `tuneWorkerThreads` | HTTP Worker, HTTP+Websocket, Management API | Sunucunun minimum Worker thread sayısı |
    | `tuneWorkerMaxThreads` | HTTP Worker, HTTP+Websocket, Management API | Sunucunun maksimum Worker thread sayısı |
    | `tuneBufferSize` | HTTP Worker, HTTP+Websocket, Management API | Thread'in yazma işlemi için kullanacağı buffer alanı |
    | `tuneIoThreads` | HTTP Worker, HTTP+Websocket, Management API | IO Thread sayısı |
    | `tuneBacklog` | HTTP Worker, HTTP+Websocket, Management API | Backlog değeri |
    | `tuneRoutingConnectionPoolMaxConnectionPerHost` | HTTP Worker, HTTP+Websocket, Management API | Host başına maksimum bağlantı sayısı |
    | `tuneRoutingConnectionPoolMaxConnectionTotal` | HTTP Worker, HTTP+Websocket, Management API | Toplam maksimum bağlantı sayısı |
    | `tuneRoutingConnectionPoolMinThreadCount` | HTTP Worker, HTTP+Websocket, Management API | Routing Connection Pool minimum thread sayısı |
    | `tuneRoutingConnectionPoolMaxThreadCount` | HTTP Worker, HTTP+Websocket, Management API | Routing Connection Pool maksimum thread sayısı |
    | `tuneElasticsearchClientIoThreadCount` | HTTP Worker, HTTP+Websocket, Management API | Elasticsearch Client IO Thread sayısı |
    | `tuneMaxConcurrentRequest` | HTTP Worker, HTTP+Websocket, Management API | Maksimum eşzamanlı istek sayısı (varsayılan: tuneWorkerMaxThreads * tuneIoThreads) |
    | `tuneMaxQueueSize` | HTTP Worker, HTTP+Websocket, Management API | Maksimum kuyruk boyutu (varsayılan: 0) |
    | `tuneCacheConnectionPoolMaxConnectionTotal` | HTTP Worker, HTTP+Websocket, Management API | Cache Connection Pool toplam maksimum bağlantı sayısı (varsayılan: 2048) |
    | `tuneApiCallConnectionPoolMaxConnectionPerHost` | HTTP Worker, HTTP+Websocket, Management API | API Call Connection Pool host başına maksimum bağlantı sayısı (varsayılan: 256) |
    | `tuneApiCallConnectionPoolMaxConnectionTotal` | HTTP Worker, HTTP+Websocket, Management API | API Call Connection Pool toplam maksimum bağlantı sayısı (varsayılan: 4096) |
    | `multipartConfigMaxFileSize` | HTTP Worker, HTTP+Websocket, Management API | Multipart config maksimum dosya boyutu (varsayılan: 100MB) |
    | `multipartConfigMaxRequestSize` | HTTP Worker, HTTP+Websocket, Management API | Multipart config maksimum istek boyutu (varsayılan: 100MB) |
    | `multipartConfigFileSizeThreshold` | HTTP Worker, HTTP+Websocket, Management API | Multipart config dosya boyutu eşiği (varsayılan: 100MB) |
    | `defaultCharset` | HTTP Worker, HTTP+Websocket, Management API | Varsayılan karakter seti (varsayılan: UTF-8) |
    | `deploymentTimeout` | HTTP Worker, HTTP+Websocket, Management API | Deployment timeout süresi saniye cinsinden (varsayılan: 30) |
    | `http2Enabled` | HTTP Worker, HTTP+Websocket, Management API | HTTP/2 protokolünü etkinleştirir (varsayılan: false) |
    | `environmentClusterName` | HTTP Worker, HTTP+Websocket, Management API | Ortam cluster adı |
    | `tuneAsyncExecutorCorePoolSize` | HTTP Worker, HTTP+Websocket, Management API | Async executor core pool boyutu (varsayılan: tuneWorkerThreads) |
    | `tuneAsyncExecutorMaxPoolSize` | HTTP Worker, HTTP+Websocket, Management API | Async executor maksimum pool boyutu (varsayılan: tuneWorkerMaxThreads) |
    | `tuneAsyncExecutorQueueCapacity` | HTTP Worker, HTTP+Websocket, Management API | Async executor kuyruk kapasitesi (varsayılan: tuneMaxQueueSize > 0 ? tuneMaxQueueSize : 1000) |
    | `logLevel` | Hepsi | Uygulama loglarının seviyesi (ERROR, WARNING, INFO, DEBUG, TRACE, OFF) |

    <Info>
    **Asenkron İşlemler Thread Pool'u:**

    RestApi Politası ve Script politikası, asenkron işlemler için `ManagementConfig`'de yapılandırılan merkezi thread pool'u kullanır. Bu, thread yönetimini iyileştirir ve kaynak kullanımını optimize eder. Ortamlarda gerçekleştirilen asenkron işlemler, bu ayrı thread pool tarafından yönetilir ve optimal performans ve kaynak tahsisi için belirli parametrelerle yapılandırılabilir.
    </Info>

    <Tip>
    **CPU'ya Göre Önerilen Thread Değerleri:**

    | CPU | tuneWorkerThreads | tuneWorkerMaxThreads |
    |-----|-------------------|----------------------|
    | 1   | 512               | 1024                 |
    | 2   | 1024              | 2048                 |
    | 4   | 2048              | 4096                 |
    | 8   | 4096              | 8192                 |
    </Tip>

    <Warning>
    **Java Options (-Xmx ve -Xms) Uyarısı:**

    Ek değişkenler alanındaki **Java Options** ayarını yapılandırırken aşağıdaki uyarı dikkate alınmalıdır:

    **-Xmx** ve **-Xms** ayarlarının otomatik yığın (heap) boyutlandırmasını devre dışı bıraktığını lütfen unutmayınız.

    Apinizer, **JVM Yığın (Heap)** değerlerini konteyner içinde çalıştığından konteynere verilen belleğin **%75**'ini kullanacak şekilde ayarlar.

    **UseContainerSupport** varsayılan olarak aktif gelmektedir.

    Eski bayraklar (flag) **-XX:{Min|Max}RAMFraction** artık kullanımdan kaldırıldı. 0.0 ve 100.0 arasında bir değer alan ve varsayılan olarak 25.0 olan yeni bir **-XX:MaxRAMPercentage** bayrağı (flag) vardır. Bu nedenle, 1 GB bellek sınırı varsa, JVM yığını (heap) varsayılan olarak ~250 MB ile sınırlıdır.
    </Warning>
  </Accordion>

  <Accordion title="gRPC Protokolü Özel Ayarları" icon="g">
    Eğer Gateway Management API, gateway pod'lar ile HTTPS üzerinden iletişim kuracaksa:

    - **API Geçidi Yönetimi API erişimi için HTTPS hizmeti oluşturun** seçeneği seçilir
    - Keystore ve truststore dosyaları JKS veya PFX formatında yüklenebilir
    - Gateway Sunucusu Erişim URL'si girilir

    Örnek: `https://worker-http-service.prod.svc.cluster.local:8443`

    **gRPC Tuning Parametreleri:**

    | Değişken | Açıklama | Varsayılan |
    |----------|----------|------------|
    | `tuneGrpcKeepAliveTime` | gRPC keep-alive zamanı (saniye) | 120 |
    | `tuneGrpcKeepAliveTimeout` | gRPC keep-alive timeout (saniye) | 20 |
    | `tuneGrpcMaxMessageSize` | gRPC maksimum mesaj boyutu (byte) | 4194304 (4MB) |
    | `tuneGrpcMaxHeaderListSize` | gRPC maksimum header list boyutu (byte) | 8192 |
    | `tuneGrpcMaxConnectionAge` | gRPC maksimum bağlantı yaşı (saniye) | 3600 |
    | `tuneGrpcMaxConnectionAgeGrace` | gRPC maksimum bağlantı yaşı grace period (saniye) | 30 |
    | `tuneGrpcMaxConnectionIdle` | gRPC maksimum bağlantı idle süresi (saniye) | 300 |
    | `tuneGrpcMaxInboundMessageSize` | gRPC maksimum inbound mesaj boyutu (byte) | 4194304 (4MB) |
    | `tuneGrpcMaxInboundMetadataSize` | gRPC maksimum inbound metadata boyutu (byte) | 8192 |
    | `tuneGrpcHandshakeTimeout` | gRPC handshake timeout (saniye) | 20 |
    | `tuneGrpcPermitKeepAliveTime` | gRPC permit keep-alive zamanı (saniye) | 120 |
    | `tuneGrpcThreadPoolSize` | gRPC thread pool boyutu | CPU sayısı * 2 |
  </Accordion>

  <Accordion title="WebSocket Ayarları" icon="network-wired">
    **WebSocket Tuning Parametreleri:**

    | Değişken | Açıklama | Varsayılan |
    |----------|----------|------------|
    | `tuneWebsocketIdleTimeout` | WebSocket idle timeout (saniye) | 60 |
    | `tuneWebsocketBufferSize` | WebSocket buffer boyutu (byte) | 65536 |
    | `tuneWebsocketTcpNoDelay` | WebSocket TCP no delay (true/false) | true |
  </Accordion>

  <Accordion title="CORS Ayarları" icon="shield">
    <Info>
    **CORS Ayarlarının Kullanım Amacı:**

    Bu CORS (Cross-Origin Resource Sharing) parametreleri, token alımı için gelen isteklerde kullanılır. Token alımı için gelen isteklere Management Konsol üzerinden politika eklenmez; bu ayarlar ortam konfigürasyonu ile verilir. Bu parametreler normal API Proxy akışında kullanılmaz, sadece token alımı endpoint'leri için geçerlidir.
    </Info>

    **CORS (Cross-Origin Resource Sharing) Parametreleri:**

    | Değişken | Açıklama | Varsayılan |
    |----------|----------|------------|
    | `tokenCorsAccessControlAllowOrigin` | Access-Control-Allow-Origin header değeri | - |
    | `tokenCorsAccessControlAllowCredentials` | Access-Control-Allow-Credentials header değeri | - |
    | `tokenCorsAccessControlAllowMethods` | Access-Control-Allow-Methods header değeri | - |
    | `tokenCorsAccessControlAllowHeaders` | Access-Control-Allow-Headers header değeri | - |
    | `tokenCorsAccessControlOrigin` | Origin header değeri | - |
    | `tokenCorsAccessControlRequestMethod` | Access-Control-Request-Method header değeri | - |
    | `tokenCorsAccessControlRequestHeaders` | Access-Control-Request-Headers header değeri | - |
    | `tokenCorsAccessControlExposeHeaders` | Access-Control-Expose-Headers header değeri | - |
    | `tokenCorsAccessControlMaxAge` | Access-Control-Max-Age header değeri (saniye) | - |
  </Accordion>

  <Accordion title="X-Forwarded-For Ayarları" icon="network-wired">
    <Info>
    **X-Forwarded-For Ayarlarının Kullanım Amacı:**

    Bu X-Forwarded-For parametreleri, token alımı için gelen isteklerde kullanılır. Token alımı için gelen isteklere Management Konsol üzerinden politika eklenmez; bu ayarlar ortam konfigürasyonu ile verilir. Bu parametreler normal API Proxy akışında kullanılmaz, sadece token alımı endpoint'leri için geçerlidir.
    </Info>

    **X-Forwarded-For Parametreleri:**

    | Değişken | Açıklama | Varsayılan |
    |----------|----------|------------|
    | `tokenXForwardedForIpHeader` | X-Forwarded-For IP header adı | - |
    | `tokenXForwardedForIpOrder` | X-Forwarded-For IP sıralama (FIRST/LAST) | LAST |
  </Accordion>

  <Accordion title="Güvenlik Yapılandırması" icon="shield">
    Ek Değişkenler ile güvenlik yapılandırması yapılabilir:

    | Değişken | Açıklama | Varsayılan Değer |
    |----------|----------|------------------|
    | `jdkTLSVersions` | Desteklenecek TLS protokol versiyonları | TLSv1, TLSv1.1, TLSv1.2, TLSv1.3 |
    | `jdkTLSDisabledAlgorithms` | Güvenlik nedeniyle devre dışı bırakılacak TLS algoritmaları | RC4, DES, MD5withRSA, DH keySize < 768... |
    | `jdkCipherSuites` | Kullanılacak şifreleme takımları | JDK varsayılan değeri |

    <Warning>
    **Güvenlik Önerileri:**
    - TLSv1.2 ve üstü versiyonların kullanılması önerilir
    - GCM modlu şifreleme takımları tercih edilmelidir
    - Zayıf algoritmalar (RC4, DES, 3DES) devre dışı bırakılmalıdır
    - Anahtar boyutları yeterli güvenlik seviyesinde olmalıdır (RSA için en az 2048 bit, EC için en az 224 bit)
    </Warning>
  </Accordion>
</AccordionGroup>

### Cache Server Konfigürasyonu

<AccordionGroup>
  <Accordion title="Temel Ayarlar" icon="database">
    | Alan | Açıklama |
    |------|----------|
    | **Cache Sayı** | Cache sayısı, Kubernetes Cluster'daki replicaSet ile eş değerdir. |
    | **CPU** | Pod'un kullanacağı maksimum CPU core sayısı. |
    | **Bellek** | Pod'un kullanacağı maksimum bellek değeri. |

    **Önerilen Değerler:**

    | CPU | Bellek Boyutu |
    |-----|---------------|
    | 1   | 2GB + Tahmini Cache Büyüklüğü |
    | 2   | 4GB + Tahmini Cache Büyüklüğü |
    | 4   | 6GB + Tahmini Cache Büyüklüğü |
    | 8   | 10GB + Tahmini Cache Büyüklüğü |

    <Info>
    `-Xss256k` veya `-Xss128k` gibi değerler kullanarak thread başına bellek ihtiyacını azaltabilirsiniz.
    </Info>
  </Accordion>

  <Accordion title="Cache Server Ek Değişkenler" icon="gear">
    **Tomcat Ayarları:**

    | Değişken | Açıklama | CPU'ya Göre Önerilen Değerler |
    |----------|----------|-------------------------------|
    | `SERVER_TOMCAT_MAX_THREADS` | Tomcat'in işleyebileceği maksimum eşzamanlı istek sayısı | 1 CPU: 256, 2 CPU: 1024, 4 CPU: 2048, 8 CPU: 4096 |
    | `SERVER_TOMCAT_MIN_SPARE_THREADS` | Tomcat'in her zaman hazır tutacağı minimum thread sayısı | 1 CPU: 128, 2 CPU: 256, 4 CPU: 512, 8 CPU: 1024 |
    | `SERVER_TOMCAT_MAX_CONNECTIONS` | Tomcat'in aynı anda kabul edebileceği maksimum bağlantı sayısı | 1 CPU: 2048, 2 CPU: 4096, 4 CPU: 8192, 8 CPU: 16384 |

    **Hazelcast Ayarları:**

    | Değişken | Açıklama | Varsayılan |
    |----------|----------|------------|
    | `HAZELCAST_CLIENT_SMART` | Hazelcast client'ın akıllı yönlendirme kullanıp kullanmayacağı | true |
    | `HAZELCAST_MAPCONFIG_BACKUPCOUNT` | Hazelcast map verisinin kaç yedek kopyasının saklanacağı | 1 |
    | `HAZELCAST_PARTITION_COUNT` | Hazelcast partition sayısı | 271 |
    | `HAZELCAST_OPERATION_RESPONSEQUEUE_IDLESTRATEGY` | Hazelcast operation response queue idle stratejisi | - |
    | `HAZELCAST_CP_MEMBER_COUNT` | CP Subsystem member sayısı (0 = devre dışı) | 0 |
    | `HAZELCAST_CP_GROUP_SIZE` | CP Subsystem group boyutu | 3 |
    | `HAZELCAST_CP_SESSION_TTL_SECONDS` | CP Subsystem session TTL (saniye) | 300 |
    | `HAZELCAST_CP_SESSION_HEARTBEAT_SECONDS` | CP Subsystem session heartbeat aralığı (saniye) | 5 |
    | `HAZELCAST_MERGE_BATCH_SIZE` | Merge policy batch boyutu | 100 |
    | `CACHE_SERVICE_NAME` | Cache'in kubernetes üzerinden diğer cache pod'larına erişebilmesi için gerekli servis adı | cache-hz-service |
    | `CACHE_QUOTA_TIMEZONE` | Cache'de günlük kota bilgilerinin sıfırlanma zamanı için timezone (örn: +03:00) | 00:00 |
    | `CACHE_LAZY_MODE` | Cache pod'larının ilk açılışta veritabanındaki değerleri tek seferde yüklemeye çalışması istenmiyorsa "lazy" olarak ayarlanabilir | eager |
    | `METRICS_ENABLED` | Metrik toplama özelliğinin açık olup olmadığı | false |

    <Warning>
    **HAZELCAST_OPERATION_RESPONSEQUEUE_IDLESTRATEGY**

    Eğer bu parametreyi "backoff" ayarlarsanız: Pod'un CPU limitinin %90-100'ünü sürekli kullanacaktır. Bu durum %5-10 performans artışı sağlayabilir ancak Cache pod'unun CPU kaynaklarının limitini tüketir.
    </Warning>

    <Info>
    **CACHE_QUOTA_TIMEZONE:**

    Cache'de günlük kota bilgileri de tutulmaktadır. Günlük kota bilgileri UTC timezone'a göre sıfırlanır. Eğer günlük değişen kotanın başlangıç zamanını kendi yerel saatinize göre sıfırlanmasını istiyorsanız ek değişkenlere `CACHE_QUOTA_TIMEZONE` değerini ekleyebilirsiniz. Buraya eklenen değerin "+03:00" şeklinde yazılması gereklidir.
    </Info>

    <Info>
    **CACHE_LAZY_MODE:**

    Cache pod'larının ilk açılışta veritabanındaki değerleri tek seferde yüklemeye çalışması istenmiyorsa `CACHE_LAZY_MODE` değeri "lazy" olarak eklenebilir. Bu durumda öncelik pod'un açılmasına verilir ve değerler pod açıldıktan sonra da yüklenmeye devam edebilir. Veritabanında yüksek miktarda kayıt varsa bu değerin girilmesi önerilir.
    </Info>
  </Accordion>
</AccordionGroup>

## Host Takma Adlarını Ayarlama

### Host Takma Ad (Host Alias) Nedir? Neden ihtiyaç duyulur?

Ağda bulunan IP adresleri bazen host isimleri arkasına konulabilir. Bunlar eğer nameserver ya da host dosyasına tanımlanmamışsa ya da bir şekilde Apinizer'ın bunları çözmesi sağlanamamışsa, worker pod'ların bu isimleri çözmesi için Host Alias tanımı yapılmalıdır.

Kubernetes üzerinde host adları ya da bunlara karşılık gelen IP adreslerine, takma host isimleri verilebilir. Bu ayar, deployment.yaml dosyası içinde tanımlanır.

<Warning>
Burada yapılan değişikliklerin etkinleşmesi için republish işlemi gerekmektedir. Versiyon güncellemesine nazaran bu işlemde bir kaç dakikalık kesinti olacağına dikkat edilmelidir.
</Warning>

**Örnek Kullanım:**

| IP Address | Host Aliases |
|------------|--------------|
| 10.10.10.10 | alias_name, other_alias_name |

Host takma adı ayarlarını içeren görsele aşağıda yer verilmiştir:
<img
  src="/images/yonetici/host-takma-adi.png"
  alt="Host Takma Adı Ayarları"
  width="1000"
  height="600"
/>


## Ortam Yayımlama

<Steps>
  <Step title="Yayınlanmamış Ortamı Seç">
    Bir ortam yayımlamak için **Yayınlanmamış** (Unpublished) butonuna tıklanır.
    <img
      src="/images/yonetici/step-1.png"
      alt="Yayınlanmamış Ortam Seçimi"
      width="600"
      height="400"
    />
  </Step>

  <Step title="İşlemi Onayla">
    Gelen pencereden işlemi onaylamak için **Yayınla** (Publish) butonuna tıklanır ve ortam kubernetes sunucusuna dağıtılır .
     <img
          src="/images/yonetici/step2.png"
          alt="Ortam Yayımlama Onayı"
          width="600"
          height="400"
        />
  </Step>
</Steps>

## Ortam Yeniden Yayınlama

<Steps>
  <Step title="Yayınlanmış Ortamı Seç">
    Yayımlanmış durumda olan bir ortamın üzerine gelerek **Yayınlanmış** (Published) butonuna tıklanır.
     <img
              src="/images/yonetici/step3.png"
              alt="Yayınlanmış Ortam Seçimi"
              width="600"
              height="400"
            />
  </Step>

  <Step title="Yeniden Yayınla">
    Gelen pencereden işlemi onaylamak için **Yeniden Yayınla** (Republish) butonuna tıklanır.
     <img
              src="/images/yonetici/step4.png"
              alt="Ortam Yeniden Yayımlama Onayı"
              width="600"
              height="400"
            />
  </Step>
</Steps>

<Info>
Ortam Yeniden Yayınla işleminden sonra, Pod'lar da yeniden başlatılır (restart).
</Info>

<Warning>
Burada yapılan değişikliklerin etkinleşmesi için republish işlemi gerekmektedir. Versiyon güncellemesine nazaran bu işlemde bir kaç dakikalık kesinti olacağına dikkat edilmelidir.
</Warning>

## JWT Token Doğrulama Anahtarı

Ortam kaydedilmiş ise JWT Token Doğrulama Anahtarı üretilmiştir. Bu token, kimlik doğrulama politikaları için Apinizer Token Servisi üzerinden token üretmede yer alan private key'in değeridir. Eğer kullanıcı kendi token'ını üretmek isterse buradaki private key'den faydalanmalıdır.

Bu bilgilere erişmek için **JWT Token Doğrulama Anahtarı** (JWT Token Validation Keys) tabına gidilir.

**Kullanılabilir İşlemler:**

- **Redeploy:** Mevcut anahtarın değişiklik yapılmadan sunuculara tekrar yüklenmesi
- **Regenerate & Deploy:** Yeni anahtar üretilip sunuculara yüklenmesi
- **Upload & Deploy:** PEM Encoded Private Key dosyası yüklenerek yeni anahtar üretilmesi
 <img
              src="/images/yonetici/jwt-token.png"
              alt="JWT Token Doğrulama Anahtarı"
              width="1000"
              height="600"
            />

## Ortam (Environment) Silme

Ortam seçerek, en altta bulunan **Ortam Sil** (Remove Environment) tabından **Ortam Sil** (Remove Environment) diyerek ortam ile ilgili bilgileri veritabanından silinmiş olur.

 <img
              src="/images/yonetici/environment-silme.png"
              alt="Ortam Silme"
              width="1000"
              height="600"
            />
<Danger>
**Dikkat:** Silme işlemi tamamlandığında bu ortamda kayıtlı tüm API Proxy'lerin yüklemesi de silinir ve bu ortama daha önceden yüklenmiş olan API Proxy'lere bu ortam üzerinden artık erişilemez.
</Danger>

## Önbellek Monitörü

API Proxy ekranının Genel Bilgi sekmesinde Cache bölümündeki ayarlar ile istek, önbelleğe alınarak, Backend API'ye gitmeden yanıtlanabilir. Aynı zamanda kota ve darboğaz (quota ve throttle) politikaları da cache pod'u üzerinden yönetilmektedir.

Ortam bazlı olarak önbellek işlemlerini izlemek, detayları görmek ve silmek için ortamın **Önbellek** (Cache) linkinden bu sayfaya gidilir.
<img
              src="/images/yonetici/on-bellek.png"
              alt="Önbellek Monitörü"
              width="800"
              height="500"
            />

Önbellek Monitörünü içeren görsele aşağıda yer verilmiştir:
<img
              src="/images/yonetici/on-bellek2.png"
              alt="Önbellek Monitörü Detay"
              width="1000"
              height="600"
            />


## Metrik Monitörü

Kubernetes üzerindeki Worker ve Cache pod'larının durumunu izlemek için ortam listesinden ilgili ortamın **Podlar** (Pods) linkine tıklanır.
Podlar ekranını içeren görsele aşağıda yer verilmiştir:

<img
              src="/images/yonetici/metrik.png"
              alt="Metrik Monitörü"
              width="1000"
              height="600"
            />

<Info>
Eğer tüm ortamların metriklerine erişmek isterseniz [tüm ortam metrikleri sayfasına](/tr/admin/server-management/kubernetes-resources) tıklayınız.
</Info>

