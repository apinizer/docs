---
title: "Trace"
description: "You can track step by step how requests coming to API Proxies are processed. You can start trace, monitor policy-based execution, perform request/response inspection, and perform performance analysis. You can view detailed log records for debug and error detection."
---

Tracing enables you to monitor and analyze your API Proxy message processing flow in real-time. Trace operations are performed **on an API Proxy basis** and are activated separately for each API Proxy.

This module is particularly used for:

- Understanding how policies work
- Detecting performance issues  
- Debugging
- Examining request/response flow
- Validating transformations

<CardGroup cols={2}>
  <Card title="API Proxy-Based Trace" icon="play">
    You can start a separate trace session for each API Proxy
  </Card>
  <Card title="Detailed Tracking" icon="magnifying-glass">
    You can track each policy's execution step by step and view log records
  </Card>
  <Card title="Performance Analysis" icon="gauge">
    You can analyze timing metrics and detect bottlenecks
  </Card>
  <Card title="Debugging" icon="bug">
    You can easily detect errors and perform root cause analysis
  </Card>
</CardGroup>

<Info>
Trace operations are performed on an API Proxy basis. For detailed application steps, you can refer to the [Step-by-Step Tracking](/en/develop/monitoring-analysis/step-by-step-tracking) page.
</Info>

## Starting Trace Mode

Trace mode is started separately for each API Proxy. You can activate trace mode from the API Proxy's own page.

### Prerequisites

Before starting trace mode:

<Steps>
  <Step title="API Proxy Must Be Loaded">
    The API Proxy you want to track must be loaded into at least one [Environment](/en/concepts/core-concepts/environment)
  </Step>
  <Step title="Go to API Proxy Page">
    Go to the detail page of the API Proxy you want to trace
  </Step>
  <Step title="Make Environment Selection">
    Select the Environment for which trace mode will be opened from the Environments where the API Proxy is loaded
  </Step>
  <Step title="Click Start Button">
    Activate trace mode by clicking the **Start** button
  </Step>
</Steps>

  <img
    src="/images/develop/izleme-analiz/trace-start.png" 
    alt="Activating Trace Mode"
    width="1000"
    style={{ borderRadius: '0.5rem' }}
  />


<Tip>
With **Custom Query** from the filter field next to environment selection, you can specifically trace only desired data.
</Tip>

<Warning>
When trace mode is activated:
- Log record content is expanded to allow detailed examination
- Log records are written to MongoDB configuration database
- Detailed log records are created for all executed policies
- This continues to be stored until the mode is stopped or automatically closed by the platform after **5 minutes**
</Warning>

## Trace Records

After trace mode is activated, requests coming to the API Proxy are automatically tracked and detailed records are created.

  <img
    src="/images/develop/izleme-analiz/trace-logs.png" 
    alt="Trace Log Records"
    width="1000"
    style={{ borderRadius: '0.5rem' }}
  />


<Info>
Log records being displayed are not automatically updated. Use the **Refresh Logs** button to see new records.
</Info>

Each log record shown in the table belongs to the request coming from the client to this API Proxy and the response message given to that request.

<Info>
Since the log record of API Call Policy is kept separately, double logs appear for the same request. The first is the before and after state of the message in the main flow, and the second is the request and response message coming out of the API Call.
</Info>

### Trace List

The following information is displayed for each record in the trace list:

| Information | Description |
|-------|----------|
| **Timestamp** | Date and time when the request arrived |
| **Method** | HTTP method (GET, POST, PUT, DELETE, etc.) |
| **Path / Endpoint** | Request path and endpoint name |
| **Status Code** | Response status code (200, 404, 500, etc.) |
| **Duration** | Total processing time (ms) |
| **Policies** | Number of policies executed |
| **Correlation ID** | Request-specific correlation ID |

<Note>
When API Call Policy is used, double log records appear for the same request:
1. Before and after state of the message in the main flow
2. Request and response message coming out of the API Call
</Note>

### Trace Operations

The following operations can be performed for each trace record:

<Tabs>
  <Tab title="Detailed Viewing">
    The first button at the end of the row of the request message to be examined opens a window that displays the log records of that message.

      <img
        src="/images/develop/izleme-analiz/trace-detailed-view-button.png"
        alt="Detailed View Button"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    In the opened window, logs are divided into sections related to message flow. When the name of the section to be examined is clicked, log records related to that area are displayed. By default, the **Overview** section is open.

      <img 
        src="/images/develop/izleme-analiz/trace-detailed-view-dialog.png" 
        alt="Detailed View Dialog"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />

  </Tab>
  
  <Tab title="JSON Format Viewing">
    The button next to the Detailed View button displays log records in JSON format.

      <img 
        src="/images/develop/izleme-analiz/trace-json-view.png" 
        alt="JSON Viewing"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />



      <img 
        src="/images/develop/izleme-analiz/trace-json-dialog.png" 
        alt="JSON Dialog"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    <Info>
    Key values in JSON view are written in readable format. For example:
    - The "apiProxyId" value is stored as "api" in the log record
    - For actual log format, you can refer to the [API Traffic Log Record Data Structure](/en/analytic/api-traffic-log-record-data-structure) page
    </Info>
  </Tab>
  
  <Tab title="Download">
    When Apinizer is in step-by-step tracking mode, it also creates detailed log records for all policies executed for the API Proxy. The download option provides the ability to download all log records created on a request basis collectively.

      <img 
        src="/images/develop/izleme-analiz/trace-download.png" 
        alt="Download"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    <Tip>
    If the data size of the log record is greater than 500KB, the **Show Details** and **View in JSON Format** options are disabled. In this case, the record must be downloaded for examination.
    </Tip>
  </Tab>
  
  <Tab title="Quick Test">
    The Quick Test button on the relevant row opens the [Test Console](/en/develop/test-debug-tools/test-console) formatted so that the sent request can be immediately retested and sent.

      <img 
        src="/images/develop/izleme-analiz/trace-quick-test.png" 
        alt="Quick Test"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    <Warning>
    The Quick Test button must be enabled in general settings to appear.
    </Warning>
  </Tab>
</Tabs>

## Tracking Policy Flow

Click the **Select** button to view the detailed log records kept by Apinizer for policies executed for the API Proxy while in step-by-step tracking mode.

  <img 
    src="/images/develop/izleme-analiz/trace-select.png" 
    alt="Selection"
    width="1000"
    style={{ borderRadius: '0.5rem' }}
  />


When this button is clicked, a new section opens below the table containing log records. This section shows all policies executed for the selected message, including those coming from [API Proxy Group](/en/concepts/core-concepts/api-proxy-group) if any, in the order they were executed.

Small icons are located next to each policy and Backend API to show whether that step was executed successfully. Thus, if the message flow did not occur as expected, it is visible which policy caused the problem.

<Tabs>
  <Tab title="Successful Flow">
    Situation where all policies are executed successfully:
    
      <img 
        src="/images/develop/izleme-analiz/trace-successful-flow.png" 
        alt="Successful Policy Flow"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />

  </Tab>
  
  <Tab title="Failed Flow">
    Situation where Authentication policy failed:
    
      <img 
        src="/images/develop/izleme-analiz/trace-failed-flow.png" 
        alt="Failed Policy Flow"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    <Warning>
    The third policy that should be executed after Authentication policy is not visible. Because with the failure of Authentication, the message flow was interrupted and an error response was returned to the client.
    </Warning>
  </Tab>
</Tabs>

### Policy Execution Details

<AccordionGroup>
  <Accordion title="Pre-flow Policies" icon="play">
    Policies executed first when a request arrives:
    - **Policy Name**: Name of the executed policy
    - **Execution Time**: Policy execution time (ms)
    - **Status**: Success / Failure status
    - **Changes**: Changes made by the policy to the message (header, body, variable changes)
    
    Examples: Authentication, rate limiting, IP control
  </Accordion>

  

  <Accordion title="Route Step (Routing)" icon="route">
    Routing step to Backend API:
    - **Selected Upstream**: Selected [upstream target](/en/concepts/core-concepts/routing-and-upstream)
    - **Load Balancing Decision**: Load balancing algorithm decision
    - **Connection Time**: Connection time to backend (ms)
    - **Backend Response Time**: Backend response time (ms)
    - **Retry/Failover**: Retry or failover status
  </Accordion>

  <Accordion title="Post-flow Policies" icon="arrow-left">
    Policies executed after response comes from backend:
    - **Policy Name**: Name of the executed policy
    - **Execution Time**: Policy execution time (ms)
    - **Status**: Success / Failure status
    - **Changes**: Changes made to the response message
    
    Examples: Response transformation, cache writing, logging
  </Accordion>

  <Accordion title="Fault Handler" icon="triangle-exclamation">
    Policies executed in case of error:
    - **Error Type**: Error type (authentication, routing, policy, etc.)
    - **Error Message**: Error message
    - **Handler Policies**: Executed error handler policies
    - **Final Response**: Final response returned to client
    
    <Info>
    Fault Handler only runs when an error occurs and allows you to customize the error response.
    </Info>
  </Accordion>
</AccordionGroup>

## Detailed Log Records

The section displayed when a log record is selected presents a summary of whether the message flow was successful and, if it failed, at which point it occurred.
 <img
    src="/images/develop/izleme-analiz/trace-detailed-logs.png" 
    alt="Detailed Log Records"
    width="1000"
    style={{ borderRadius: '0.5rem' }}
  />


The following links can be used to view detailed log records:

<Tip>
Detailed log records allow you to track each step of the message flow and quickly identify the source of problems.
</Tip>

<AccordionGroup>
  <Accordion title="1 - Client Log Records">
    **Client** is a link. When clicked, a window opens where details of messages going from and returning to the client can be viewed.

    **Details of the HTTP message sent by the client:**

      <img 
        src="/images/develop/izleme-analiz/trace-client-logs-1.png" 
        alt="Client Log 1"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    **Details of the message sent from client to API Proxy:**

      <img 
        src="/images/develop/izleme-analiz/trace-client-logs-2.png" 
        alt="Client Log 2"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    **Details of the message returned from API Proxy to client:**

      <img 
        src="/images/develop/izleme-analiz/trace-client-logs-3.png" 
        alt="Client Log 3"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />

  </Accordion>

  <Accordion title="2, 4 - Policy Log Records">
    When a policy icon in region 2 is clicked or the arrow next to the relevant policy in region 4 is clicked, log records showing the message content coming to and going from that policy are opened.

      <img 
        src="/images/develop/izleme-analiz/trace-policy-logs.png" 
        alt="Policy Log Records"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />

  </Accordion>

  <Accordion title="3 - Backend API Log Records">
    **API** is a link. When clicked, a window opens where details of messages coming to and returning from the Backend API can be viewed.

    **Details of the message coming from API Proxy:**

      <img 
        src="/images/develop/izleme-analiz/trace-backend-logs-1.png" 
        alt="Backend API Log 1"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    **Backend API routing details** *(for routing options, you can refer to the [HTTP Routing](/en/develop/routing/http-routing) page)*:

      <img 
        src="/images/develop/izleme-analiz/trace-backend-logs-2.png" 
        alt="Backend API Log 2"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />


    **Details of the message returned from Backend API to API Proxy:**

      <img 
        src="/images/develop/izleme-analiz/trace-backend-logs-3.png" 
        alt="Backend API Log 3"
        width="1000"
        style={{ borderRadius: '0.5rem' }}
      />

  </Accordion>
</AccordionGroup>


### Request/Response Comparison

Trace mode shows how the message changes along the flow:

<CardGroup cols={2}>
  <Card title="Before/After" icon="code-compare">
    You can compare the before and after state of the message for each policy
  </Card>
  <Card title="Transformation Analysis" icon="wand-magic-sparkles">
    You can see the effect of transformation policies
  </Card>
  <Card title="Header Changes" icon="file-lines">
    You can see added, modified, or deleted headers
  </Card>
  <Card title="Body Changes" icon="file-code">
    You can see JSON/XML transformations and content changes
  </Card>
</CardGroup>

## Performance Analysis

Trace mode provides detailed timing metrics to detect performance issues.

### Timing Metrics

The following metrics are displayed for each trace record:

| Metric | Description |
|--------|----------|
| **Total Duration** | Total entry-exit time of the request (ms) |
| **Pre-flow Duration** | Total execution time of pre-flow policies |
| **Route Duration** | Connection to backend and response receiving time |
| **Backend Duration** | Backend API response time (net) |
| **Post-flow Duration** | Total execution time of post-flow policies |
| **Gateway Overhead** | Time added by Apinizer Gateway (Total - Backend) |

<Tip>
If **Gateway Overhead** is high, policy optimization can be done. If **Backend Duration** is high, backend API should be optimized.
</Tip>

### Policy Performance Analysis

To analyze policy performance:

<CardGroup cols={2}>
  <Card title="Slowest Policies" icon="turtle">
    You can identify and optimize policies taking the longest time
  </Card>
  <Card title="Policy Count" icon="hashtag">
    You can see the total number of policies executed, remove unnecessary policies
  </Card>
  <Card title="Average Policy Duration" icon="gauge">
    You can monitor the average execution time of each policy
  </Card>
  <Card title="Policy Execution Order" icon="list-ol">
    You can improve performance by changing the order of policies
  </Card>
</CardGroup>

**Optimization Recommendations:**

- **Cache Policy**: Use cache to reduce backend calls
- **Conditional Flow**: Conditionally skip unnecessary policies
- **Script Optimization**: Optimize slow operations in script policies
- **Transformation**: Remove unnecessary transformations

### Backend Performance Metrics

To monitor backend API performance:

| Metric | Description |
|--------|----------|
| **Connection Time** | TCP connection time to backend server |
| **SSL Handshake Time** | SSL handshake time for HTTPS connection |
| **Response Time** | Backend response generation time |
| **Total Backend Time** | Connection + Response total time |
| **Backend Status** | Success status of backend call |
| **Retry/Failover Count** | Number of retries or failovers performed |

<Warning>
High **Connection Time** indicates that the backend server is slow or has network issues. High **Response Time** indicates that the backend API needs to be optimized.
</Warning>


## Use Cases

### Scenario 1: Performance Issue Detection

**Situation:** Response times of an API Proxy are higher than expected.

<Steps>
  <Step title="Start Trace">
    Activate trace mode from the API Proxy page
  </Step>
  <Step title="Examine Slow Requests">
    Find slow requests (e.g., >1000ms) in trace records
  </Step>
  <Step title="Examine Policy Flow">
    View policy flow with Select button and identify slowest policies
  </Step>
  <Step title="Detect Bottlenecks">
    - Is backend API slow? → Backend should be optimized
    - Are policies slow? → Script/transformation should be optimized
    - Is database query slow? → Cache can be used
  </Step>
  <Step title="Perform Optimization">
    Fix detected issues and test again with trace
  </Step>
</Steps>

### Scenario 2: Debugging

**Situation:** Some requests return 500 error and the cause is unknown.

<Steps>
  <Step title="Start Trace">
    Activate trace mode from the API Proxy page
  </Step>
  <Step title="Find Failed Requests">
    Find 5xx errors in trace records
  </Step>
  <Step title="Find Policy Where Error Occurred">
    View policy flow with Select button and find the red-marked policy
  </Step>
  <Step title="Examine Policy Details">
    - Examine the message coming to the policy (Before)
    - Read the error message
    - Examine detailed log records
  </Step>
  <Step title="Perform Root Cause Analysis">
    - Is data format wrong?
    - Is header missing?
    - Is it a script error?
    - Is backend unreachable?
  </Step>
  <Step title="Fix and Test">
    Fix the issue and test again with trace
  </Step>
</Steps>

### Scenario 3: Transformation Validation

**Situation:** Checking if JSON to XML transformation works correctly.

<Steps>
  <Step title="Start Trace">
    Activate trace mode from the API Proxy page
  </Step>
  <Step title="Send Test Request">
    Send a sample JSON request from Test Console
  </Step>
  <Step title="Select Transformation Policy">
    View policy flow with Select button and click on transformation policy
  </Step>
  <Step title="Compare Before/After">
    - Before: Incoming JSON message
    - After: Converted XML message
    - Check if the transformation is correct
  </Step>
  <Step title="Check Message Going to Backend">
    Verify in Backend API log records that the outgoing message is in XML format and correct
  </Step>
</Steps>

### Scenario 4: Conditional Flow Testing

**Situation:** Testing if conditional policies work correctly.

<Steps>
  <Step title="Start Trace">
    Activate trace mode from the API Proxy page
  </Step>
  <Step title="Send Requests for Different Conditions">
    - Request for premium user
    - Request for normal user  
    - Request for guest
  </Step>
  <Step title="Examine Trace for Each Request">
    View policy flow with Select button and see which policies ran
  </Step>
  <Step title="Check Condition Evaluation">
    - What was the condition expression?
    - What was the evaluation result?
    - Did the correct policies run?
  </Step>
  <Step title="Fix Conditions if Necessary">
    Fix incorrect conditions and test again with trace
  </Step>
</Steps>

## Best Practices

### Trace Usage

<CardGroup cols={2}>
  <Card title="Use Frequently in Development Environment" icon="laptop-code">
    - Trace continuously during development
    - Always test with trace when adding new policies
    - Validate API changes with trace
  </Card>
  <Card title="Be Careful in Production" icon="shield-halved">
    - Activate trace in production only when necessary
    - Trace automatically closes after 5 minutes
    - Consider performance impact
  </Card>
  <Card title="Use Custom Query" icon="filter">
    - Filter with Custom Query from the filter field next to environment selection
    - Trace only relevant endpoints
    - Minimize unnecessary trace records
  </Card>
  <Card title="Use on API Proxy Basis" icon="server">
    - Start trace separately for each API Proxy
    - Activate trace mode from the relevant API Proxy's page
    - Trace records are stored in MongoDB
  </Card>
</CardGroup>

### Performance Monitoring

<Warning>
**Create Performance Baseline:**
- Measure average response time of API under normal conditions
- Record average execution time of each policy
- Monitor deviations from baseline and set alarms
</Warning>

**Regular Monitoring:**
- Run performance trace once a week
- Perform trend analyses
- Detect slowdowns early

**Optimization Cycle:**
1. Detect bottlenecks with trace
2. Optimize
3. Validate improvement with trace
4. Document results

### Debugging

<Tip>
**Repeatable Test Scenarios:**
- Prepare test scenarios before starting trace
- Get consistent results using the same test data
- Test edge cases
</Tip>

**Systematic Approach:**
1. Isolate the problem (which endpoint, under which condition?)
2. Collect detailed information with trace
3. Perform root cause analysis
4. Fix
5. Validate with trace
6. Document the process

**Before/After Comparison:**
- Compare input/output messages for each policy
- Detect unexpected changes
- Check transformation correctness

## Related Resources

<CardGroup cols={2}>
  <Card title="Step-by-Step Tracking" icon="magnifying-glass" href="/en/develop/monitoring-analysis/step-by-step-tracking">
    API Proxy-based trace operations
  </Card>
  <Card title="Test Console" icon="terminal" href="/en/develop/test-debug-tools/test-console">
    API test and debug console
  </Card>
  <Card title="Policy Management" icon="shield" href="/en/develop/api-proxy-configuration/policy-management">
    Managing and configuring policies
  </Card>
  <Card title="API Traffic Log Settings" icon="cog" href="/en/analytic/api-traffic-log-settings">
    Configuring log record settings
  </Card>
  <Card title="Message Processing and Policy Application" icon="arrow-progress" href="/en/concepts/core-concepts/message-processing-and-policy-application">
    Information about message flow and policy execution
  </Card>
  <Card title="Conditional Policy Execution" icon="code-branch" href="/en/concepts/core-concepts/conditional-policy-execution">
    Detailed information about conditional flow
  </Card>
</CardGroup>


