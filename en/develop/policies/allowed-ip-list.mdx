---
title: "Allowed IP List"
description: "You can accept requests only from specified IP addresses, IP groups, or geographic locations, and block all other requests"
---

<Tip>
This document explains the detailed usage of a specific policy. If you are using Apinizer policies for the first time or want to learn the general working principles of policies, we recommend reading the [What is Policy?](/en/concepts/core-concepts/what-is-policy) page first.
</Tip>

## Overview

### What is its Purpose?

- **Increase Access Security**: Ensures that services provided through API Gateway are accessed only from trusted IP addresses.
- **Block Unauthorized Access**: Minimizes security vulnerabilities by automatically rejecting requests from sources not on the whitelist.
- **Apply Geographic Restrictions**: Creates geography-based security policies by accepting or blocking requests from specific countries and cities.
- **Centralized IP Management**: Makes the same IP sets reusable in different policies using IP groups.
- **Dynamic IP Management**: Provides the ability to dynamically change IP list at runtime with Variable mechanism.

### Working Principle

1. **Request Arrival**: For each HTTP/HTTPS request arriving at the API Gateway, the client's source IP address is identified.
2. **Policy Check**: If the IP Whitelist policy is active, the system checks in the following order:
   - Is a Condition defined? If so, is the condition met?
   - Is the policy active (active=true)?
   - Is a Variable being used or is Apinizer default?
3. **IP Verification**: It is checked whether the client IP address matches one of these sources:
   - Manually defined IP list (ipList)
   - IPs in IP Groups (ipGroupIdList)
   - Geolocation settings (geoLocationDataList)
4. **Decision Making**:
   - **Match Found**: Request is forwarded to the next policy step or backend service.
   - **No Match**: Request is rejected and customized error message is returned (default: 403 Forbidden).
5. **Error Handling**: Customizable HTTP status code and error message are returned for requests that do not comply with the policy rule.

## Features and Capabilities

### Basic Features

- **Manual IP List Management**: Define IP ranges with IPv4 addresses and CIDR notation (e.g., 192.168.1.0/24). Each IP address can be added separated by commas and real-time verification is performed.
- **IP Group Integration**: Add predefined IP groups to the policy. Ability to select and manage multiple IP groups simultaneously. IP groups are updated centrally and automatically reflected in the policy.
- **Global and Local Policy Support**: Can be defined globally and used in multiple API Proxies or configured as a local policy for a specific API Proxy.
- **Active/Passive Status Control**: Easily change the active or passive status of the policy (active/passive toggle). In passive mode, the policy is not applied but its configuration is preserved.
- **Condition-Based Application**: Determine when the policy will be applied by creating complex conditions with Query Builder (e.g., only for specific endpoints or header values).

### Advanced Features

- **Geolocation (Geographic Location) Support**: IP control by country and city through Geolocation service integration. Accept/block requests from entire country or specific cities. Ability to define multiple country and city combinations.
- **Variable Mechanism**: Dynamically change IP list at runtime using Variable. Get IP list from external systems (database, cache, API). Options to merge or override with Variable.
- **Error Message Customization**: Customize HTTP status code (default: 403). Define custom JSON or XML error messages. Configure different messages for different error scenarios.
- **Export/Import Feature**: Export policy configuration as a ZIP file. Import to different environments (Development, Test, Production). Version control and backup capability.
- **Policy Group and Proxy Group Support**: Manage multiple policies within Policy Group. Bulk policy assignment to Proxy Groups. Centralized update and deploy operations.
- **Deploy and Versioning**: Deploy policy changes to live environment. See which API Proxies use it (Policy Usage). Proxy Group and Policy Group usage reports.

## Usage Scenarios

| Scenario | Status | Solution (Policy Application) | Expected Behavior / Result |
|----------|--------|-------------------------------|---------------------------|
| Corporate Network Access | Only access from corporate network (192.168.0.0/16) should be allowed to APIs | Add `192.168.0.0/16` CIDR block to IP list. Assign policy to relevant API Proxy locally or globally. | Only requests from 192.168.x.x network are accepted. Other IPs return 403 error. |
| Third-Party Integration | Allow requests from specific partner company's fixed IPs (203.0.113.10, 203.0.113.11) | Add `203.0.113.10` and `203.0.113.11` addresses to IP list. Create "Partner IP Group" and reuse if needed. | Only requests from partner IPs are accepted. Integrations work securely. |
| Geographic Restriction | Only accept requests from Turkey (TR) | Enable Geolocation settings. Select Turkey from "Select Country" list and add to policy. | If client IP does not belong to Turkey geography, 403 error is returned. TR IPs are accepted. |
| City-Based Access | Accept requests only from Istanbul and Ankara cities | Select Turkey from Geolocation section. Select Istanbul and Ankara from city list. Click "Add" button. | Only IPs from Istanbul and Ankara cities are accepted. Other cities are rejected. |
| Development/Test Environment | Allow access only from QA team IPs in test environment | Create an IP Group named "QA Team IPs". Add this group to policy. Make global policy specific to test environment. | QA team can access test APIs. Different policy is applied in production environment. |
| Dynamic IP Management | IP list changes regularly (daily updates) | Use Variable mechanism. Feed Variable from external system (database, API). Close "Use Apinizer Default" in policy and select variable. | Current IP list is retrieved from variable when each request arrives. Manual update not required. |
| Emergency Access | Always accept requests from a specific critical IP | Add critical IP to manual IP list. Add emergency header check in condition section (optional). | Critical IP always has access. Policy can be bypassed in emergencies. |

## Configuring Policy Parameters

In this step, users can **create a new policy** or **configure existing policy parameters** to define access rules. The defined parameters directly affect how the policy works (e.g., which IPs will be allowed, geographical restrictions, conditional activations, etc.). This allows the policy to be customized according to organization-specific requirements while being centrally manageable.

### Creating a New Allowed IP List Policy

<img src="/images/develop/politikalar/izin-verilen-ip-listesi-1.png" alt="Allowed IP List Policy Configuration" width="1000" />

#### Configuration Steps

| Step | Description / Operation |
|------|----------------------|
| **Step 1: Go to Creation Page** | - Go to **Development ‚Üí Global Settings ‚Üí Global Policies ‚Üí Allowed IP List** from the left menu.<br />- Click the **[+ Create]** button at the top right. |
| **Step 2: Enter Basic Information** | **Policy Status:** Shows Active/Passive status. New policies are active by default.<br /><br />**Name (Required):**<br />Example: `Production_IP_Whitelist`<br />- Enter a unique name, does not start with space.<br />- System automatically checks: Green checkmark: available Red X: existing name.<br /><br />**Description:**<br />Example: "Allows requests only from corporate internal and partner systems for Prod environment."<br />- Max. 1000 characters.<br />- Explain the purpose of the policy. |
| **Step 3: IP List Configuration** | **Use Apinizer Default:** ‚òëÔ∏è Uses default IP detection mechanism. You need to define your own variable (Variable).<br /><br />**Adding IP:**<br />- Single IP: `192.168.1.100` ‚Üí Added with Enter or ‚úì.<br />- CIDR: `192.0.2.0/24` ‚Üí Covers 192.0.2.0‚Äì192.0.2.255 range.<br />  /24 ‚Üí 256 IPs, /30 ‚Üí 4 IPs, /32 ‚Üí single IP.<br /><br />**Deleting IP:** Click on IP tag or ‚úï icon.<br /><br />Characters ('*' and '-') can be used to specify IP ranges.<br /><br />**Examples:**<br />- `10.0.0.1` ‚Üí Single IP<br />- `192.168.1.0/24` ‚Üí 256 IPs<br />- `172.16.0.0/12` ‚Üí 1,048,576 IPs<br />- `203.0.113.0/30` ‚Üí 4 IPs (.0-.3)<br />- `10.3.10.*` value specifies IPs between '10.3.10.0' and '10.3.10.255'.<br />- `10.3.10.4-18` value expresses IPs between '10.3.10.4' and '10.3.10.18' (4 and 18 included).<br /><br />Enter key must be pressed after adding IP. |
| **Step 4: IP Groups Usage (Optional)** | - Click "Click to add IP Groups" button.<br />- Existing IP groups appear on left, selected ones on right.<br /><br />**Adding:**<br />- Select group from left list ‚Üí [Select].<br />- Moves to right side.<br />- A group can be used in multiple policies.<br /><br />**Removing:**<br />- Click üóëÔ∏è icon in right list ‚Üí returns to left list.<br /><br />**Advantage:**<br />- Manage IP lists centrally.<br />- Single update reflects to all policies.<br />- Ideal for partner access. |
| **Step 5: Geographic Location Filter (Optional)** | - Select country from **Country** dropdown (example: Turkey).<br />- **City** dropdown becomes active when country is selected (example: Istanbul, Ankara, Izmir).<br />- Added to table with **[+ Add]**.<br />- Rows can be deleted individually with üóëÔ∏è or in bulk with top üóëÔ∏è.<br /><br />**Example Scenarios:**<br />- *Turkey only:* Country: Turkey, City: ‚Äî<br />- *Turkey major cities:* Istanbul, Ankara, Izmir, Bursa<br />- *Multiple countries:* Turkey (all), Germany (Berlin, Munich), USA (all) |
| **Step 6: Define Condition (Optional)** | - Go to **Condition** tab.<br />- Conditions determine when the policy will be active.<br /><br />**Examples:**<br />‚Ä¢ Environment-based: Header = X-Environment, Operator = Equals, Value = production<br />‚Ä¢ API Key-based: Header = X-API-Key, Starts With = PROD-<br />‚Ä¢ Endpoint-based: Path = /api/admin/*<br /><br />If no condition is defined, policy is always active.<br /><br /> |
| **Step 7: Customize Error Message (Optional)** | - Go to **Error Message Customization** tab<br />- Customize the message to be returned when access is denied.<br /><br />**Default:**<br />`{ "statusCode": 403, "message": "Access denied: IP not whitelisted" }`<br /><br />**Custom:**<br />`{ "statusCode": 403, "errorCode": "ACCESS_DENIED", "message": "You do not have permission to access this API.", "details": "Your IP address is not on the allowed list. Please contact support@company.com for access." }` |
| **Step 8: Save** | - Click the **[Save]** button at the top right.<br /><br />**Checklist:**<br />- Unique name<br />- Required fields filled<br />- At least one IP or group exists<br /><br />**Result:**<br />- Policy is added to the list.<br />- Can be connected to APIs.<br />- If global policy, automatically applied. |

For descriptions of **Conditions** and **Error Message Customization** panels, you can review the [Conditions](/en/concepts/core-concepts/what-is-policy#conditions) and [Error Message Customization](/en/concepts/core-concepts/what-is-policy#error-message-customization-error-message-customization) sections on the [What is Policy?](/en/concepts/core-concepts/what-is-policy) page.

## Deleting the Policy

For deletion steps of this policy and operations to be applied when in use, you can refer to the [Remove Policy from Flow](/en/develop/api-proxy-configuration/policy-management#remove-policy-from-flow) section on the [Policy Management](/en/develop/api-proxy-configuration/policy-management) page.

## Exporting/Importing the Policy

For export (Export) and import (Import) steps of this policy, you can refer to the [Export/Import](/en/admin/secrets-management/export-import) page.

## Connecting the Policy to API

For the process of how this policy will be connected to APIs, you can refer to the [Connect Policy to API](/en/develop/api-proxy-configuration/policy-management#add-policy-to-flow) section on the [Policy Management](/en/develop/api-proxy-configuration/policy-management) page.

## Advanced Features

| Feature | Description and Steps |
|---------|---------------------|
| **Dynamic IP Management with Variable** | - First create a Variable (from Variables menu). Variable type should be "String List" or "JSON".<br />- Feed Variable from external system (Database, Redis, API, etc.).<br />- Close "Use Apinizer Default" toggle in policy creation/editing page.<br />- Select relevant variable from **"Variable"** section.<br />- Save. Now IP list is read from variable when each request arrives.<br />- Does not require manual update, real-time IP list management. |
| **Centralized Management with IP Group** | - Create a new IP Group from IP Group menu (e.g., "Partner IPs").<br />- Add IPs to IP group (same logic, IPv4 and CIDR supported).<br />- Use this group in different IP Whitelist policies.<br />- Update IP Group (add/remove new IP).<br />- Changes automatically reflect to all policies using this group.<br /><br />**Advantage:** Using one IP set in multiple policies, updating from single point. |
| **Country-Based Blocking with Geolocation** | **Prerequisite:** Geolocation service must be activated from Geolocation Settings.<br />- Open country dropdown in **"Geolocation"** section on policy page.<br />- Select desired country (e.g., Germany).<br />- Click **[ Add ]** button without selecting city (applies to entire country).<br />- You can add multiple countries.<br /><br />**Advantage:** Geographic location-based access control without needing IP information |
| **City-Based Blocking with Geolocation** | - After selecting country, **"City"** dropdown becomes active.<br />- Select one or multiple cities (supports multi-select).<br />- Click **[ Add ]** button.<br />- Added cities appear in table format.<br /><br />**Example:** If "Turkey - Istanbul" and "Turkey - Ankara" are selected, only requests from these two cities are accepted.<br /><br />**Note:** Accuracy of city data depends on Geolocation provider. |
| **Conditional IP Control with Condition** | - Go to **"Condition"** tab on policy editing page.<br />- Create condition in Query Builder (e.g., `path='/admin' OR header.X-Admin-Request='true'`).<br />- IP control is performed when condition is met, policy is skipped if not met.<br />- Save.<br />- Special IP restriction for admin endpoints, no IP control for public APIs.<br /><br />**Advantage:** Different policy behaviors for different endpoints in the same API Proxy. |
| **Error Message Customization** | - Go to **"Error Message Customization"** tab.<br />- Select error type (e.g., "IP Not Whitelisted").<br />- Change HTTP Status Code (e.g., 401 instead of 403).<br />- Enter custom JSON message:<br />`{ "error": "Access Denied", "message": "Your IP address is not whitelisted", "code": "IP_NOT_ALLOWED" }`<br />- Add language-based messages (TR, EN).<br />- Save.<br /><br />**Advantage:** More meaningful error messages to users, custom error tracking. |
| **Policy Transfer with Export/Import** | **Export:**<br />- Select **[ Export ]** from "..." menu in policy list.<br />- ZIP file is downloaded (format: `DD-MMM-YYYY-policy-[name]-export.zip`).<br /><br />**Import:**<br />- Click **[ Import ]** button on list page.<br />- Select exported ZIP file.<br />- Configure import settings (override, new name, etc.).<br />- Complete import process.<br /><br />**Advantage:** Policy transfer between Development ‚Üí Test ‚Üí Production environments, backup. |
| **Bulk Management with Policy Group** | - Create a new group from **"Policy Group"** menu.<br />- Add multiple policies including IP Whitelist policy to group.<br />- Assign Policy Group to one or multiple API Proxies.<br />- All policies in group are applied in bulk.<br /><br />**Advantage:** Managing multiple policies as package, bulk deploy. |

## Tips and Best Practices

### Things to Do and Best Practices

| Category | Description / Recommendations |
|----------|----------------------------|
| **IP Format and Definition** | **Bad:** `192.168.1` (incomplete format)<br />**Good:** `192.168.1.100` (full IPv4 address)<br />**Best:** `192.168.1.0/24` (IP range with CIDR, 254 addresses with single definition) |
| **IP Group Usage** | **Bad:** Manually adding same IP list in each policy<br />**Good:** Defining IP group once<br />**Best:** Categorizing and grouping relevant IPs (e.g., "Partner IPs", "Office IPs", "QA Team IPs") |
| **Global vs Local Policy Selection** | **Bad:** Creating separate local IP Whitelist policy for each API Proxy<br />**Good:** Using global policy as common security policy<br />**Best:** Using global for general rules, local policy for special cases |
| **Geolocation Usage** | **Bad:** Manually adding all country IP blocks<br />**Good:** Activating Geolocation service<br />**Best:** Providing precise control using country and city combinations |
| **Dynamic Management with Variable** | **Bad:** Updating policy on every IP change<br />**Good:** Getting IP list from external system using Variable<br />**Best:** Caching Variable in Redis/Database for high performance |
| **Error Message Customization** | **Bad:** Using default 403 error<br />**Good:** Making detailed explanation with custom JSON message<br />**Best:** Different messages for different error scenarios, adding log ID |
| **Policy Naming** | **Bad:** Ambiguous names like `policy1`, `ipwhite`<br />**Good:** Descriptive names like `IP_White_List_Production`<br />**Best:** `[ENV]_[Purpose]_IP_White` format (e.g., `PROD_Partner_API_IP_White`) |
| **Condition Usage** | **Bad:** Applying same IP restriction to all endpoints<br />**Good:** Separating public and private endpoints<br />**Best:** Special IP control for `/admin/*` paths with Condition, no IP control for `/public/*` paths |

### Security Best Practices

| Security Area | Description / Warnings |
|---------------|----------------------|
| **Least Privilege Principle** | **Critical:** Add only truly necessary IPs to IP Whitelist. **Absolutely** avoid using wide CIDR blocks (e.g., `0.0.0.0/0`).<br />**Recommendation:** Use /32 (single IP) or at most /24 (256 IPs). |
| **IP Spoofing and Proxy Security** | **Warning:** If there is a Load Balancer or Reverse Proxy in front of API Gateway, correctly configure `X-Forwarded-For` or `X-Real-IP` headers to get real client IP.<br />**Risk:** Risk of bypassing whitelist with IP spoofing. |
| **Geolocation Reliability** | **Note:** Geolocation services are not 100% accurate. Can be bypassed with VPN and Proxy usage.<br />**Recommendation:** Use Geolocation not alone, but together with other security layers (JWT, API Key, etc.). |
| **Variable Security** | **Security Risk:** If Variable content comes from external system, ensure security of that system.<br />**Recommendation:** Apply authentication, encryption, and access control for Variable datasource. |
| **Error Message Information Leakage** | **Caution:** Do not provide information about system architecture or internal IPs in error messages.<br />**Bad:** "Your IP 203.0.113.5 is not in whitelist. Allowed range: 192.168.1.0/24"<br />**Good:** "Access denied. Your IP address is not authorized." |
| **Regular Update and Review** | **Best Practice:** Regularly review IP Whitelist (e.g., monthly).<br />**Action:** Remove unused, old partner IPs. Update changed IPs. Check audit logs. |
| **Multi-Factor Security** | **Recommendation:** Do not use IP Whitelist as single security layer.<br />**Best Practice:** Use combination of IP control + API Key/JWT + Rate Limiting. |
| **Production Environment Isolation** | **Critical:** Create separate global policy for Production environment. **Never** add Test/Development environment IPs to production policy.<br />**Recommendation:** Use environment-based Policy Group. |

### Things to Avoid

| Category | Description / Warnings |
|----------|----------------------|
| **Using Wide CIDR Blocks** | **Why to avoid:** Wide blocks like `10.0.0.0/8` can cover millions of IPs and increase security risk.<br />**Alternative:** Use specific subnets (e.g., `10.10.50.0/24`). Add needed IPs one by one or with small CIDR blocks. |
| **Not Defining Fallback When Using Variable** | **Why to avoid:** All requests may be blocked if Variable service is down or returns empty.<br />**Alternative:** Use Variable + Manual IP list together. Add fallback configuration to manual list if Variable cannot be read. Set up monitoring and alerting. |
| **Leaving Policy in Passive State** | **Why to avoid:** Passive policy is not applied to traffic, security vulnerability may occur if forgotten.<br />**Alternative:** Make passive temporarily for short time to test. Activate or delete after test is complete. |
| **Providing IP Information in Error Message** | **Why to avoid:** Showing client's or allowed IPs in error message gives information to attackers.<br />**Alternative:** Use general error messages: "Access denied" or "Unauthorized". Keep detailed logs only on server side. |
| **Complicating Management with Local Policy** | **Why to avoid:** Creating separate local IP Whitelist policy for each API Proxy complicates management and creates inconsistency in IP updates.<br />**Alternative:** Use global policy. Create local policy only for API Proxies with truly different IP requirements. |
| **Over-Reliance on Geolocation** | **Why to avoid:** Geographic location can be bypassed with VPN, Tor, Proxy usage. Not sufficient for sensitive operations.<br />**Alternative:** Use Geolocation as additional security layer. Apply IP + Authentication + MFA combination for critical operations. |
| **Not Deploying Policy Updates** | **Why to avoid:** Changes made in global policy do not reflect to live environment without deploy.<br />**Alternative:** Use Deploy button after policy is updated. Integrate deploy process into CI/CD pipeline. |
| **Transitioning to Production Without Testing** | **Why to avoid:** Wrong IP configuration may cause blocking of all users.<br />**Alternative:** Validate policy in test environment. Deploy first in passive mode, check logs. Then activate. Prepare rollback plan. |

### Performance Tips

| Criterion | Recommendation / Impact |
|----------|----------------------|
| **IP Group Size** | **Recommendation:** Limit IP groups to maximum 100-200 IPs. Create multiple groups if more IPs are needed.<br />**Impact:** Entire IP list is checked on each request. Very large lists reduce performance (O(n) comparison for each IP). |
| **Preferring CIDR Blocks** | **Recommendation:** Use CIDR notation for IP ranges as much as possible.<br />**Performance Difference:** Using `192.168.1.0/24` (1 entry) instead of `192.168.1.1, 192.168.1.2, ..., 192.168.1.254` (254 entries) is 100x faster. |
| **Variable Cache Strategy** | **Recommendation:** Use cache mechanism in Variable datasource (Redis, Memcached).<br />**Impact:** Reading from cache instead of database query on each request reduces millisecond delay to microsecond. TTL can be 5-10 minutes. |
| **Geolocation Performance** | **Note:** Geolocation lookup occurs on each request and creates additional delay (average 1-5ms).<br />**Recommendation:** Prefer using fixed IP list instead of geolocation in high-traffic APIs. Cache geolocation results (IP ‚Üí Country/City mapping). |
| **Condition Complexity** | **Recommendation:** Write simple and optimized conditions. Avoid unnecessarily complex regex or nested conditions.<br />**Impact:** Simple condition (`path='/' AND method='GET'`) < 0.1ms. Complex regex condition > 1-2ms. |
| **Policy Ordering** | **Best Practice:** Run IP Whitelist policy first within Policy Group.<br />**Logic:** If requests from unauthorized IPs are blocked at early stage, other policies (Rate Limiting, JWT, etc.) do not run unnecessarily. |
| **Log Level Setting** | **Production:** Keep log level at ERROR or WARN.<br />**Development:** You can use DEBUG or TRACE.<br />**Impact:** Excessive logging (logging IP check on each request) can cause disk I/O and performance issues. |
| **Deleting Inactive Policies** | **Recommendation:** Regularly delete unused or passive policies.<br />**Impact:** Keeps database and in-memory policy registry small, reduces policy lookup time. |

## Frequently Asked Questions (FAQ)

| Category | Question | Answer |
|----------|----------|--------|
| **General** | How many IPs does IP Whitelist policy support? | There is no technical limit but 500-1000 IPs are recommended for performance. Use IP groups and CIDR blocks for more IPs. External cache (Hazelcast) usage with Variable is recommended for very large lists. |
| **General** | Are IPv6 addresses supported? | IPv4 and CIDR blocks are supported in current implementation. IPv6 support is on product roadmap. As temporary solution, you can do routing at reverse proxy level for IPv6 traffic. |
| **General** | Should API Proxy be deployed even if I make policy passive? | Yes. Every change made in global policies (including active/passive) must be deployed. In local policies, the API Proxy itself must be deployed. |
| **Technical** | How is IP retrieved from `X-Forwarded-For` header? | API Gateway automatically checks `X-Forwarded-For`, `X-Real-IP` headers. You must activate "Use Forwarded IP" option from Gateway settings. If header does not exist, direct socket IP is used. |
| **Technical** | How should IP list be formatted with Variable? | If Variable type is "String List":<br />`["192.168.1.1", "192.168.1.2", "10.0.0.0/8"]`<br />If Variable type is "JSON":<br />`{"ipList": ["192.168.1.1", "192.168.1.2"], "allowAll": false}`<br />Variable is read when each request arrives or retrieved from cache. |
| **Technical** | How is CIDR block calculated? | CIDR notation: `IP_ADDRESS/PREFIX_LENGTH`<br />**Examples:**<br />- `192.168.1.0/32` = Single IP (192.168.1.0)<br />- `192.168.1.0/24` = 256 IPs (192.168.1.0 - 192.168.1.255)<br />- `10.0.0.0/8` = 16,777,216 IPs (10.0.0.0 - 10.255.255.255)<br />You can use online CIDR calculators. |
| **Technical** | Which HTTP headers are added when policy is applied? | No header is added when policy is successful. Custom error message is returned when failed (IP rejected). You can add custom headers like `X-Apinizer-Policy-Status: REJECTED` for debugging. |
| **Usage** | If I use both IP list and Geolocation, is the logic AND or OR? | **OR** logic works. That is, client IP is accepted if it matches **any of** these sources:<br />- Manual IP list<br />- IPs in IP Groups<br />- Geolocation country/city rules<br />- IPs from Variable<br />Rejected if it matches none. |
| **Usage** | I updated global policy but it didn't reflect on API, why? | Global policy changes must be deployed.<br /><br />Process steps:<br />- Save the policy.<br />- Click "Deploy" button on policy detail page.<br />- Select environments to deploy (DEV, TEST, PROD).<br />- Confirm deploy process.<br />- Changes reflect to live within 1-2 minutes after deploy. |
| **Usage** | What happens to policy if I delete IP Group? | **Caution:** If IP Group is deleted, policies using this group become **invalid** (‚ö†Ô∏è validation warning is shown). Deleted group ID remains in policy ipGroupIdList but IPs do not match.<br />**Recommendation:** Check which policies use it before deleting IP Group. Update policies first if needed. |
| **Usage** | How is Geolocation service activated? | - Go to "Geolocation Settings" page from Admin menu.<br />- Select Geolocation provider (e.g., MaxMind GeoIP2).<br />- Enter API Key or license information.<br />- Test connection with "Test Connection".<br />- Open "Enable Geolocation" toggle and save.<br />- Geolocation database must be updated regularly (monthly). |
| **Usage** | Can I use both global and local IP Whitelist policy in one API Proxy? | Technically yes, but **not recommended**. If both policies are active, **AND** logic works (must match both lists). Can lead to complex management and unexpected blockings.<br />**Best Practice:** Use global policy. If specific case exists, localize global policy and customize. |
| **Troubleshooting** | I'm getting "Invalid IP address format" error, why? | IP address format is incorrect. Valid formats:<br />‚úÖ `192.168.1.100` (IPv4)<br />‚úÖ `10.0.0.0/8` (CIDR)<br />‚ùå `192.168.1` (missing octet)<br />‚ùå `192.168.1.300` (300 > 255, invalid)<br />‚ùå `192.168.1.0/33` (CIDR prefix must be between 0-32)<br />Edit your IP according to these formats. |
| **Troubleshooting** | IP I added to Whitelist still gets 403, what should I do? | Troubleshooting steps:<br />- Check if policy is **active** (active=true).<br />- Check if global policy is **deployed**.<br />- See client's real IP in API Gateway logs (X-Forwarded-For if behind Load Balancer).<br />- Is Condition defined? Check if condition is met.<br />- Is IP in correct format? Is CIDR block calculated correctly?<br />- If Variable is used, check Variable content.<br />- Clear cache (reload policy cache).<br />If problem persists, send log files to support team. |
| **Troubleshooting** | Geolocation control is not working, what should I do? | Checklist:<br />- Is service active in Geolocation Settings?<br />- Is Geolocation database current? (Check last update date)<br />- Is client IP a public IP? (Geolocation does not work for private IPs: 192.168.x.x, 10.x.x.x)<br />- VPN or Proxy may be used (hides real location).<br />- Check geolocation lookup result in API Gateway logs (which country/city was detected).<br />- Geolocation provider's API limit may have been reached. |

**This document is part of Apinizer product documentation. ¬© 2025 Apinizer - All rights reserved.**

