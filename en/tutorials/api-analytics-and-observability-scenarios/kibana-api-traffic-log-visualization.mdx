---
title: "Visualizing API Traffic Logs with Kibana"
description: "You can visualize and analyze Apinizer API traffic logs with Kibana. You can perform Kibana installation, visualization creation, dashboard configuration, and data analysis operations."
---

Kibana is an interface program used to visualize and analyze Elasticsearch data. Kibana retrieves data by communicating with the Elasticsearch cluster. When the Kibana server is lost, all data is safely stored in the Elasticsearch cluster. Kibana enables users to visualize Elasticsearch data with graphs and visual analyses.

One of Kibana's core features is the ability to monitor logs recorded in Elasticsearch in real time. This allows you to track and analyze log data in real time.

Kibana is a powerful tool for users to understand, analyze, and share data. With the creation of visual analyses and reports, users can interpret and share data more effectively.

## Kibana Installation (Windows)

You can choose Kibana's Basic version or Free version. While the Basic version usually comes with paid subscriptions, the Free version is an open-source alternative. This document will use the free version.

<Note>
For a compatible Kibana version, you can visit [https://www.elastic.co/downloads/past-releases/kibana-oss-7-9-2](https://www.elastic.co/downloads/past-releases/kibana-oss-7-9-2). Free version.
</Note>

- First, after selecting the version suitable for your operating system from the link pages above, simply click the relevant link to start the download. Once the download is complete, you can proceed with Kibana installation.
- Extract the downloaded file and save it to the target folder.
- Enter the Kibana file and copy the file path by entering the bin folder.

Edit the server information for Apinizer's Elasticsearch Integration in the "kibana.yml" file in the Config folder for configuration as follows.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/01-kibana-yml-config-windows.png"
  alt="Kibana YML Configuration"
  width="1000"
/>

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/02-kibana-yml-config-detail-windows.png"
  alt="Kibana YML Configuration Detail"
  width="1000"
/>

- Open Command Prompt as administrator and navigate to the copied kibana file with the **cd** command.

```bash
cd C:\kibana-7.9.2
```

- Run the following command with the .bat extension to start Kibana.
- Kibana will start after a few seconds.

```bash
bin/kibana.bat
```

- If everything is fine, you will see a result like this.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/03-kibana-startup-result-windows.png"
  alt="Kibana Startup Result"
  width="800"
/>

- The running Kibana uses port 5601 by default.
- To check if Kibana is running, you can check by typing "localhost:5601" in your browser.
- When we log in, we see the Kibana interface connected to Elasticsearch.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/04-kibana-interface.png"
  alt="Kibana Interface"
  width="800"
/>

## Kibana Installation (Linux)

Kibana v7.9.2 Linux archive can be downloaded and installed as follows:

Download Kibana version 7.9.2 using the **curl** command.

```bash
curl -O https://artifacts.elastic.co/downloads/kibana/kibana-oss-7.9.2-linux-x86_64.tar.gz
```

Extract the Kibana archive file with the **tar** command.

```bash
tar -xzf kibana-oss-7.9.2-linux-x86_64.tar.gz
```

Navigate to the directory where Kibana was extracted (`kibana-7.9.2-linux-x86_64/`).

```bash
cd kibana-oss-7.9.2-linux-x86_64/
```

Edit the server information for Apinizer's Elasticsearch Integration in the "kibana.yml" file in the Config folder for configuration.

```bash
vi config/kibana.yml
```

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/05-kibana-yml-config-linux.png"
  alt="Kibana YML Configuration Linux"
  width="800"
/>

Used to start your Kibana server.

```bash
./bin/kibana
```

If everything is fine, you will see a result like this.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/06-kibana-startup-result-linux.png"
  alt="Kibana Startup Result Linux"
  width="1000"
/>

## Setting Up Kibana as a Linux Service

```bash
sudo chown -Rf elasticsearch:elasticsearch /opt/kibana-7.9.2-linux-x86_64
sudo vi /etc/systemd/system/kibana.service
```

```bash
[Unit]
Description=Kibana
After=network.target
After=syslog.target

[Install]
WantedBy=multi-user.target

[Service]
Type=simple
ExecStart=/opt/kibana-7.9.2-linux-x86_64/bin/kibana serve
WorkingDirectory=/opt/kibana-7.9.2-linux-x86_64
Restart=always
RestartSec=5
StandardOutput=journal
StandardError=inherit
User=elasticsearch
```

```bash
sudo systemctl daemon-reload
sudo systemctl enable kibana.service
sudo systemctl start kibana.service
sudo systemctl status kibana.service
```

```bash
netstat -tulpn | grep 5601
```

## Integration of Apinizer API Traffic Logs with Kibana

Kibana enables the creation of many different types of graphs, including data tables, timelines, heat maps, bar charts, area charts, and more. Operations begin by selecting the most appropriate visualization format according to the purpose of use.

Apinizer Overview section provides the ability to display general information about API Proxies, total request counts, and successful, failed, and blocked requests on a single page. This section allows users to easily monitor and manage API traffic.

Thanks to Kibana integration, users can create customized reports in addition to general information and examine API traffic in more detail. This enables users to understand API performance and make improvements. Below is shown how several Kibana Visualize and Dashboard examples, created similar to the Apinizer Overview section, are prepared.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/07-apinizer-overview-dashboard.png"
  alt="Apinizer Overview Dashboard"
  width="1000"
/>

<Note>
For the Template Data Structure Table, you can visit the [Elasticsearch Manual ILM Policy and Template Creation](/en/setup/elasticsearch/manual-ilm-policy-and-template-creation) page and see the description of data stored by field name in ILM Policies.
</Note>

## Creating Visualizations and Dashboards

Visualizations created with Kibana are brought together in a visualization panel to provide a general indicator of existing data and more customized data in the Apinizer Overview section.

To create this visualization, click the 'Visualize' link from the left menu.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/08-visualize-menu.png"
  alt="Visualize Menu"
  width="200"
/>

Then, click the "Create Visualization" button.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/09-create-visualization.png"
  alt="Create Visualization"
  width="500"
/>

Select the desired chart creation format.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/10-chart-format-selection.png"
  alt="Chart Format Selection"
  width="500"
/>

## Example Chart Creation

### Creating a chart showing request count status within 7 days

The chart showing the status of request counts within the last 7 days is grouped by time range (timestamp). For each time range, the unique request count in the Size Request Total field has been calculated using the unique count metric. Additionally, which statuses exist in the dataset according to the Result Status term are shown.

| Field | Aggregation | Elasticsearch Index Field Name for Query |
|------|-------------|------------------------------------------|
| Metric (Determining size) | Unique Count | sr1t(Size Request Total) |
| Buckets (Which Information Will Be in Dataset) | Date histogram | @timestamp(For time range data) |
| | Terms | rt(Result Status) |

- Enter the s1rt (request size) metric in the Metrics field to determine the count of unique items. The count of unique items provides information about the diversity and general summary of the dataset's content.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/11-metrics-settings-7days.png"
  alt="Metrics Settings - 7 Day Requests"
  width="400"
/>

- To show the status of request counts in a 7-day time period, the Date Histogram metric is used together with the @timestamp field, and the x-axis is determined by this time range. To group results, statuses are grouped using the Terms term in the Split Series section according to frequently encountered values. This method is used to visualize the distribution of requests over time and the distribution of different statuses.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/12-buckets-settings-7days.png"
  alt="Buckets Settings - 7 Day Requests"
  width="400"
/>

- By following the steps, it visually represents which statuses occur how frequently in a specific time period.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/13-chart-result-7days.png"
  alt="Chart Result - 7 Day Request Status"
  width="1000"
/>

### Creating a chart showing request count status by methods

The chart is grouped by API Proxy Method names and shows the request count for each method. Additionally, it is stated that different result statuses are also shown for each method.

| Field | Aggregation | Elasticsearch Index Field Name for Query |
|------|-------------|------------------------------------------|
| Metric (Determining size) | Count | - |
| Buckets (Which Information Will Be in Dataset) | Terms | apmn(API Proxy Method name) |
| | Terms | rt(Result Status) |

- Use Count in the Metrics field to determine the total method count in the dataset, and do not specify a field.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/14-metrics-settings-methods.png"
  alt="Metrics Settings - Methods"
  width="400"
/>

- Use apm (API Proxy Method name) in the Buckets field to make determinations for the x-axis. To group results, statuses are grouped using the Terms term in the Split Series section according to frequently encountered values.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/15-buckets-settings-methods.png"
  alt="Buckets Settings - Methods"
  width="400"
/>

- By following the steps, it visually presents request status grouped by API Proxy Method names and for each method.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/16-chart-result-methods.png"
  alt="Chart Result - Methods"
  width="1000"
/>

### Creating a chart showing API Proxy usage rates

The chart is grouped by API Proxy names and shows the usage count for each API Proxy. This chart can be used to determine which API Proxy is used more.

| Field | Aggregation | Elasticsearch Index Field Name for Query |
|------|-------------|------------------------------------------|
| Metric (Determining size) | Count | - |
| Buckets (Which Information Will Be in Dataset) | Terms | apn(API Proxy name) |

- Use Count in the Metrics field to determine the total API Proxy count in the dataset, and do not specify a field.
- Proxies are grouped using the Terms term in the Split Series section.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/17-metrics-settings-api-proxy.png"
  alt="Metrics Settings - API Proxy"
  width="400"
/>

- apn and limitations about how many API Proxies there will be are shown in the Buckets field according to API Proxy names. The Metrics section is where the slice size is determined.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/18-chart-result-api-proxy.png"
  alt="Chart Result - API Proxy"
  width="1000"
/>

### Creating a chart showing request count and status by API Proxies

This chart shows which statuses API Proxies are more frequently associated with. For example, it can be used to determine in which statuses an API Proxy fails more frequently or in which statuses it is more successful.

| Field | Aggregation | Elasticsearch Index Field Name for Query |
|------|-------------|------------------------------------------|
| Metric (Determining size) | Count | - |
| Buckets (Which Information Will Be in Dataset) | Terms | apn(API Proxy name) |
| | Terms | rt(Result Status) |

- Use Count in the Metrics field to determine the total API Proxy count in the dataset, and do not specify a field.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/19-metrics-settings-api-proxy-status.png"
  alt="Metrics Settings - API Proxy Status"
  width="400"
/>

- Use apn(API Proxy name) in the Buckets field to make determinations for the x-axis. To group results, Result statuses are grouped using the Terms term in the Split Series section according to frequently encountered values.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/20-buckets-settings-api-proxy-status.png"
  alt="Buckets Settings - API Proxy Status"
  width="400"
/>

- By following the steps, it visually presents request status grouped by API Proxy names and for each Proxy.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/21-chart-result-api-proxy-status.png"
  alt="Chart Result - API Proxy Status"
  width="1000"
/>

### Creating a Histogram chart showing requests by status code

This histogram chart will show the count of requests by status codes. By determining how many requests occurred for each status code, you can visualize the distribution of requests. This way, you can observe which status codes are more or less frequent.

| Field | Aggregation | Elasticsearch Index Field Name for Query |
|------|-------------|------------------------------------------|
| Metric (Determining size) | Count | - |
| Buckets (Which Information Will Be in Dataset) | Terms | sc(Status Code) |

- Use Count in the Metrics field to determine the total request count in the dataset, and do not specify a field.
- Use sc in the Buckets field to determine the status code according to total request count.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/22-metrics-settings-status-code.png"
  alt="Metrics Settings - Status Code"
  width="400"
/>

- This visualization clearly shows the count of requests with different status codes. For example, it can include the ratio of requests with status code 200 (Success) within total requests, the count of requests with status code 404 (Not Found), the count of requests with status code 500 (Server Error), etc.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/23-chart-result-status-code.png"
  alt="Chart Result - Status Code"
  width="1000"
/>

## Creating Dashboard and Adding Visualizations

Click the "Dashboard" link from the left menu.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/24-dashboard-menu.png"
  alt="Dashboard Menu"
  width="400"
/>

Click the "Create Dashboard" button.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/25-create-dashboard.png"
  alt="Create Dashboard"
  width="800"
/>

The area marked in red is used to add any created visualization.

The area marked in green is used to create a new visualization and add it to the dashboard.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/26-dashboard-add.png"
  alt="Dashboard Addition"
  width="400"
/>

The process of adding saved visualizations to the dashboard.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/27-add-visualization-1.png"
  alt="Adding Visualization 1"
  width="1000"
/>

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/28-add-visualization-2.png"
  alt="Adding Visualization 2"
  width="1000"
/>

## Data Analysis and Filtering Process

This section enables analyzing data stored in indices, obtaining detailed information about the structure of each field, and visualizing findings. Additionally, searches can be personalized, saved, and these customized search and filtering options can be placed in a control panel.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/29-data-analysis.png"
  alt="Data Analysis"
  width="1000"
/>

There is a chart showing the total request count within the last 15 minutes. Below the bars is a list of Elasticsearch documents.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/30-timeline.png"
  alt="Timeline"
  width="400"
/>

Filtering by time range can be performed optionally and visualized.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/31-time-filtering.png"
  alt="Time Filtering"
  width="1000"
/>

All fields can be displayed row by row along with the data. By clicking the arrow icon to expand a row, details are provided in table format or JSON format.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/32-table-format.png"
  alt="Table Format"
  width="1000"
/>

JSON Format

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/33-json-format.png"
  alt="JSON Format"
  width="1000"
/>

Desired data can be put into table format. When you click the box marked in red to expand one of the rows, it adds that data in table format.

If you click the box marked in green, it can be used to filter data. This functions like a KQL (Kibana Query Language) query.

KQL is the query language used for searching and analyzing data stored in Elasticsearch. When simple queries are written, they are automatically converted to Elasticsearch DLS Query format in the background and searched. Complex Elasticsearch queries can be performed using KQL in a single line.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/34-kql-query.png"
  alt="KQL Query"
  width="1000"
/>

### Querying successful request count within the last 24 hours (sc:200)

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/35-successful-request-query.png"
  alt="Successful Request Query"
  width="1000"
/>

After search data is saved, it can be shared with others with different sharing types using the share button in the upper right corner.

<img
  src="/images/tutorials/api-analitigi-ve-gozlemlenebilirlik-senaryolari/kibana-api-trafik-log/36-share.png"
  alt="Sharing"
  width="200"
/>

<Note>
For the Template Data Structure Table, you can visit the [Elasticsearch Manual ILM Policy and Template Creation](/en/setup/elasticsearch/manual-ilm-policy-and-template-creation) page and see the description of data stored by field name in ILM Policies.
</Note>

