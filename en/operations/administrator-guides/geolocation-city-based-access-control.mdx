---
title: "Geographic Access Control Using Geolocation in Apinizer"
description: "You can block or allow requests coming from specific cities using geolocation feature on Apinizer platform, integrate MaxMind GeoLite2 City database, and provide geographic access control with X-Forwarded-For header information."
---

This document explains how to **block** or **allow** requests coming from specific cities using **geolocation** (geographic location) feature on Apinizer platform.

At the end of the work, we will display on **Kibana Map** to visualize which cities these incoming requests come from.

## 1) Providing Geolocation Data

To provide this data, you can benefit from MaxMind, IpGeolocation services. These services allow you to download databases containing IP and city information.

In this step, we will explain how to use it by downloading the free **GeoLite2 City** **database** offered by **MaxMind**.

Apinizer usually uses client IP address to obtain **geolocation** data. The incoming IP address is queried through a database to determine which city the request comes from.

After completing the registration process on the page, we go to the red marked area specified below and download the zip file in the GeoLite2 City section and extract it to obtain our .mmdb extension file:

<img
  src="/images/tutorials/nasil-yapilir-kilavuzlari/yonetici-kilavuzlari/geolocation-erisim-kontrolu/01-maxmind-download.png"
  alt="MaxMind GeoLite2 City Download"
  width="800"
/>

## 2) Integration of Geolocation Database to Apinizer

**.mmdb** extension file is added here and deployed from **Administration → System Settings → IP Geolocation Setting** page.

<img
  src="/images/tutorials/nasil-yapilir-kilavuzlari/yonetici-kilavuzlari/geolocation-erisim-kontrolu/02-geolocation-settings.png"
  alt="IP Geolocation Setting"
  width="800"
/>

## 3) Activating XFF and Adding Allowed/Blocked IP List Policy

Through Apinizer, the real **IP** address of the **client** can be **determined** in **requests** using **X-Forwarded-For (XFF)** header information.

With **Allowed IP** policy, **permission can be given** to requests coming from specific IP addresses or specific cities. Using **Blocked IP** policy, these requests can be **blocked**.

To use XFF information, you can activate it from Settings tab through Proxy settings:

<img
  src="/images/tutorials/nasil-yapilir-kilavuzlari/yonetici-kilavuzlari/geolocation-erisim-kontrolu/03-xff-settings.png"
  alt="XFF Activation"
  width="800"
/>

Let's block requests coming from Istanbul by adding Blocked IP List policy to this Proxy:

<img
  src="/images/tutorials/nasil-yapilir-kilavuzlari/yonetici-kilavuzlari/geolocation-erisim-kontrolu/04-blocked-ip-policy.png"
  alt="Blocked IP List Policy"
  width="800"
/>

Istanbul is selected from IP Geolocation field and saved:

<img
  src="/images/tutorials/nasil-yapilir-kilavuzlari/yonetici-kilavuzlari/geolocation-erisim-kontrolu/05-istanbul-selection.png"
  alt="IP Geolocation Istanbul Selection"
  width="800"
/>

## 4) Access Blocking and Result

Access was blocked in a request made to the service with an IP address from Istanbul location:

<img
  src="/images/tutorials/nasil-yapilir-kilavuzlari/yonetici-kilavuzlari/geolocation-erisim-kontrolu/06-access-blocked.png"
  alt="Access Blocked"
  width="800"
/>

1. We explained how we blocked requests coming from Istanbul on Apinizer platform.
2. We downloaded the GeoLite2 City database offered by MaxMind and integrated this data into Apinizer.
3. We controlled requests coming from specific cities by determining the real IP addresses of clients with X-Forwarded-For (XFF) header information.
4. We selected Istanbul using Block Ip List policies to block requests coming from Istanbul and successfully blocked access from this city.

<Warning>
**Very Important**

To visualize which cities incoming requests come from on Kibana, you can check the [Geographic Visualization with Kibana Maps](/en/operations/administrator-guides/kibana-maps-geographic-visualization) page.
</Warning>

